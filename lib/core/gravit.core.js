!function(a){function b(){}b.getTypeId=function(a){return"number"==typeof a?a:"function"==typeof a&&a.prototype.hasOwnProperty("__gtype_id__")?a.prototype.__gtype_id__:a&&"number"==typeof a.__gtype_id__?a.__gtype_id__:null},b.getName=function(a){if(a){if("object"==typeof a&&(a=a.constructor),a&&"function"==typeof a){var b=/function (.{1,})\(/,c=b.exec(a.toString());return c&&c.length>1?c[1]:"anonymous"}return a.toString()}return"<null>"},b.inherit=function(a,c){if(a.prototype=Object.create(c.prototype),a.prototype.__gtype_id__=b._internalTypeIdCounter++,a.prototype.constructor=a,delete a.prototype.__gmixins__,c.prototype.__gmixins__){a.prototype.__gmixins__={};for(var d in c.prototype.__gmixins__)a.prototype.__gmixins__[d]=!0}if(c!=b)for(var e in c)e&&e.length>0&&"constructor"!==e&&"__gmixins__"!=e&&"toString"!=e&&"_"!=e.charAt(0)&&!a[e]&&(a[e]=c[e])},b.mix=function(a,c){b.inheritAndMix(a,null,c)},b.inheritAndMix=function(a,c,d){if(c&&this.inherit(a,c),d){a.prototype.__gmixins__||(a.prototype.__gmixins__={});for(var e=0;e<d.length;++e){var f=d[e].prototype;for(var g in f)if(g&&"constructor"!==g&&"toString"!=g&&"__gmixins__"!=g&&"__gtype_id__"!=g&&"hasMixin"!=g){if(g in a.prototype)throw new Error("Mixin "+f+" may not override "+g+" in "+a.prototype);a.prototype[g]=f[g]}if(f.__gtype_id__||(f.__gtype_id__=b._internalTypeIdCounter++),a.prototype.__gmixins__[f.__gtype_id__]=!0,f.__gmixins__)for(var h in f.__gmixins__)a.prototype.__gmixins__[h]=!0;for(var i=Object.getPrototypeOf(f);null!=i&&i!==Object.prototype;i=Object.getPrototypeOf(i))i.__gtype_id__||(i.__gtype_id__=b._internalTypeIdCounter++),a.prototype.__gmixins__[i.__gtype_id__]=!0}}},b._internalTypeIdCounter=0,b.prototype.__gtype_id__=-1,b.prototype.__gmixins__=null,b.prototype.hasMixin=function(a){return this.__gmixins__&&this.__gmixins__[a.prototype.__gtype_id__]?!0:!1},b.prototype.toString=function(){var a=this.constructor.toString().match(/^function ([^\(]*)/);return"[Object "+(a?a[1]:"object")+"]"},a.GObject=b}(this),function(a){function b(){}GObject.inherit(b,GObject),b.prototype._paramsToString=function(){return""},a.GEvent=b}(this),function(a){function b(){}b.prototype._listeners=null,b.prototype.addEventListener=function(a,b,c,d){var e=GObject.getTypeId(a);this._listeners||(this._listeners={});var f=b;if(c||d){var g=d?d.slice():[];g.unshift(c?c:b),b=Function.prototype.bind.apply(b,g)}e in this._listeners||(this._listeners[e]={eventClass:a,listeners:[]}),this._listeners[e].listeners.push({listener:b,sourceListener:f,target:c})},b.prototype.removeEventListener=function(a,b,c){var d=GObject.getTypeId(a);if(this._listeners&&d in this._listeners){for(var e=this._listeners[d].listeners,f=0;f<e.length;++f)e[f].sourceListener!=b||c&&e[f].target!==c||(e.splice(f,1),--f);0==e.length&&delete this._listeners[d]}},b.prototype.hasEventListeners=function(a){var b=GObject.getTypeId(a);return this._listeners&&b in this._listeners?!0:!1},b.prototype.trigger=function(a){if(this._listeners){var b=GObject.getTypeId(a);if(b in this._listeners)for(var c=this._listeners[b].listeners,d=0;d<c.length;++d){var e=c[d];e.listener.call(this,a)}}},a.GEventTarget=b}(this),function(a){function b(){}b.OperatingSystem={Unix:0,Windows:1,OSX_IOS:2},b.Hardware={Desktop:0,Tablet:1,Phone:2},b.littleEndian=!0,b.operatingSystem=null,b.hardware=null,b.language=null,b.littleEndian=function(){var a=new ArrayBuffer(8),b=new Uint32Array(a);return b[1]=168496141,!(10===a[4]&&11===a[5]&&12===a[6]&&13===a[7])}(),b.hardware=function(){var a=!!navigator.userAgent.match(/(iPad|SCH-I800|xoom|kindle)/i),c=!!navigator.userAgent.match(/(iPhone|iPod|blackberry|android 0.5|htc|lg|midp|mmp|mobile|nokia|opera mini|palm|pocket|psp|sgh|smartphone|symbian|treo mini|Playstation Portable|SonyEricsson|Samsung|MobileExplorer|PalmSource|Benq|Windows Phone|Windows Mobile|IEMobile|Windows CE|Nintendo Wii)/i);return a?b.Hardware.Tablet:c?b.Hardware.Phone:b.Hardware.Desktop}(),b.operatingSystem=function(){for(var a=[{string:navigator.platform,subString:"Win",identity:b.OperatingSystem.Windows},{string:navigator.platform,subString:"Mac",identity:b.OperatingSystem.OSX_IOS},{string:navigator.userAgent,subString:"iPhone",identity:b.OperatingSystem.OSX_IOS},{string:navigator.userAgent,subString:"iPad",identity:b.OperatingSystem.OSX_IOS},{string:navigator.userAgent,subString:"Android",identity:b.OperatingSystem.Unix},{string:navigator.platform,subString:"Linux",identity:b.OperatingSystem.Unix}],c=0;c<a.length;c++){var d=a[c].string;if(-1!=d.indexOf(a[c].subString))return a[c].identity}return b.OperatingSystem.Windows}(),b.language=function(){var a=(navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage||"").split("-");return 2==a.length?a[0].toLowerCase():a?a[0].toLowerCase():null}(),console.log("HW="+b.hardware+"; OS="+b.operatingSystem+"; LANG="+b.language),a.GSystem=b}(this),function(a){function b(){}b.Constant={CHARACTER:0,SPACE:1,ENTER:2,TAB:3,BACKSPACE:4,CONTROL:5,SHIFT:6,ALT:7,LEFT:8,UP:9,RIGHT:10,DOWN:11,PAGE_UP:12,PAGE_DOWN:13,HOME:14,END:15,INSERT:16,DELETE:17,COMMAND:19,F1:30,F2:31,F3:32,F4:33,F5:34,F6:35,F7:36,F8:37,F9:38,F10:39,F11:40,F12:41,META:100,OPTION:101,REMOVE:102},b.translateKey=function(a){var c=null;switch(a){case 32:c=b.Constant.SPACE;break;case 13:c=b.Constant.ENTER;break;case 9:c=b.Constant.TAB;break;case 8:c=b.Constant.BACKSPACE;break;case 16:c=b.Constant.SHIFT;break;case 17:c=b.Constant.CONTROL;break;case 18:c=b.Constant.ALT;break;case 37:c=b.Constant.LEFT;break;case 38:c=b.Constant.UP;break;case 39:c=b.Constant.RIGHT;break;case 40:c=b.Constant.DOWN;break;case 33:c=b.Constant.PAGE_UP;break;case 34:c=b.Constant.PAGE_DOWN;break;case 36:c=b.Constant.HOME;break;case 35:c=b.Constant.END;break;case 45:c=b.Constant.INSERT;break;case 46:c=b.Constant.DELETE;break;case 112:c=b.Constant.F1;break;case 113:c=b.Constant.F2;break;case 114:c=b.Constant.F3;break;case 115:c=b.Constant.F4;break;case 116:c=b.Constant.F5;break;case 117:c=b.Constant.F6;break;case 118:c=b.Constant.F7;break;case 119:c=b.Constant.F8;break;case 120:c=b.Constant.F9;break;case 121:c=b.Constant.F10;break;case 122:c=b.Constant.F11;break;case 123:c=b.Constant.F12}return null==c&&(c=String.fromCharCode(a)),c},b.transformKey=function(a){return a===b.Constant.META||a===b.Constant.COMMAND?GSystem.operatingSystem===GSystem.OperatingSystem.OSX_IOS&&GSystem.hardware===GSystem.Hardware.Desktop?b.Constant.COMMAND:b.Constant.CONTROL:a===b.Constant.OPTION?b.Constant.ALT:a===b.Constant.REMOVE?GSystem.operatingSystem===GSystem.OperatingSystem.OSX_IOS?b.Constant.BACKSPACE:b.Constant.DELETE:a},b.toLocalizedName=function(a){return a=b.transformKey(a),ifLocale.getValue(b,"key."+a.toString())},b.toLocalizedShort=function(a){if(GSystem.operatingSystem===GSystem.OperatingSystem.OSX_IOS&&GSystem.hardware===GSystem.Hardware.Desktop){if(a==b.Constant.TAB)return"⇥";if(a==b.Constant.OPTION||a==b.Constant.ALT)return"⌥";if(a==b.Constant.META||a==b.Constant.COMMAND)return"⌘";if(a==b.Constant.SHIFT)return"⇧";if(a==b.Constant.CONTROL)return"⌃";if(a==b.Constant.SPACE)return"␣";if(a==b.Constant.ENTER)return"⏎";if(a==b.Constant.REMOVE)return"⌫";if(a==b.Constant.UP)return"↑";if(a==b.Constant.DOWN)return"↓";if(a==b.Constant.LEFT)return"←";if(a==b.Constant.RIGHT)return"→"}a=b.transformKey(a);var c=ifLocale.getValue(b,"key."+a.toString()+".short",null);return c?c:ifLocale.getValue(b,"key."+a.toString())},b.toSystemShortcut=function(a){if(GSystem.operatingSystem===GSystem.OperatingSystem.OSX_IOS&&GSystem.hardware===GSystem.Hardware.Desktop){if("-"===a)return"−";if("+"===a)return"+"}return a.toUpperCase()},b.shortcutToString=function(a){for(var c="",d=0;d<a.length;++d)d>0&&GSystem.operatingSystem!=GSystem.OperatingSystem.OSX_IOS&&(c+="+"),c+="number"==typeof a[d]?b.toLocalizedShort(a[d]):b.toSystemShortcut(a[d]);return c},a.GKey=b}(this),function(a){function b(){this._values={},this._functions={},"en"===GSystem.language?this.setLanguage(b.Language.English):"de"===GSystem.language&&this.setLanguage(b.Language.German)}GObject.inheritAndMix(b,GObject),b.Language={English:0,German:1,Default:0},b.Key=function(a,b){this._type_id=GObject.getTypeId(a),this._key=b},b.Constant={Create:new b.Key(b,"create"),Add:new b.Key(b,"add"),Edit:new b.Key(b,"edit"),Remove:new b.Key(b,"remove"),Delete:new b.Key(b,"delete"),Open:new b.Key(b,"open"),Save:new b.Key(b,"save"),Cancel:new b.Key(b,"cancel"),Ok:new b.Key(b,"ok"),Close:new b.Key(b,"close"),Loading:new b.Key(b,"loading"),LoadingOf:new b.Key(b,"loading_of"),Saving:new b.Key(b,"saving"),SavingOf:new b.Key(b,"saving_of"),Success:new b.Key(b,"success"),Failure:new b.Key(b,"failure"),Waiting:new b.Key(b,"waiting")},b.prototype._language=0,b.prototype._values=null,b.prototype._functions=null,b.prototype.getLanguage=function(){return this._language},b.prototype.setLanguage=function(a){a!=this._language&&(this._language=a)},b.prototype.get=function(a){return null!=a&&a instanceof b.Key?this.getValueByKey(a):a},b.prototype.getValue=function(a,c,d){var e=GObject.getTypeId(a),f=this._getValue(this._language,e,c);if(f||this._language==b.Language.Default||(f=this._getValue(b.Language.Default,e,c)),!f&&"undefined"==typeof d)throw new Error("No value found for "+GObject.getName(a)+" and key "+c);return f?f:d},b.prototype.getValueByKey=function(a){return this.getValue(a._type_id,a._key)},b.prototype.setValues=function(a,b,c,d){var e=GObject.getTypeId(a),f=this._values[b];f||(f=this._values[b]={});var g=f[e];g||(g=f[e]={});for(var h=0;h<c.length;++h)g[c[h]]=d[h]},b.prototype._getValue=function(a,b,c){var d=this._values[a];if(d){var e=d[b];if(e)return e[c]}},b.prototype.setFunction=function(a,b,c){var d=this._functions[a];d||(d=this._functions[a]={}),d[b]=c},b.prototype.getFunction=function(a){var c=this._functions[this._language];if(c&&c.hasOwnProperty(a))return c[a];if(this._language!=b.Language.Default){var c=this._functions[b.Language.Default];if(c&&c.hasOwnProperty(a))return c[a]}return null},b.prototype.toString=function(){return"[Object GLocale]"},a.GLocale=b,a.ifLocale=new b}(this),function(a){function b(){}b.PI2=2*Math.PI,b.PIHALF=.5*Math.PI,b.defaultEps=1e-14,b.toRadians=function(a){return a*Math.PI/180},b.toDegrees=function(a){return 180*a/Math.PI},b.normalizeAngleRadians=function(a){return a>=0?b.mod(a,b.PI2):a+b.PI2*Math.floor(-a/b.PI2+1)},b.normalizeAngleDegrees=function(a){return a>=0?b.mod(a,360):a+360*Math.floor(-a/360+1)},b.normalizeValue=function(a,b,c){return b>a?b:a>c?c:a},b.isEqualEps=function(a,c,d){return d||(d=b.defaultEps),Math.abs(a-c)<=d},b.round=function(a,b,c){c=Math.abs(c)||0;var d=c?Math.pow(10,c):1;return b?Math.ceil(a*d-.5)/d:Math.round(a*d)/d},b.mod=function(a,c){return 0>a?-b.mod(-a,c):a-Math.floor(a/c)*c},b.div=function(a,b){return 0>a?-Math.floor(-a/b):Math.floor(a/b)},b.getIntersectionPoint=function(a,c,d,e,f,g,h,i,j){var k=(a-d)*(i-g)-(c-e)*(h-f),l=(a-f)*(i-g)-(c-g)*(h-f),m=(a-d)*(c-g)-(c-e)*(a-f);if(Math.abs(k)<b.defaultEps)return null;var n=l/k,o=m/k;return!j&&n>=0&&1>=n&&o>=0&&1>=o||j?(j&&(j[0]=n,j[1]=o),new GPoint(a+n*(d-a),c+n*(e-c))):null},b.circleLineIntersection=function(a,c,d,e,f,g,h,i){var j=h*h,k=d*d,l=e*e,m=k+l;if(!b.isEqualEps(m,0)){var n=d*(g-c)-e*(f-a),o=j*m-n*n;b.isEqualEps(o,0)?i[0]=(d*(f-a)+e*(g-c))/m:o>0&&(n=d*(f-a)+e*(g-c),i[0]=(n-Math.sqrt(o))/m,i[1]=(n+Math.sqrt(o))/m)}},b.circleCircleIntersection=function(a,c,d,e,f,g,h){var i=b.ptSqrDist(a,c,e,f),j=Math.abs(d-g),k=j*j,l=d+g,m=l*l;if(!b.isEqualEps(i,0)){var n=(d*d-g*g)/(2*i),o=(a+e)/2+(e-a)*n,p=(c+f)/2+(f-c)*n;if(b.isEqualEps(i,m)||!b.isEqualEps(i,0)&&b.isEqualEps(i,k))h[0]=new GPoint(o,p);else if(i>k&&m>i){n=Math.sqrt((m-i)*(i-k))/(2*i);var q=(f-c)*n,r=(a-e)*n;h[0]=new GPoint(o+q,p+r),h[1]=new GPoint(o-q,p-r)}}},b.getLinesIntersection=function(a,c,d,e,f,g){var h=a*f-e*c;return b.isEqualEps(h,0)?null:new GPoint((c*g-f*d)/h,(d*e-g*a)/h)},b.getCircumcircleCenter=function(a,c,d,e,f,g){var h=a-d,i=c-e,j=d-f,k=e-g;return b.getLinesIntersection(h,i,-h*(a+d)/2-i*(c+e)/2,j,k,-j*(d+f)/2-k*(e+g)/2)},b.getPointAtLength=function(a,b,c,d,e){var f,g;return 0>=e?new GPoint(a,b):(f=Math.sqrt((c-a)*(c-a)+(d-b)*(d-b)),e>=f?new GPoint(c,d):(g=e/f,new GPoint(a+g*(c-a),b+g*(d-b))))},b.getCurveAtT=function(a,b,c,d){var e=a+d*(c-a),f=c+d*(b-c);return e+d*(f-e)},b.getCubicCurveAtT=function(a,b,c,d,e){var f=a+e*(c-a),g=c+e*(d-c),h=d+e*(b-d),i=f+e*(g-f),j=g+e*(h-g);return i+e*(j-i)},b.vDotProduct=function(a,b,c,d){return null==a||null==b||null==c||null==d?0:a*c+b*d},b.ptSqrDist=function(a,b,c,d){var e,f;return null==a||null==b||null==c||null==d?0:(e=a-c,f=b-d,e*e+f*f)},b.ptDist=function(a,c,d,e){return Math.sqrt(b.ptSqrDist(a,c,d,e))},b.segmentSide=function(a,c,d,e,f,g){var h=(g-c)*(d-a)+(f-a)*(c-e);return b.isEqualEps(h,0)?0:h>0?1:-1},b.sqrSegmentDist=function(a,c,d,e,f,g,h,i){if(b.isEqualEps(a,d)&&b.isEqualEps(c,e))return b.ptSqrDist(a,c,f,g);var j,k,l,m,n,o,p,q,r=0,s=0;return j=f-a,k=g-c,a==d&&c==e?(s=b.vDotProduct(j,k,j,k),h&&(h[0]=0)):h&&i&&b.vDotProduct(j,k,j,k)<=i?(h[0]=0,s=0):h&&i&&b.ptSqrDist(f,g,d,e)<=i?(h[0]=1,s=0):(l=d-a,m=e-c,r=b.vDotProduct(j,k,l,m)/b.vDotProduct(l,m,l,m),0>=r?(s=b.vDotProduct(j,k,j,k),h&&(h[0]=0)):r>=1?(s=b.vDotProduct(f-d,g-e,f-d,g-e),h&&(h[0]=1)):(n=l*r,o=m*r,p=j-n,q=k-o,s=b.vDotProduct(p,q,p,q),h&&(h[0]=r))),s},b.getSegmToSegmSqrDist=function(a,c,d,e){var f=b.sqrSegmentDist(a.getX(),a.getY(),c.getX(),c.getY(),d.getX(),d.getY()),g=f;return g>0&&(f=b.sqrSegmentDist(a.getX(),a.getY(),c.getX(),c.getY(),e.getX(),e.getY()),g>f&&(g=f),g>0&&(f=b.sqrSegmentDist(d.getX(),d.getY(),e.getX(),e.getY(),a.getX(),a.getY()),g>f&&(g=f),g>0&&(f=b.sqrSegmentDist(d.getX(),d.getY(),e.getX(),e.getY(),c.getX(),c.getY()),g>f&&(g=f)))),g},b.getVectorProjection=function(a,c,d,e,f,g,h){var i,j=f-a,k=g-c,l=d-a,m=e-c,n=b.vDotProduct(l,m,l,m);if(b.isEqualEps(n,0))i=new GPoint(f,g);else{var o=b.vDotProduct(j,k,l,m)/n;i=0>=o&&h?new GPoint(a,c):new GPoint(l*o+a,m*o+c)}return i},b.solveLinear2Pseudo=function(a,c,d,e,f,g){var h=b.getLinesIntersection(a,c,-d,e,f,-g);if(null==h){var i,j;b.isEqualEps(a+c,0)||b.isEqualEps(d,0)&&!b.isEqualEps(g,0)?b.isEqualEps(e+f,0)||b.isEqualEps(g,0)&&!b.isEqualEps(d,0)?b.isEqualEps(c,0)&&b.isEqualEps(f,0)?b.isEqualEps(a,0)&&b.isEqualEps(e,0)?(i=0,j=0):(j=0,i=b.isEqualEps(a,0)?g/e:d/a):(i=0,j=b.isEqualEps(c,0)?g/f:d/c):(i=g/(e+f),j=i):(i=d/(a+c),j=i),b.isEqualEps(a*i+c*j,d)&&b.isEqualEps(e*i+f*j,g)&&(h=new GPoint(i,j))}return h},b.divideQuadraticCurve=function(a,b,c,d,e,f){var g=a+d*(b-a),h=b+d*(c-b),i=g+d*(h-g);e[0]=a,e[1]=g,e[2]=i,f[0]=i,f[1]=h,f[2]=c},b.evalCubic=function(a,b,c,d,e){return 0==e?d:1==e?a+b+c+d:((e*a+b)*e+c)*e+d},b.getCubicCurveSplits=function(a,c,d,e,f,g,h){var i=[0,1];b.getQuadraticRoots(a,c,d,i),b.getQuadraticRoots(e,f,g,i);var j=c*e-f*a,k=2*(d*e-g*a),l=d*f-g*c;return b.getQuadraticRoots(j,k,l,i),GUtil.uSortSegment(0,1,i,h)},b.getCtrlPtsCasteljau=function(a,b,c,d,e,f,g,h){var i=a+e*(b-a),j=b+e*(c-b),k=c+e*(d-c),l=i+e*(j-i),m=j+e*(k-j),n=l+e*(m-l);if((null==f||1==f)&&(g[0]=a,g[1]=i,g[2]=l,g[3]=n),null==f||2==f){if(2==f)var h=g;h[0]=n,h[1]=m,h[2]=k,h[3]=d}},b.getCtrlPts=function(a,c,d,e,f,g,h){var i;return 0==f?void b.getCtrlPtsCasteljau(a,d,e,c,g,1,h):1==g?void b.getCtrlPtsCasteljau(a,d,e,c,f,2,h):(b.getCtrlPtsCasteljau(a,d,e,c,f,2,h),i=(g-f)/(1-f),void b.getCtrlPtsCasteljau(h[0],h[1],h[2],h[3],i,1,h))},b.evalPoly=function(a,b,c){var d=0,e=null;if(0>b)return null;if(b>0)if(0!=c)if(e=a[0],1==c)for(d=1;b>=d;++d)e+=a[d];else for(d=1;b>=d;++d)e=e*c+a[d];else e=a[b];else e=a[b];return e},b.getCoeffPolyDeriv=function(a,b,c){var d=0,e=!1;if(b>=1){for(d=0;b>d;++d)c[d]=a[d]*(b-d);e=!0}return e},b.getCubicRoots=function(a,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=0,x=new Float64Array(4),y=new Float64Array(4),z=new Float64Array(3),A=new Float64Array(2),B=-g;if(c>=d)return 0;if(a[0]<0)for(v=0;4>v;++v)x[v]=-a[v];else for(v=0;4>v;++v)x[v]=a[v];return m=x[0],n=x[1],o=x[2],p=x[3],0==c&&1==d?b.inversePolyUnaryInterval(x,3,y):b.inversePolyInterval(x,3,c,d,y),0==b.estimPositiveRootsDescartes(y,3)?0:(b.getCoeffPolyDeriv(x,3,z),A[0]=6*m,A[1]=2*n,j=n*n-z[0]*o,l=0,0==j?(l=1,h=-n/z[0],i=h):j>0&&(l=2,k=Math.sqrt(j),h=(-n-k)/z[0],i=(-n+k)/z[0]),q=b.evalCubic(m,n,o,p,c),r=b.evalCubic(m,n,o,p,d),0==l||h>=d||c>=i?q>=B&&g>=q?f&&(e[w]=c,w+=1):r>=B&&g>=r?f&&(e[w]=d,w+=1):0>q&&r>0&&(u=b.locateByNewton(c,d,q,r,x,3,z,A,g),e[w]=null!=u?u:(d+c)/2,w+=1):c>=h&&i>=d?q>=B&&g>=q?f&&(e[w]=c,w+=1):r>=B&&g>=r?f&&(e[w]=d,w+=1):q>0&&0>r&&(u=b.locateByNewton(c,d,q,r,x,3,z,A,g),e[w]=null!=u?u:(d+c)/2,w+=1):h>c&&i>=d?(s=b.evalCubic(m,n,o,p,h),s>=B&&g>=s?(e[w]=h,w+=1):s>0&&(q>=B&&g>=q?f&&(e[w]=c,w+=1):0>q&&(u=b.locateByNewton(c,h,q,s,x,3,z,A,g),e[w]=null!=u?u:(c+h)/2,w+=1),r>=B&&g>=r?f&&(e[w]=d,w+=1):0>r&&(u=b.locateByNewton(h,d,s,r,x,3,z,A,g),e[w]=null!=u?u:(h+d)/2,w+=1))):c>=h&&d>i?(t=b.evalCubic(m,n,o,p,i),t>=B&&g>=t?(e[w]=i,w+=1):0>t&&(q>=B&&g>=q?f&&(e[w]=c,w+=1):q>0&&(u=b.locateByNewton(c,i,q,t,x,3,z,A,g),e[w]=null!=u?u:(c+i)/2,w+=1),r>=B&&g>=r?f&&(e[w]=d,w+=1):r>0&&(u=b.locateByNewton(i,d,t,r,x,3,z,A,g),e[w]=null!=u?u:(i+d)/2,w+=1))):h==i?(s=b.evalCubic(m,n,o,p,h),s>=B&&g>=s?(e[w]=h,w+=1):q>=B&&g>=q?f&&(e[w]=c,w+=1):r>=B&&g>=r?f&&(e[w]=d,w+=1):0>s&&r>0?(u=b.locateByNewton(h,d,s,r,x,3,z,A,g),e[w]=null!=u?u:(h+d)/2,w+=1):0>q&&s>0&&(u=b.locateByNewton(c,h,q,s,x,3,z,A,g),e[w]=null!=u?u:(c+h)/2,w+=1)):(s=b.evalCubic(m,n,o,p,h),t=b.evalCubic(n,n,o,p,i),0>=s||t>=0?(s>=B&&g>=s&&(e[w]=h,w+=1),0>=s&&(r>=B&&g>=r?f&&(e[w]=d,w+=1):0>t&&r>0&&(u=b.locateByNewton(i,d,t,r,x,3,z,A,g),e[w]=null!=u?u:(i+d)/2,w+=1)),t>=B&&g>=t&&(e[w]=i,w+=1),t>=0&&(q>=B&&g>=q?f&&(e[w]=c,w+=1):0>q&&s>0&&(u=b.locateByNewton(c,h,q,s,x,3,z,A,g),e[w]=null!=u?u:(c+h)/2,w+=1))):(u=b.locateByNewton(h,i,s,t,x,3,z,A,g),e[w]=null!=u?u:(h+i)/2,w+=1,q>=B&&g>=q?f&&(e[w]=c,w+=1):0>q&&s>0&&(u=b.locateByNewton(c,h,q,s,x,3,z,A,g),e[w]=null!=u?u:(c+h)/2,w+=1),r>=B&&g>=r?(e[w]=d,w+=1):0>t&&r>0&&(u=b.locateByNewton(i,d,t,r,x,3,z,A,g),e[w]=null!=u?u:(i+d)/2,w+=1))),w)},b._maxIter=100,b.locateByNewton=function(a,c,d,e,f,g,h,i,j,k,l){var m,n,o,p,q,r,s,t,u,v,w,x,y,z=null,A=g-1,B=-j,C=-b.defaultEps,D=0,E=j+1,F=[],G=[],H=[],I=[],J=[];if(d>=B&&j>=d)return a;if(e>=B&&j>=e)return c;if(p=a,q=c,3==g)o=-i[1]/i[0],a>o||o>c?(n=i[0]*a+i[1],n>0&&d>0||0>n&&0>d?(z=a,E=d):(n=i[0]*c+i[1],n>0&&e>0||0>n&&0>e?(z=c,E=e):z=null)):(E=b.evalPoly(f,g,o),E>=B&&j>=E?z=o:E>0&&d>0||0>E&&0>d?(p=o+j,E=b.evalPoly(f,g,p),n=i[0]*p+i[1],n>0&&E>0||0>n&&0>E?z=p:(n=i[0]*c+i[1],n>0&&e>0||0>n&&0>e?(z=c,E=e):z=null)):E>0&&e>0||0>E&&0>e?(q=o-j,E=b.evalPoly(f,g,q),n=i[0]*q+i[1],n>0&&E>0||0>n&&0>E?z=q:(n=i[0]*a+i[1],n>0&&d>0||0>n&&0>d?(z=a,E=d):z=null)):z=null);else{if(5!=g)throw new Error("Unsupported polynomial degree.");if(x=!1,y=!1,0>d&&e>0||d>0&&0>e?y=!0:k&&l&&(x=!0),t=!0,w=!1,b.getCubicRoots(i,a,c,J,w,j),D=0,0==J.length)p=a,H[0]=d,q=c,H[1]=e,x&&(G[0]=l[0],G[1]=l[1]);else for(GUtil.uSortSegment(a,c,J,I),p=a,H[0]=d,x&&(G[0]=l[0]);D<=I.length&&(D>0&&(p=q,H[0]=H[1],x&&(G[0]=G[1])),D<I.length?(q=I[D],H[1]=null,x&&(G[1]=null)):(q=c,H[1]=e,x&&(G[1]=l[1])),!(y&&(null==H[1]&&(H[1]=b.evalPoly(f,g,q)),b.isEqualEps(H[1],0,j)&&(z=q,E=H[1],t=!1),H[0]>0&&H[1]<0||H[0]<0&&H[1]>0)))&&(!x||(u=b.countRootsNSturm(f,g,h,p,q,k,G,H),0==u));)++D;if(t&&0==D&&(n=b.evalPoly(i,i.length-1,a),(n>0&&d>0||0>n&&0>d)&&(z=a,E=d,t=!1)),t&&D==I.length&&(n=b.evalPoly(i,i.length-1,c),(n>0&&e>0||0>n&&0>e)&&(z=c,E=e,t=!1)),t){for(r=H[0],s=H[1],x&&(F=G),z=(p+q)/2,n=b.evalPoly(i,i.length-1,z);q-p>j&&t;)z=(p+q)/2,E=b.evalPoly(f,g,z),E>=B&&j>=E?t=!1:n>0&&E>0||0>n&&0>E?t=!1:E>0&&0>r||0>E&&r>0?(q=z,s=E,x&&(F[1]=null)):E>0&&0>s||0>E&&s>0?(p=z,r=E,x&&(F[0]=null)):y||!x?(t=!1,z=null):(H=[r,E],G=[F[0],null],u=b.countRootsNSturm(f,g,h,p,z,k,G,H),u>0?(q=z,s=E,F[0]=G[0],F[1]=G[1]):null!=F[1]&&G[1]==F[1]?t=!1:(p=z,r=E,F[0]=G[0]));t&&(z=(p+q)/2,E=b.evalPoly(f,g,z))}}for(D=1;null!=z&&(B>E||E>j)&&D<b._maxIter;)m=b.evalPoly(h,A,z),m>C&&m<b.defaultEps?(E=b.evalPoly(f,g,z),(B>E||E>j)&&(z=null)):(E=b.evalPoly(f,g,z),m=E/m,v=z,z-=m,(p>=z||z>=q)&&(z=null),m>0?q=v:0>m&&(p=v)),++D;return D==b._maxIter&&(z=null),z},b.getQuadraticRoots=function(a,b,c,d){var e,f;0==a?0!=b&&d.push(-c/b):(e=b*b-4*a*c,0==e?d.push(-b/(2*a)):e>0&&(f=Math.sqrt(e),d.push((-b+f)/(2*a)),d.push((-b-f)/(2*a))))},b._pseudoRem=function(a,b,c){var d,e,f,g,h,i=[],j=[],k=!0,l=b[0];if(b.length>a.length)return c=a,1;for(g=2;g<=a.length-b.length+1;++g)l*=b[0];for(g=0;g<a.length;++g)i[g]=a[g]*l;for(;k;){for(e=i[0]/b[0],f=!1,d=1;d<b.length;++d)h=i[d]-e*b[d],(0!=h||f)&&(j.push(h),0!=h&&(f=!0));for(d=b.length;d<i.length;++d)j.push(i[d]);j.length>=b.length?(i=j,j=[]):k=!1}if(j.length>0)for(g=0;g<j.length;++g)c[g]=j[g];return l},b.getSturmPRS=function(a,c,d,e){var f,g,h,i,j,k,l,m=[],n=[],o=[],p=[],q=[],r=[];for(n[0]=null,e[0]=a,e[1]=d,m[0]=a[0],m[1]=d[0],o[0]=1,n[1]=1,p[0]=1,p[1]=m[1],r[0]=1,r[1]=1,f=1;c>f&&(q=[],l=b._pseudoRem(e[f-1],e[f],q),0!=q.length);++f){for(e[f+1]=[],g=0;g<q.length;++g)e[f+1][g]=q[g]/n[f];for(o[f]=e[f+1].length-e[f].length,m[f+1]=e[f+1][0],i=1,j=1,k=m[f+1],h=2;h<=o[f];++h)i*=p[f],j=-j,k*=m[f+1];n[f+1]=j*i*p[f]*m[f],p[f+1]=k/i,r[f+1]=n[f]>0&&l>0||n[f]<0&&0>l?-r[f-1]:r[f-1]}for(f=2;f<e.length;++f)if(r[f]<0)for(g=0;g<e[f].length;++g)e[f][g]=-e[f][g]},b.countRootsNSturm=function(a,c,d,e,f,g,h,i){var j,k,l,m=0,n=0;if(null==h[0]){for(null==i[0]&&(i[0]=b.evalPoly(g[0],g[0].length-1,e)),j=i[0],l=1;l<g.length;++l)k=b.evalPoly(g[l],g[l].length-1,e),0!=k&&(0>j&&k>0||j>0&&0>k)&&(++m,j=k);h[0]=m}else m=h[0];if(null==h[1]){for(null==i[1]&&(i[1]=b.evalPoly(g[0],g[0].length-1,f)),j=i[1],l=1;l<g.length;++l)k=b.evalPoly(g[l],g[l].length-1,f),0!=k&&(0>j&&k>0||j>0&&0>k)&&(++n,j=k);h[1]=n}else n=h[1];return m>n?m-n:n-m},b.locRootsSturm=function(a,c,d,e,f,g,h,i,j,k){var l,m,n,o,p;if(!(1>=h)&&(l=(e+f)/2,m=[i[0],null],n=[j[0],null],o=b.countRootsNSturm(a,c,d,e,l,g,m,n),p=h-o,1==o&&k.push([e,l,n[0],n[1]]),o>1&&b.locRootsSturm(a,c,d,e,l,g,o,m,n,k),1==p&&k.push([l,f,n[1],j[1]]),p>1)){var q=[m[1],i[1]],r=[n[1],j[1]];b.locRootsSturm(a,c,d,l,f,g,p,q,r,k)}},b.shiftPoly=function(a,c,d,e){var f,g,h=[];for(h[0]=1,f=1;c>=f;++f)h.push(d*h[f-1]);for(e[0]=a[0],f=1;c>=f;++f)for(e[f]=a[f],g=0;f>g;++g)e[f]+=b.combNK(c-g,f-g)*a[g]*h[f-g]},b._numComb5=[1,5,10,10,5,1],b._numComb4=[1,4,6,4,1],b._numComb3=[1,3,3,1],b._numComb2=[1,2,1],b._numComb1=[1,1],b.combNK=function(a,c){if(!(5>=a&&a>=c))throw new Error("Combinations calculation not implemented");return 5==a?b._numComb5[c]:4==a?b._numComb4[c]:3==a?b._numComb3[c]:2==a?b._numComb2[c]:1==a?b._numComb1[c]:0},b.shiftPolyOne=function(a,c,d){var e,f;for(d[0]=a[0],e=1;c>=e;++e)for(d[e]=a[e],f=0;e>f;++f)d[e]+=b.combNK(c-f,e-f)*a[f]},b.inversePolyInterval=function(a,c,d,e,f){var g,h,i,j=new Float32Array(c+1);for(g=0;c>=g;++g)j[g]=a[g];if(b.shiftPoly(a,c,d,j),h=e-d,0!=h)for(i=1,g=1;c>=g;++g)i/=h,j[c-g]*=i;b.inversePolyUnaryInterval(j,c,f)},b.inversePolyUnaryInterval=function(a,c,d){var e,f=new Float32Array(c+1);for(e=0;c>=e;++e)f[e]=a[c-e];b.shiftPolyOne(f,c,d)},b.estimPositiveRootsDescartes=function(a,b){var c,d=[],e=0,f=0;for(c=0;b>=c;++c)0!=a[c]&&(d.push(a[c]),++e);for(c=0;e-1>c;++c)(d[c]>0&&d[c+1]<0||d[c]<0&&d[c+1]>0)&&(f+=1);return f},b.convertToConstrain=function(a,c,d,e,f){var g,h,i,j,k,l=.4142,m=new GTransform(1,0,0,1,0,0);f&&(m=m.rotated(f)),m=m.translated(a,c);var n=m.inverted(),o=n.mapPoint(new GPoint(d,e)),p=o.getX(),q=o.getY();return g=Math.abs(p),h=Math.abs(q),b.isEqualEps(g,0)||b.isEqualEps(h,0)||b.isEqualEps(g-h,0)?(k=p,j=q):g>h?(k=p,i=h/g,j=l>i?0:0>q?-g:g):(j=q,i=g/h,k=l>i?0:0>p?-h:h),m.mapPoint(new GPoint(k,j))},a.GMath=b}(this),function(a){function b(){}b.indexOfEquals=function(a,c,d){for(var e=0;e<a.length;++e)if(b.equals(a[e],c,d))return e;return-1},b.equals=function(a,c,d){if(a||a!==c){if(a&&c){if(a.constructor.equals||c.constructor.equals)return a.constructor===c.constructor?a.constructor.equals(a,c):!1;if(a instanceof Date||c instanceof Date)return a instanceof Date&&c instanceof Date?+a==+c:!1;if(a instanceof Array||c instanceof Array){if(a instanceof Array&&c instanceof Array){if(a.length!==c.length)return!1;for(var e=0;e<a.length;++e)if(!b.equals(a[e],c[e],d))return!1;return!0}return!1}var f=typeof a,g=typeof c;if(f!==g)return!1;if("number"===f)return isNaN(a)||isNaN(c)?isNaN(a)&&isNaN(c):GMath.isEqualEps(a,c);if("string"===f)return 0===a.localeCompare(c);if("boolean"===f)return+a==+c;if("object"===f){if(d){var h=Object.keys(a),i=Object.keys(c);if(!b.equals(h,i,d))return!1;for(var e=0;e<h.length;++e)if(!b.equals(a[h[e]],c[h[e]]),d)return!1;return!0}return a===c}return!1}return!1}return!0},b.containsObjectKey=function(a,b){for(var c in b)if(a.indexOf(c)>=0)return!0;return!1},b.dictionaryContainsValue=function(a,b){for(var c in a)if(a[c]===b)return!0;return!1};var c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");b.uuid=function(a){var b,d=c,e=[],f=d.length,a=a?a:32;for(b=0;a>b;b++)e[b]=d[0|Math.random()*f];return e.join("")},b.replaceAll=function(a,b,c){for(var d=a;d.indexOf(b)>=0;)d=d.replace(b,c);return d},b.uSortSegment=function(a,b,c,d){var e=0;if(c.sort(function(a,b){return a-b}),c[0]>=a&&c[0]<=b&&(d[0]=c[0],e=1,1==c.length))return e;for(var f=1;f<c.length;f++)c[f]!=c[f-1]&&c[f]>=a&&c[f]<=b&&(d.push(c[f]),++e);return e},b.escape=function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},b.unescape=function(a){var c=b.replaceAll(a,"&lt;","<");return c=b.replaceAll(c,"&gt;",">"),c=b.replaceAll(c,"&quot;",'"'),c=b.replaceAll(c,"&#039;","'"),c=b.replaceAll(c,"&amp;","&")},b.isNumeric=function(a){return a-parseFloat(a)>=0},b.formatNumber=function(a,b,c){return c=c||",",b="number"==typeof b?b:3,GMath.round(a,!1,b).toString().replace(".",c)},b.parseNumber=function(a){for(var c="",d=!1,e=a.length;e>=0;--e){var f=a.charAt(e);","!==f||d?(b.isNumeric(f)||"-"===f||"+"===f)&&(c=f+c):c="."+c}return parseFloat(c)},a.GUtil=b,$.ajaxTransport("+*",function(a,b,c){return window.FormData&&(a.dataType&&("blob"==a.dataType||"arraybuffer"==a.dataType)||a.data&&(window.Blob&&a.data instanceof Blob||window.ArrayBuffer&&a.data instanceof ArrayBuffer))?{send:function(b,c){var d=new XMLHttpRequest,e=a.url||window.location.href,f=a.type||"GET",g=a.dataType||"text",h=a.data||null,i=a.async||!0;d.addEventListener("load",function(){console.log("XHR LOADED",d.response);var a={};a[g]=d.response,c(d.status,d.statusText,a,d.getAllResponseHeaders())}),d.open(f,e,i),d.responseType=g,d.send(h)},abort:function(){c.abort()}}:void 0})}(this),function(a){function b(){}b.InputType={String:0,ArrayBuffer:1},b.prototype.getInputType=function(){throw new Error("Not Supported.")},b.prototype.getMimeType=function(){throw new Error("Not Supported.")},b.prototype.getFileExtensions=function(){throw new Error("Not Supported.")},b.prototype.readInput=function(){throw new Error("Not Supported.")},a.GReader=b}(this),function(a){function b(){}b._readers=[],b.registerReader=function(a){b._readers.push(a)},b.read=function(a,c,d,e){function f(a){a?i.readInput(a,d,e):d(null)}var g=a.toLowerCase();if(g.indexOf(".")>0){var h=g.lastIndexOf(".");g=g.substr(h+1)}for(var i=null,j=0;j<b._readers.length;++j){var k=b._readers[j];if(k.getMimeType()===a){i=k;break}for(var l=k.getFileExtensions(),m=0;m<l.length;++m)if(l[m].toLowerCase()===g){i=k;break}}if(i){var n=i.getInputType();if(n===GReader.InputType.String)if("string"==typeof c)f(c);else{var o=c instanceof ArrayBuffer?new Blob([c]):c,p=new FileReader;p.onload=function(a){f(a.target.result)},p.readAsText(o)}else if(n===GReader.InputType.ArrayBuffer)if(c instanceof ArrayBuffer)f(c);else{var o="string"==typeof c?new Blob([c]):c,p=new FileReader;p.onload=function(a){f(a.target.result)},p.readAsArrayBuffer(o)}else f(null)}else d(null)},a.GIO=b}(this),function(a){function b(){document.addEventListener("keydown",function(a){document.activeElement&&($(document.activeElement).is(":input")&&!$(document.activeElement).is(":button")||document.activeElement.isContentEditable)||this._updateModifiers(a)}.bind(this),!0),document.addEventListener("keyup",function(a){this._updateModifiers(a)}.bind(this),!0)}GObject.inheritAndMix(b,GObject,[GEventTarget]),b.Modifiers=function(){},b.Modifiers.metaKey=!1,b.Modifiers.shiftKey=!1,b.Modifiers.optionKey=!1,b.Modifiers.spaceKey=!1,b.Modifiers.prototype.toString=function(){return"[Object GPlatform.Modifiers]"},b.ModifiersChangedEvent=function(){this.changed=new b.Modifiers},GObject.inherit(b.ModifiersChangedEvent,GEvent),b.ModifiersChangedEvent.prototype.changed=null,b.ModifiersChangedEvent.prototype.toString=function(){return"[Object GPlatform.ModifiersChangedEvent]"},b.prototype.modifiers=new b.Modifiers,b.prototype._modifiersChangedEventCache=new b.ModifiersChangedEvent,b.prototype.scheduleFrame=function(a){return window.requestAnimationFrame(a)},b.prototype.cancelFrame=function(a){window.cancelRequestAnimationFrame(a)},b.prototype._updateModifiers=function(a){var c=!1,d=!1,e=!1,f=!1,g=GSystem.operatingSystem!==GSystem.OperatingSystem.OSX_IOS||GSystem.hardware!==GSystem.Hardware.Desktop?a.ctrlKey:a.metaKey;g!=this.modifiers.metaKey&&(e=!0,this.modifiers.metaKey=g),a.altKey!=this.modifiers.optionKey&&(c=!0,this.modifiers.optionKey=a.altKey),a.shiftKey!=this.modifiers.shiftKey&&(d=!0,this.modifiers.shiftKey=a.shiftKey);var h="keydown"===a.type&&32===a.keyCode?!0:"keyup"===a.type&&32===a.keyCode?!1:this.modifiers.spaceKey;h!=this.modifiers.spaceKey&&(f=!0,this.modifiers.spaceKey=h),(e||c||d||e||f)&&this.hasEventListeners(b.ModifiersChangedEvent)&&(this._modifiersChangedEventCache.changed.metaKey=e,this._modifiersChangedEventCache.changed.optionKey=c,this._modifiersChangedEventCache.changed.shiftKey=d,this._modifiersChangedEventCache.changed.spaceKey=f,this.trigger(this._modifiersChangedEventCache))},a.GPlatform=b,a.ifPlatform=new b;for(var c=0,d=["ms","moz","webkit","o"],e=0;e<d.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[d[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[d[e]+"CancelAnimationFrame"]||window[d[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a){var b=(new Date).getTime(),d=Math.max(0,16-(b-c)),e=window.setTimeout(function(){a(b+d)},d);return c=b+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}(this),function(a){function b(a,c){this._value=a,this._unit=c?c:b.Unit.PT}b.Unit={PT:"t",PX:"x",PC:"p",IN:"i",MM:"m",CM:"c"};var c=72,d={t:1,x:1,p:c/6,i:c,m:c/25.4,c:c/2.54};b.parseLength=function(a,c){if(!a)return null;if(a=a.trim(),0==a.length)return null;var d=GUtil.parseNumber(a);if("number"!=typeof d)return null;var e=c?c:b.Unit.PT,f=a.substr(d.toString().length);return f&&f.length>0&&(f=f.trim().toLowerCase(),f.length>=2&&"p"==f.charAt(0)&&"t"==f.charAt(1)?e=b.Unit.PT:f.length>=2&&"p"==f.charAt(0)&&"x"==f.charAt(1)?e=b.Unit.PX:f.length>=2&&"p"==f.charAt(0)&&"c"==f.charAt(1)?e=b.Unit.PC:f.length>=2&&"i"==f.charAt(0)&&"n"==f.charAt(1)?e=b.Unit.IN:f.length>=2&&"m"==f.charAt(0)&&"m"==f.charAt(1)?e=b.Unit.MM:f.length>=2&&"c"==f.charAt(0)&&"m"==f.charAt(1)?e=b.Unit.CM:f.length>=1&&"m"==f.charAt(0)&&(e=b.Unit.M)),new b(d,e)},b.parseEquation=function(a,c){c=c||b.Unit.PT;var d=new e.Context(c),f=new e.Evaluator(d);try{return result=f.evaluate(a),new b(result,c)}catch(g){return null}},b.parseEquationValue=function(a){var c=b.parseEquation(a);return c?c.getValue():null},b.prototype._value=null,b.prototype._unit=b.Unit.PT,b.prototype.getValue=function(){return this._value},b.prototype.getUnit=function(){return this._unit},b.prototype.toPoint=function(){return this._unit!=b.Unit.PT?d[this._unit]*this._value:this._value},b.prototype.toUnit=function(a){if(this._unit!=a){var b=this.toPoint();return b/d[a]}return this._value},b.prototype.convert=function(a){if(this._unit!=a){var c=this.toPoint();return new b(c/d[a],a)}return new b(this._value,a)},b.prototype.toString=function(a){var c=GUtil.formatNumber(this._value,a);switch(this._unit){case b.Unit.PT:c+="pt";break;case b.Unit.PX:c+="px";break;case b.Unit.PC:c+="pc";
break;case b.Unit.IN:c+="in";break;case b.Unit.MM:c+="mm";break;case b.Unit.CM:c+="cm"}return c};var e={};e.Token={Operator:"Operator",Identifier:"Identifier",Number:"Number"},e.Lexer=function(){function a(){var a=s;return r>a?q.charAt(a):"\x00"}function b(){var a="\x00",b=s;return r>b&&(a=q.charAt(b),s+=1),a}function c(a){return"	"===a||" "===a||" "===a}function d(a){return a>="a"&&"z">=a||a>="A"&&"Z">=a}function f(a){return a>="0"&&"9">=a}function g(a,b){return{unit:a,value:b,start:t,end:s-1}}function h(){for(var d;r>s&&(d=a(),c(d));)b()}function i(){var c=a();return"+-*/()^%=;,".indexOf(c)>=0?g(u.Operator,b()):void 0}function j(a){return"_"===a||d(a)}function k(a){return j(a)||f(a)}function l(){var c,d;if(c=a(),!j(c))return void 0;for(d=b();;){if(c=a(),!k(c))break;d+=b()}return g(u.Identifier,d)}function m(){var c,e;if(c=a(),!f(c)&&"."!==c)return void 0;if(e="","."!==c)for(e=b();;){if(c=a(),!f(c))break;e+=b()}if("."===c||","===c)for(e+=b();;){if(c=a(),!f(c))break;e+=b()}if("e"===c||"E"===c){if(e+=b(),c=a(),"+"!==c&&"-"!==c&&!f(c))throw c="character "+c,s>=r&&(c="<end>"),new SyntaxError("Unexpected "+c+" after the exponent sign");for(e+=b();;){if(c=a(),!f(c))break;e+=b()}}if(d(c))for(e+=b();;){if(c=a(),!d(c))break;e+=b()}if("."===e)throw new SyntaxError("Expecting decimal digits after the dot sign");return g(u.Number,e)}function n(a){q=a,r=a.length,s=0}function o(){var b;if(h(),s>=r)return void 0;if(t=s,b=m(),"undefined"!=typeof b)return b;if(b=i(),"undefined"!=typeof b)return b;if(b=l(),"undefined"!=typeof b)return b;throw new SyntaxError("Unknown token from character "+a())}function p(){var a,b;b=s;try{a=o(),delete a.start,delete a.end}catch(c){a=void 0}return s=b,a}var q="",r=0,s=0,t=0,u=e.Token;return{reset:n,next:o,peek:p}},e.Parser=function(){function a(a,b){return"undefined"!=typeof a&&a.unit===m.Operator&&a.value===b}function b(){for(var b,c,d=[];;){if(c=j(),"undefined"==typeof c)break;if(d.push(c),b=l.peek(),!a(b,","))break;l.next()}return d}function c(c){var d,e=[];if(d=l.next(),!a(d,"("))throw new SyntaxError('Expecting ( in a function call "'+c+'"');if(d=l.peek(),a(d,")")||(e=b()),d=l.next(),!a(d,")"))throw new SyntaxError('Expecting ) in a function call "'+c+'"');return{FunctionCall:{name:c,args:e}}}function d(){var b,d;if(b=l.peek(),"undefined"==typeof b)throw new SyntaxError("Unexpected termination of expression");if(b.unit===m.Identifier)return b=l.next(),a(l.peek(),"(")?c(b.value):{Identifier:b.value};if(b.unit===m.Number)return b=l.next(),{Number:b.value};if(a(b,"(")){if(l.next(),d=i(),b=l.next(),!a(b,")"))throw new SyntaxError("Expecting )");return{Expression:d}}throw new SyntaxError("Parse error, can not process token "+b.value)}function f(){var b,c;return b=l.peek(),a(b,"-")||a(b,"+")?(b=l.next(),c=f(),{Unary:{operator:b.value,expression:c}}):d()}function g(){var b,c;for(b=f(),c=l.peek();a(c,"*")||a(c,"/");)c=l.next(),b={Binary:{operator:c.value,left:b,right:f()}},c=l.peek();return b}function h(){var b,c;for(b=g(),c=l.peek();a(c,"+")||a(c,"-");)c=l.next(),b={Binary:{operator:c.value,left:b,right:g()}},c=l.peek();return b}function i(){var b,c;return c=h(),"undefined"!=typeof c&&c.Identifier?(b=l.peek(),a(b,"=")?(l.next(),{Assignment:{name:c,value:i()}}):c):c}function j(){return i()}function k(a){var b,c;if(l.reset(a),b=j(),c=l.next(),"undefined"!=typeof c)throw new SyntaxError("Unexpected token "+c.value);return{Expression:b}}var l=new e.Lexer,m=e.Token;return{parse:k}},e.Context=function(a){var b,c;return b={pi:3.141592653589793,phi:1.618033988749895},c={abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,ln:Math.ln,random:Math.random,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan},{Unit:a,Constants:b,Functions:c,Variables:{}}},e.Evaluator=function(a){function c(d){var e,f,h,i,j;if(d.hasOwnProperty("Expression"))return c(d.Expression);if(d.hasOwnProperty("Number")){var k=b.parseLength(d.Number,a.Unit);if(!k)throw new SyntaxError("Invalid length "+d.Number);return k.toUnit(a.Unit)}if(d.hasOwnProperty("Binary"))switch(d=d.Binary,e=c(d.left),f=c(d.right),d.operator){case"+":return e+f;case"-":return e-f;case"*":return e*f;case"/":return e/f;default:throw new SyntaxError("Unknown operator "+d.operator)}if(d.hasOwnProperty("Unary"))switch(d=d.Unary,h=c(d.expression),d.operator){case"+":return h;case"-":return-h;default:throw new SyntaxError("Unknown operator "+d.operator)}if(d.hasOwnProperty("Identifier")){if(g.Constants.hasOwnProperty(d.Identifier))return g.Constants[d.Identifier];if(g.Variables.hasOwnProperty(d.Identifier))return g.Variables[d.Identifier];throw new SyntaxError("Unknown identifier")}if(d.hasOwnProperty("Assignment"))return f=c(d.Assignment.value),g.Variables[d.Assignment.name.Identifier]=f,f;if(d.hasOwnProperty("FunctionCall")){if(h=d.FunctionCall,g.Functions.hasOwnProperty(h.name)){for(i=[],j=0;j<h.args.length;j+=1)i.push(c(h.args[j]));return g.Functions[h.name].apply(null,i)}throw new SyntaxError("Unknown function "+h.name)}throw new SyntaxError("Unknown syntax node")}function d(a){var b=f.parse(a);return c(b)}var f=new e.Parser,g=arguments.length<1?new e.Context(b.Unit.PT):a;return{evaluate:d}},a.GLength=b}(this),function(a){function b(a,b){this._x=a,this._y=b}b.equals=function(a,b){return a&&a==b?!0:a&&b?GMath.isEqualEps(a._x,b._x)&&GMath.isEqualEps(a._y,b._y):!1},b.min=function(){for(var a=new b(null,null),c=0;c<arguments.length;++c)(null==a._x||arguments[c]._x<a._x)&&(a._x=arguments[c]._x),(null==a._y||arguments[c]._y<a._y)&&(a._y=arguments[c]._y);return a},b.max=function(){for(var a=new b(null,null),c=0;c<arguments.length;++c)(null==a._x||arguments[c]._x>a._x)&&(a._x=arguments[c]._x),(null==a._y||arguments[c]._y>a._y)&&(a._y=arguments[c]._y);return a},b.prototype._x=0,b.prototype._y=0,b.prototype.getX=function(){return this._x},b.prototype.getY=function(){return this._y},b.prototype.subtract=function(a){return new b(this._x-a._x,this._y-a._y)},b.prototype.add=function(a){return new b(this._x+a._x,this._y+a._y)},b.prototype.translated=function(a,c){return new b(this._x+a,this._y+c)},b.prototype.rotated=function(a){var c=Math.cos(a),d=Math.sin(a);return new b(c*this._x-d*this._y,d*this._x+c*this._y)},b.prototype.rotatedAt=function(a,c){if(!c)return this.rotated(a);var d=Math.cos(a),e=Math.sin(a);return new b(d*(this._x-c._x)-e*(this._y-c._y)+c._x,e*(this._x-c._x)+d*(this._y-c._y)+c._y)},b.prototype.toString=function(){return"[Object GPoint(x="+this._x+", y="+this._y+"]"},a.GPoint=b}(this),function(a){function b(a,b,c,d){this._x=a?a:0,this._y=b?b:0,this._width=c?c:0,this._height=d?d:0}b.Side={TOP_LEFT:"tl",TOP_CENTER:"tc",TOP_RIGHT:"tr",RIGHT_CENTER:"rc",BOTTOM_RIGHT:"br",BOTTOM_CENTER:"bc",BOTTOM_LEFT:"bl",LEFT_CENTER:"lc",CENTER:"cc"},b.UNIT_RECT=new b(0,0,1,1),b.fromPoints=function(){var a=GPoint.min.apply(null,arguments),c=GPoint.max.apply(null,arguments);return new b(a.getX(),a.getY(),c.getX()-a.getX(),c.getY()-a.getY())},b.equals=function(a,b){return a||a!==b?a&&b?GMath.isEqualEps(a._x,b._x)&&GMath.isEqualEps(a._y,b._y)&&GMath.isEqualEps(a._width,b._width)&&GMath.isEqualEps(a._height,b._height):!1:!0},b.prototype._x=0,b.prototype._y=0,b.prototype._width=0,b.prototype._height=0,b.prototype.getX=function(){return this._x},b.prototype.getY=function(){return this._y},b.prototype.getWidth=function(){return this._width},b.prototype.getHeight=function(){return this._height},b.prototype.isEmpty=function(){return this._width<=0&&this._height<=0},b.prototype.containsPoint=function(a){return this.containsPointXY(a.getX(),a.getY())},b.prototype.containsPointXY=function(a,b){var c=this._x,d=this._x;if(this._width<0?c+=this._width:d+=this._width,c==d)return!1;if(c>a||a>d)return!1;var e=this._y,f=this._y;return this._height<0?e+=this._height:f+=this._height,e==f?!1:e>b||b>f?!1:!0},b.prototype.containsRect=function(a){var b=this._x,c=this._x;if(this._width<0?b+=this._width:c+=this._width,b==c)return!1;var d=a._x,e=a._x;if(a._width<0?d+=a._width:e+=a._width,d==e)return!1;if(b>d||e>c)return!1;var f=this._y,g=this._y;if(this._height<0?f+=this._height:g+=this._height,f==g)return!1;var h=a._y,i=a._y;return a._height<0?h+=a._height:i+=a._height,h==i?!1:f>h||i>g?!1:!0},b.prototype.intersectsRect=function(a){return this.intersectsRectXYWH(a._x,a._y,a._width,a._height)},b.prototype.intersectsRectXYWH=function(a,b,c,d){var e=this._x,f=this._x;if(this._width<0?e+=this._width:f+=this._width,e==f)return!1;var g=a,h=a;if(0>c?g+=c:h+=c,g==h)return!1;if(e>=h||g>=f)return!1;var i=this._y,j=this._y;if(this._height<0?i+=this._height:j+=this._height,i==j)return!1;var k=b,l=b;return 0>d?k+=d:l+=d,k==l?!1:i>=l||k>=j?!1:!0},b.prototype.expanded=function(a,c,d,e){return new b(this._x-a,this._y-c,this._width+a+d,this._height+c+e)},b.prototype.translated=function(a,c){return new b(this._x+a,this._y+c,this._width,this._height)},b.prototype.scaled=function(a,c){return new b(this._x*a,this._y*c,this._width*a,this._height*c)},b.prototype.scaledAt=function(a,c,d){return d?new b((this._x-d.getX())*a+d.getX(),(this._y-d.getY())*c+d.getY(),this._width*a,this._height*c):this.scaled(a,c)},b.prototype.united=function(a){var c=this._x,d=this._x;if(this._width<0?c+=this._width:d+=this._width,c==d)return a;var e=a._x,f=a._x;if(a._width<0?e+=a._width:f+=a._width,e==f)return this;var g=this._y,h=this._y;if(this._height<0?g+=this._height:h+=this._height,g==h)return a;var i=a._y,j=a._y;if(a._height<0?i+=a._height:j+=a._height,i==j)return this;var k=new b;return k._x=Math.min(c,e),k._y=Math.min(g,i),k._width=Math.max(d,f)-k._x,k._height=Math.max(h,j)-k._y,k},b.prototype.intersected=function(a){var c=this._x,d=this._x;if(this._width<0?c+=this._width:d+=this._width,c==d)return new b(0,0,0,0);var e=a._x,f=a._x;if(a._width<0?e+=a._width:f+=a._width,e==f)return new b(0,0,0,0);if(c>=f||e>=d)return new b(0,0,0,0);var g=this._y,h=this._y;if(this._height<0?g+=this._height:h+=this._height,g==h)return new b(0,0,0,0);var i=a._y,j=a._y;if(a._height<0?i+=a._height:j+=a._height,i==j)return new b(0,0,0,0);if(g>=j||i>=h)return new b(0,0,0,0);var k=new b;return k._x=Math.max(c,e),k._y=Math.max(g,i),k._width=Math.min(d,f)-k._x,k._height=Math.min(h,j)-k._y,k},b.prototype.toAlignedRect=function(){var a=Math.floor(this._x),c=Math.ceil(this._x+this._width),d=Math.floor(this._y),e=Math.ceil(this._y+this._height);return new b(a,d,c-a,e-d)},b.prototype.getSide=function(a){switch(a){case b.Side.TOP_LEFT:return new GPoint(this._x,this._y);case b.Side.TOP_CENTER:return new GPoint(this._x+this._width/2,this._y);case b.Side.TOP_RIGHT:return new GPoint(this._x+this._width,this._y);case b.Side.RIGHT_CENTER:return new GPoint(this._x+this._width,this._y+this._height/2);case b.Side.BOTTOM_RIGHT:return new GPoint(this._x+this._width,this._y+this._height);case b.Side.BOTTOM_CENTER:return new GPoint(this._x+this._width/2,this._y+this._height);case b.Side.BOTTOM_LEFT:return new GPoint(this._x,this._y+this._height);case b.Side.LEFT_CENTER:return new GPoint(this._x,this._y+this._height/2);case b.Side.CENTER:return new GPoint(this._x+this._width/2,this._y+this._height/2);default:throw new Error("Illegal Argument: "+a)}},b.prototype.getClosestSideName=function(a){var c=[b.Side.TOP_LEFT,b.Side.TOP_CENTER,b.Side.TOP_RIGHT,b.Side.LEFT_CENTER,b.Side.CENTER,b.Side.RIGHT_CENTER,b.Side.BOTTOM_LEFT,b.Side.BOTTOM_CENTER,b.Side.BOTTOM_RIGHT],d=1,e=1;return a.getX()<=this._x+this._width/3?d=0:a.getX()>=this._x+2*this._width/3&&(d=2),a.getY()<=this._y+this._height/3?e=0:a.getY()>=this._y+2*this._height/3&&(e=2),c[3*e+d]},b.prototype.getResizeTransform=function(a,c,d,e,f){var g=1,h=1,i=this._x+this._width/2,j=this._y+this._height/2;switch(a){case b.Side.TOP_LEFT:case b.Side.LEFT_CENTER:case b.Side.BOTTOM_LEFT:g=(this._width-c)/this._width,f?g+=g-1:i=this._x+this._width;break;case b.Side.TOP_RIGHT:case b.Side.RIGHT_CENTER:case b.Side.BOTTOM_RIGHT:g=(this._width+c)/this._width,f?g+=g-1:i=this._x}switch(a){case b.Side.TOP_LEFT:case b.Side.TOP_CENTER:case b.Side.TOP_RIGHT:h=(this._height-d)/this._height,f?h+=h-1:j=this._y+this._height;break;case b.Side.BOTTOM_LEFT:case b.Side.BOTTOM_CENTER:case b.Side.BOTTOM_RIGHT:h=(this._height+d)/this._height,f?h+=h-1:j=this._y}if(e)switch(a){case b.Side.TOP_CENTER:case b.Side.BOTTOM_CENTER:g=Math.abs(h);break;case b.Side.LEFT_CENTER:case b.Side.RIGHT_CENTER:h=Math.abs(g);break;default:Math.abs(g)>Math.abs(h)?h=GMath.isEqualEps(h,0)?g:h*Math.abs(g)/Math.abs(h):g=GMath.isEqualEps(g,0)?h:g*Math.abs(h)/Math.abs(g)}return new GTransform(1,0,0,1,-i,-j).multiplied(new GTransform(g,0,0,h,0,0)).multiplied(new GTransform(1,0,0,1,i,j))},b.prototype.toString=function(){return"[Object GRect(x="+this._x+", y="+this._y+", width="+this._width+", height="+this._height+")]"},a.GRect=b}(this),function(a){function b(a,b,c,d,e,f){this._sx="number"==typeof a?a:1,this._shy="number"==typeof b?b:0,this._shx="number"==typeof c?c:0,this._sy="number"==typeof d?d:1,this._tx="number"==typeof e?e:0,this._ty="number"==typeof f?f:0}b.serialize=function(a){return a.isIdentity()?[]:a.getMatrix()},b.deserialize=function(a){return a&&a.length>=6?new b(a[0],a[1],a[2],a[3],a[4],a[5]):new b},b.equals=function(a,b){return a&&a==b?!0:a&&b?GMath.isEqualEps(a._sx,b._sx)&&GMath.isEqualEps(a._shy,b._shy)&&GMath.isEqualEps(a._shx,b._shx)&&GMath.isEqualEps(a._sy,b._sy)&&GMath.isEqualEps(a._tx,b._tx)&&GMath.isEqualEps(a._ty,b._ty):!1},b.prototype._sx,b.prototype._shy,b.prototype._shx,b.prototype._sy,b.prototype._tx,b.prototype._ty,b.prototype.isIdentity=function(){return GMath.isEqualEps(this._sx,1)&&GMath.isEqualEps(this._shy,0)&&GMath.isEqualEps(this._shx,0)&&GMath.isEqualEps(this._sy,1)&&GMath.isEqualEps(this._tx,0)&&GMath.isEqualEps(this._ty,0)},b.prototype.isValid=function(){return Math.abs(this._sx)>GMath.defaultEps&&Math.abs(this._sy)>GMath.defaultEps},b.prototype.getMatrix=function(){return[this._sx,this._shy,this._shx,this._sy,this._tx,this._ty]},b.prototype.getDeterminant=function(){return this._sx*this._sy-this._shy*this._shx},b.prototype.getDeterminantReciprocal=function(){return 1/(this._sx*this._sy-this._shy*this._shx)},b.prototype.getTranslation=function(){return new GPoint(this._tx,this._ty)},b.prototype.getScaleFactor=function(){var a=.707106781*this._sx+.707106781*this._shx,b=.707106781*this._shy+.707106781*this._sy;return Math.sqrt(a*a+b*b)},b.prototype.getRotationFactor=function(){return Math.atan2(this._shx,this._sx)},b.prototype.multiplied=function(a){var c=this._sx,d=this._shy,e=this._shx,f=this._sy,g=this._tx,h=this._ty,i=c*a._sx+d*a._shx,j=e*a._sx+f*a._shx,k=g*a._sx+h*a._shx+a._tx;return d=c*a._shy+d*a._sy,f=e*a._shy+f*a._sy,h=g*a._shy+h*a._sy+a._ty,c=i,e=j,g=k,new b(c,d,e,f,g,h)},b.prototype.preMultiplied=function(a){var c=a._sx*this._sx+a._shy*this._shx,d=a._sx*this._shy+a._shy*this._sy,e=a._shx*this._shy+a._sy*this._sy,f=a._shx*this._sx+a._sy*this._shx,g=a._tx*this._sx+a._ty*this._shx+this._tx,h=a._tx*this._shy+a._ty*this._sy+this._ty;return new b(c,d,f,e,g,h)},b.prototype.inverted=function(){var a=this._sx,c=this._sy,d=this._shx,e=this._shy,f=this._tx,g=this._ty,h=1/(a*c-e*d),i=c*h;c=a*h,e=-e*h,d=-d*h;var j=-f*i-g*d;return g=-f*e-g*c,a=i,f=j,new b(a,e,d,c,f,g)},b.prototype.rotated=function(a){return this.multiplied(new b(Math.cos(a),Math.sin(a),-Math.sin(a),Math.cos(a),0,0))},b.prototype.translated=function(a,c){return this.multiplied(new b(1,0,0,1,a,c))},b.prototype.scaled=function(a,c){return c||(c=a),this.multiplied(new b(a,0,0,c,0,0))},b.prototype.skewed=function(a,c){return this.multiplied(new b(1,Math.tan(c),Math.tan(a),1,0,0))},b.prototype.map=function(a){if(!this.isIdentity()){var b=a.x;a.x=b*this._sx+a.y*this._shx+this._tx,a.y=b*this._shy+a.y*this._sy+this._ty}},b.prototype.mapPoint=function(a){if(this.isIdentity())return a;var b=a.getX(),c=a.getY(),d=b*this._sx+c*this._shx+this._tx,e=b*this._shy+c*this._sy+this._ty;return new GPoint(d,e)},b.prototype.mapRect=function(a){if(this.isIdentity()||null==a)return a;var b=a.getSide(GRect.Side.TOP_LEFT),c=a.getSide(GRect.Side.TOP_RIGHT),d=a.getSide(GRect.Side.BOTTOM_RIGHT),e=a.getSide(GRect.Side.BOTTOM_LEFT);return GRect.fromPoints(this.mapPoint(b),this.mapPoint(c),this.mapPoint(d),this.mapPoint(e))},b.prototype.toString=function(){return"[Object GTransform(sx="+this._sx.toString()+", shy="+this._shy.toString()+", shx="+this._shx.toString()+", sx="+this._sx.toString()+", tx="+this._tx.toString()+", ty="+this._ty.toString()+")]"},a.GTransform=b}(this),function(a){function b(){}b.Command={Move:1,Line:2,Curve:3,Curve2:4,Close:5},b.prototype.command=null,b.prototype.x=null,b.prototype.y=null,a.GVertex=b}(this),function(a){function b(){}b.prototype.rewindVertices=function(){return!1},b.prototype.readVertex=function(){return!1},b.prototype.toString=function(){return"[Object GVertexSource]"},a.GVertexSource=b}(this),function(a){function b(){}b.prototype.addVertex=function(){throw new Error("Not Supported")},b.prototype.appendVertices=function(a,b){if(a.rewindVertices(b?b:0))for(var c=new GVertex;a.readVertex(c);)this.addVertex(c.command,c.x,c.y)},b.prototype.clearVertices=function(){throw new Error("Not Supported.")},b.prototype.toString=function(){return"[Object GVertexTarget]"},a.GVertexTarget=b}(this),function(a){function b(){this._vertices=[]}GObject.mix(b,[GVertexSource,GVertexTarget]),b.prototype._index=0,b.prototype._vertices=null,b.prototype.addVertex=function(a,b,c){this._vertices.push({c:a,x:b,y:c}),this._index=this._vertices.length+1},b.prototype.clearVertices=function(){this._vertices=[]},b.prototype.transformVertices=function(a){for(var b=0;b<this._vertices.length;++b)a.map(this._vertices[b])},b.prototype.getCount=function(){return this._vertices.length},b.prototype.rewindVertices=function(a){return a>=0&&a<=this._vertices.length?(this._index=a,!0):!1},b.prototype.readVertex=function(a){if(this._index>=0&&this._index<this._vertices.length){var b=this._vertices[this._index];return a.command=b.c,a.x=b.x,a.y=b.y,this._index++,!0}return!1},b.prototype.toString=function(){return"[Object GVertexContainer]"},a.GVertexContainer=b}(this),function(a){function b(){}b.HitResult=function(){},b.HitResult.prototype.segment=null,b.HitResult.prototype.x=null,b.HitResult.prototype.y=null,b.HitResult.prototype.slope=null,b.HitResult.prototype.outline=null,b.prototype._hitTestSegment=function(a,b,c,d,e,f,g,h,i){var j=[],k=GMath.sqrSegmentDist(a,b,c,d,e,f,j,g);return g>=k?(i&&(i.segment=h,i.x=a+j[0]*(c-a),i.y=b+j[0]*(d-b),i.slope=j[0],i.outline=!0),!0):!1},b.prototype._hitTestCurve=function(a,b,c,d,e,f,g,h,i,j,k){var l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=[],E=new Float64Array(5),F=new Float64Array(4),G=[],H=1e-6,I=!1,J=!0;if(z=(a+c+e)/3,A=(b+d+f)/3,p=GMath.sqrSegmentDist(a,b,c,d,g,h,D,i),i>=p?I=!0:GMath.segmentSide(a,b,c,d,g,h)*GMath.segmentSide(a,b,c,d,z,A)<0&&(J=!1),I&&(0==D[0]||1==D[0]))return k&&(k.segment=j,k.outline=!0,k.slope=D[0],0==D[0]?(k.x=a,k.y=b):(k.x=c,k.y=d)),!0;if(q=GMath.sqrSegmentDist(a,b,e,f,g,h),i>=q?I=!0:GMath.segmentSide(a,b,e,f,g,h)*GMath.segmentSide(a,b,e,f,z,A)<0&&(J=!1),r=GMath.sqrSegmentDist(e,f,c,d,g,h),i>=r?I=!0:GMath.segmentSide(e,f,c,d,g,h)*GMath.segmentSide(e,f,c,d,z,A)<0&&(J=!1),!I&&!J)return!1;if(l=c-2*e+a,m=d-2*f+b,0==l&&0==m)return this._hitTestSegment(a,b,c,d,g,h,i,j,k);if(n=2*(e-a),o=2*(f-b),E[0]=l*l+m*m,E[1]=2*(l*n+m*o),E[2]=n*n+o*o+2*l*(a-g)+2*m*(b-h),E[3]=2*(n*(a-g)+o*(b-h)),E[4]=(a-g)*(a-g)+(b-h)*(b-h),B=2*E[0],s=3*E[1]/(2*B),t=E[2]/B,u=E[3]/(2*B),F[0]=1,F[1]=s,F[2]=t,F[3]=u,y=!1,v=GMath.getCubicRoots(F,0,1,G,y,H),0==v)return!1;for(w=i+1,x=v+1,C=0;v>C;++C)B=GMath.evalPoly(E,4,G[C]),w>B&&(w=B,x=C);return i>=w?(k&&(k.segment=j,k.x=(G[x]*l+n)*G[x]+a,k.y=(G[x]*m+o)*G[x]+b,k.outline=!0,k.slope=G[x]),!0):!1},b.prototype._hitTestCurve2=function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z=[],$=new Float64Array(7),_=new Float64Array(6),ab=new Float64Array(6),bb=new Float64Array(4),cb=new Float64Array(4),db=null,eb=null,fb=!1,gb=!0,hb=[];if(s=e-a,w=3*s,t=f-b,x=3*t,A=g-e-s,u=3*A,q=2*A,A=h-f-t,v=3*A,r=2*A,o=c-g-s-q,p=d-h-t-r,B=a-i,C=b-j,$[0]=o*o+p*p,$[1]=2*(o*u+p*v),$[2]=u*u+v*v+2*(o*w+p*x),$[3]=2*(o*B+u*w+p*C+v*x),$[4]=w*w+x*x+2*(u*B+v*C),$[5]=2*(w*B+x*C),$[6]=B*B+C*C,GMath.getCoeffPolyDeriv($,6,_),GMath.inversePolyUnaryInterval(_,5,ab),0==GMath.estimPositiveRootsDescartes(ab,5))return y=GMath.ptSqrDist(a,b,i,j),z=GMath.ptSqrDist(c,d,i,j),k>=y||k>=z?(m&&(m.segment=l,m.outline=!0,z>y?(m.x=a,m.y=b,m.slope=0):(m.x=c,m.y=d,m.slope=1)),!0):!1;n=GMath.getCubicCurveSplits(o,q,s,p,r,t,Z);for(var ib=0;n-1>ib;++ib){if(0==ib){if(D=Z[ib],F=GMath.evalCubic(o,u,w,a,D),G=GMath.evalCubic(p,v,x,b,D),J=GMath.ptSqrDist(F,G,i,j),k>=J)return m&&(m.segment=l,m.outline=!0,m.x=F,m.y=G,m.slope=D),!0}else D=E,F=H,G=I,J=K;if(E=Z[ib+1],H=GMath.evalCubic(o,u,w,a,E),I=GMath.evalCubic(p,v,x,b,E),K=GMath.ptSqrDist(H,I,i,j),k>=K)return m&&(m.segment=l,m.outline=!0,m.x=H,m.y=I,m.slope=E),!0;for(GMath.getCtrlPts(a,c,e,g,D,E,bb),GMath.getCtrlPts(b,d,f,h,D,E,cb),fb=!1,gb=!0,V=(bb[0]+bb[1]+bb[2]+bb[3])/4,W=(cb[0]+cb[1]+cb[2]+cb[3])/4,T=0;4>T;++T){if(U=3==T?0:T+1,GMath.sqrSegmentDist(bb[T],cb[T],bb[U],cb[U],i,j)<=k){fb=!0;break}GMath.segmentSide(bb[T],cb[T],bb[U],cb[U],i,j)*GMath.segmentSide(bb[T],cb[T],bb[U],cb[U],V,W)<0&&(gb=!1)}if((fb||gb)&&(L=GMath.evalPoly(_,5,D),GMath.isEqualEps(L,0)&&(D+=.005,L=GMath.evalPoly(_,5,D)),M=GMath.evalPoly(_,5,E),GMath.isEqualEps(M,0)&&(E-=.005,M=GMath.evalPoly(_,5,E)),GMath.inversePolyInterval(_,5,D,E,ab),N=GMath.estimPositiveRootsDescartes(ab,5),0!=N)){if(db||(db=new Float64Array(5),GMath.getCoeffPolyDeriv(_,5,db)),eb||(eb=new Float64Array(4),GMath.getCoeffPolyDeriv(db,4,eb)),1==N&&(P=GMath.locateByNewton(D,E,L,M,_,5,db,eb,.005),null==P&&(P=(D+E)/2),Q=GMath.evalCubic(o,u,w,a,P),R=GMath.evalCubic(p,v,x,b,P),S=GMath.ptSqrDist(Q,R,i,j),k>=S))return m&&(m.segment=l,m.outline=!0,m.x=Q,m.y=R,m.slope=P),!0;if(N>1){if(0==hb.length&&GMath.getSturmPRS(_,5,db,hb),X=[],Y=[L,M],O=GMath.countRootsNSturm(_,5,db,D,E,hb,X,Y),0==O)continue;if(1==O&&(P=GMath.locateByNewton(D,E,L,M,_,5,db,eb,.005,hb,X),null==P&&(P=(D+E)/2),Q=GMath.evalCubic(o,u,w,a,P),R=GMath.evalCubic(p,v,x,b,P),S=GMath.ptSqrDist(Q,R,i,j),k>=S))return m&&(m.segment=l,m.outline=!0,m.x=Q,m.y=R,m.slope=P),!0;if(O>1){var jb=[];GMath.locRootsSturm(_,5,db,D,E,hb,O,X,Y,jb);for(var kb=0;kb<jb.length;++kb)if(P=GMath.locateByNewton(jb[kb][0],jb[kb][1],jb[kb][2],jb[kb][3],_,5,db,eb,.005,hb),null==P&&(P=(jb[kb][0]+jb[kb][1])/2),Q=GMath.evalCubic(o,u,w,a,P),R=GMath.evalCubic(p,v,x,b,P),S=GMath.ptSqrDist(Q,R,i,j),k>=S)return m&&(m.segment=l,m.outline=!0,m.x=Q,m.y=R,m.slope=P),!0}}}}return!1},b.prototype._hitUnderSegment=function(a,b,c,d,e,f,g){var h,i,j;return h=GMath.segmentSide(0,0,a,b,e,f),i=GMath.segmentSide(a,b,c,d,e,f),j=GMath.segmentSide(c,d,0,0,e,f),h>0&&i>0&&j>0?2:0>h&&0>i&&0>j?-2:0==h?i>0&&j>0?1:0>i&&0>j?-1:0:0==j?h>0&&i>0?1:0>h&&0>i?-1:0:g&&0==i?h>0&&j>0?1:0>h&&0>j?-1:0:0},b.prototype._evalConicReg=function(a,b,c,d,e,f,g,h,i,j){var k,l,m,n,o=-GMath.segmentSide(a,b,c,d,e,f);return 0==o?this._hitUnderSegment(a,b,c,d,i,j):(k=this._hitUnderSegment(a,b,c,d,i,j,!0),l=g(i,j),0>l?k:0==l?o+k:(m=-h(e,f),n=-h(i,j),n>0&&0>m||0>n&&m>0?o+o+k:k))},b.prototype._hitUnderCurve=function(a,b,c,d,e,f,g,h){function i(g,h){var i=(a-e)*(d-f)+(e-c)*(b-f),j=g-e,k=h-f,l=j*(b-2*f+d)-k*(a-2*e+c);return l*l+(2*(j*(b-d)+k*(c-a))+i)*i}function j(g,h){var i,j,k,l=(a+e+c)/3,m=(b+f+d)/3;return k=GMath.segmentSide(c,d,a,b,g,h),0==k?0:(i=GMath.segmentSide(a,b,e,f,g,h),j=GMath.segmentSide(e,f,c,d,g,h),i!=GMath.segmentSide(a,b,e,f,l,m)||j!=GMath.segmentSide(e,f,c,d,l,m)||k!=GMath.segmentSide(c,d,a,b,l,m)?-1:1)}return this._evalConicReg(a,b,c,d,e,f,j,i,g,h)},b.prototype._hitUnderCurve2=function(a,b,c,d,e,f,g,h,i,j){function k(a,b){var c=Q[0]-3*Q[1]+3*Q[2]-Q[3],d=(Q[0]-Q[1]-Q[2]+Q[3])/2,e=(Q[0]+Q[1]-Q[2]-Q[3])/4,f=(Q[0]+3*Q[1]+3*Q[2]+Q[3])/8,g=R[0]-3*R[1]+3*R[2]-R[3],h=(R[0]-R[1]-R[2]+R[3])/2,i=(R[0]+R[1]-R[2]-R[3])/4,j=(R[0]+3*R[1]+3*R[2]+R[3])/8,k=c*i-e*g,l=c*h-d*g,m=d*i-e*h,n=c*j-f*g,o=d*j-f*h,p=e*j-f*i,q=c*c,r=d*d,s=g*g,t=h*h,u=k*k,v=n*n,w=l*m,x=l*o,y=l*k,z=3*x-k*n,A=3*u-l*(4*n+9*m),B=s*g,C=c*s,D=q*g,E=q*c,F=n*s-3*g*(2*l*i+k*h)+9*l*t,G=(2*n+3*m)*c*g+9*(2*l*d*h+d*e*s-q*h*i),H=n*q-3*(2*l*e+k*d)*c+9*l*r,I=v*g+6*z*h+3*A*i+9*y*j,J=v*c+6*z*d+3*A*e+9*y*f,K=n*(v-9*(k*o+2*l*p))+27*(x*o+u*p)-81*w*p,L=a*a,M=b*b;return(B*a-3*C*b+3*F)*L+(3*D*a-E*b+3*H)*M+3*((I-G*b)*a-J*b)+K}function l(a,b){var c,d,e,f=(Q[0]+Q[1]+Q[2]+Q[3])/4,g=(R[0]+R[1]+R[2]+R[3])/4;for(d=0;4>d;++d){if(e=3==d?0:d+1,c=GMath.segmentSide(Q[d],R[d],Q[e],R[e],a,b),3==d&&0==c)return 0;if(c*GMath.segmentSide(Q[d],R[d],Q[e],R[e],f,g)<0)return-1}return 1}var m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U=0,V=[];q=e-a,u=3*q,r=f-b,v=3*r,D=g-e-q,s=3*D,o=2*D,D=h-f-r,t=3*D,p=2*D,m=c-g-q-o,n=d-h-r-p,A=o*n-p*m,B=2*(q*n-r*m),C=q*p-r*o,GMath.getQuadraticRoots(A,B,C,V),0==V.length&&(w=new Float64Array(4),x=new Float64Array(4),y=new Float64Array(4),z=new Float64Array(4),w[0]=m,w[1]=s,w[2]=u,w[3]=a,x[0]=n,x[1]=t,x[2]=v,x[3]=b,GMath.shiftPoly(w,3,.5,y),GMath.shiftPoly(x,3,.5,z),E=-y[0],F=y[1]/3,G=-y[2]/3,H=-z[0],I=z[1]/3,J=-z[2]/3,K=E*J-G*H,L=E*I-F*H,M=F*J-G*I,D=12*L*M-3*K*K,D>0&&(N=Math.sqrt(D),O=(K-N)/(2*L),P=(K+N)/(2*L),O>-.5&&.5>O&&(V.push(O+.5),P>-.5&&.5>P&&(V.push(P+.5),V.push((O+P)/2+.5))),P>-.5&&.5>P&&V.push(P+.5))),V.push(0),V.push(1);var W=[],X=GUtil.uSortSegment(0,1,V,W);Q=new Float64Array(4),R=new Float64Array(4);for(var Y=0;X-1>Y;++Y)S=0==Y?W[Y]:T,T=W[Y+1],0==S&&1==T?(Q[0]=a,Q[1]=e,Q[2]=g,Q[3]=c,R[0]=b,R[1]=f,R[2]=h,R[3]=d):(GMath.getCtrlPts(a,c,e,g,S,T,Q),GMath.getCtrlPts(b,d,f,h,S,T,R)),U+=GMath.isEqualEps(Q[0],Q[1])&&GMath.isEqualEps(R[0],R[1])?this._evalConicReg(Q[0],R[0],Q[3],R[3],Q[2],R[2],l,k,i,j):this._evalConicReg(Q[0],R[0],Q[3],R[3],Q[1],R[1],l,k,i,j);return U},b.prototype.hitTest=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p=0,q=!1,r=new GVertex,s=d?d/2*(d/2):GMath.defaultEps,t=0,u=0;if(n=null,o=null,GMath.isEqualEps(a,0)&&GMath.isEqualEps(b,0)&&(u=1),c.rewindVertices(0)){for(;c.readVertex(r);)switch(r.command){case GVertex.Command.Move:h=r.x,i=r.y,n=h,o=i;break;case GVertex.Command.Line:if(++p,q=this._hitTestSegment(h,i,r.x,r.y,a,b,s,p,f))return q;e&&(t+=this._hitUnderSegment(h+u,i,r.x+u,r.y,a+u,b)),h=r.x,i=r.y;break;case GVertex.Command.Curve:if(++p,j=r.x,k=r.y,c.readVertex(r)){if(q=this._hitTestCurve(h,i,j,k,r.x,r.y,a,b,s,p,f))return q;e&&(t+=this._hitUnderCurve(h+u,i,j+u,k,r.x+u,r.y,a+u,b)),h=j,i=k}break;case GVertex.Command.Curve2:if(++p,j=r.x,k=r.y,c.readVertex(r)&&(l=r.x,m=r.y,c.readVertex(r))){if(q=this._hitTestCurve2(h,i,j,k,l,m,r.x,r.y,a,b,s,p,f))return q;e&&(t+=this._hitUnderCurve2(h+u,i,j+u,k,l+u,m,r.x+u,r.y,a+u,b)),h=j,i=k}break;case GVertex.Command.Close:if(n!=h||o!=i){if(++p,q=this._hitTestSegment(h,i,n,o,a,b,s,p,f))return q;e&&(t+=this._hitUnderSegment(h+u,i,n+u,o,a+u,b))}n=h,o=i;break;default:throw new Error("Unknown vertex command: "+r.command.toString())}e&&(null==g&&(2==t||-2==t)||2==t&&!g||-2==t&&g)&&(f&&(f.outline=!1),q=!0)}return q},b.prototype.calculateBounds=function(a,b){function c(a,b){(null==l||l>a)&&(l=a),(null==n||a>n)&&(n=a),(null==m||m>b)&&(m=b),(null==o||b>o)&&(o=b)}function d(a,b,d,e,f,g){var h=0,i=0,j=0,k=0;c(d,e),i=d-2*f+a,0!=i&&(h=(a-f)/i,h>0&&1>h&&(j=(a*d-f*f)/(d-2*f+a),k=GMath.getCurveAtT(b,e,g,h),c(j,k))),i=e-2*g+b,0!=i&&(h=(b-g)/i,h>0&&1>h&&(k=(b*e-g*g)/(e-2*g+b),j=GMath.getCurveAtT(a,d,f,h),c(j,k)))}function e(a,b,d,e,f,g,h,i){function j(j){var k=0,l=0;j>0&&1>j&&(k=GMath.getCubicCurveAtT(a,d,f,h,j),l=GMath.getCubicCurveAtT(b,e,g,i,j),c(k,l))}function k(a,b,c){var d=0,e=0;0==a?0!=b&&(l=-c/b,j(l)):(d=b*b-4*a*c,0==d?(l=-b/(2*a),j(l)):d>0&&(e=Math.sqrt(d),l=(-b+e)/(2*a),j(l),l=(-b-e)/(2*a),j(l)))}var l=0;c(d,e);var m=f-a,n=g-b,o=2*(h-f-m),p=2*(i-g-n),q=d-h-m-o,r=e-i-n-p;k(q,o,m),k(r,p,n)}if(a.rewindVertices(0)){for(var f,g,h,i,j,k,l=null,m=null,n=null,o=null,p=new GVertex;a.readVertex(p);)switch(p.command){case GVertex.Command.Move:case GVertex.Command.Line:c(p.x,p.y),f=p.x,g=p.y;break;case GVertex.Command.Curve:h=p.x,i=p.y,a.readVertex(p)&&(b?d(f,g,h,i,p.x,p.y):(c(h,i),c(p.x,p.y)),f=h,g=i);break;case GVertex.Command.Curve2:h=p.x,i=p.y,a.readVertex(p)&&(j=p.x,k=p.y,a.readVertex(p)&&(b?e(f,g,h,i,j,k,p.x,p.y):(c(h,i),c(j,k),c(p.x,p.y)),f=h,g=i));break;case GVertex.Command.Close:break;default:throw new Error("Unknown vertex command: "+p.command.toString())}if(null!=l&&null!=m)return new GRect(l,m,null!=n?n-l:0,null!=o?o-m:0)}return null},b.prototype.toString=function(){return"[Object GVertexInfo]"},a.GVertexInfo=b,a.ifVertexInfo=new b}(this),function(a){function b(a){this._source=a}GObject.inherit(b,GVertexSource),b.prototype._source=null,b.prototype.rewindVertices=function(a){return this._source.rewindVertices(a)},b.prototype.readVertex=function(a){return this._source.readVertex(a)?(a.command>=GVertex.Command.Move&&a.command<GVertex.Command.Close&&(a.x=Math.floor(a.x)+.5,a.y=Math.floor(a.y)+.5),!0):!1},b.prototype.toString=function(){return"[Object GVertexPixelAligner]"},a.GVertexPixelAligner=b}(this),function(a){function b(a,b){this._source=a,this._transform=b}GObject.inherit(b,GVertexSource),b.transformVertex=function(a,b){if(b)switch(a.command){case GVertex.Command.Move:case GVertex.Command.Line:case GVertex.Command.Curve:case GVertex.Command.Curve2:b.map(a);break;case GVertex.Command.Close:break;default:throw new Error("Unknown vertex command: "+a.command.toString())}},b.prototype._source=null,b.prototype._transform=null,b.prototype.getTransform=function(){return this._transform},b.prototype.setTransform=function(a){this._transform=a},b.prototype.rewindVertices=function(a){return this._source.rewindVertices(a)},b.prototype.readVertex=function(a){return this._source.readVertex(a)?(b.transformVertex(a,this._transform),!0):!1},b.prototype.toString=function(){return"[Object GVertexTransformer]"},a.GVertexTransformer=b}(this),function(a){function b(a,b,c,d,e){this._tolerance=e?e/3:.03,this._source=a,this._offset=b,this._makeInset=c,this._makeOutset=d,this._startVertex=null;for(var f=1,e=this._tolerance,g=0;1>e;++g)e*=10,f*=10;this._tolRange=f}GObject.inherit(b,GVertexSource),b.MAX_RECURS=100,b.PolySegment=function(a,b,c,d){if(this.point=a,null!=b&&(this.bulge=b,b)){if(!c||!d||0>d)return;this.center=c,this.radius=d}},b.PolySegment.prototype.point=null,b.PolySegment.prototype.bulge=null,b.PolySegment.prototype.center=null,b.PolySegment.prototype.radius=null,b.PolySegment.prototype.next=null,b.PolySegment.prototype.previous=null,b.PolyOffsetSegment=function(a,c,d,e,f,g){b.PolySegment.call(this,c,e,f,g),this.basepoint=a,d&&(this.point2=d)},GObject.inherit(b.PolyOffsetSegment,b.PolySegment),b.PolyOffsetSegment.prototype.basepoint=null,b.PolyOffsetSegment.prototype.point2=null,b.IntersectionType=function(){},b.IntersectionType.prototype.TIP=!1,b.IntersectionType.prototype.FIP=!1,b.IntersectionType.prototype.PFIP=!1,b.IntersectionResult=function(){this.intTypes=[new b.IntersectionType,new b.IntersectionType]},b.IntersectionResult.prototype.point=null,b.IntersectionResult.prototype.intTypes=null,b.IntersectionResult.prototype.clear=function(){this.point=null,this.intTypes[0].TIP=!1,this.intTypes[0].FIP=!1,this.intTypes[0].PFIP=!1,this.intTypes[1].TIP=!1,this.intTypes[1].FIP=!1,this.intTypes[1].PFIP=!1},b.PolySegmentContainer=function(){this.count=0},b.PolySegmentContainer.prototype.head=null,b.PolySegmentContainer.prototype.end=null,b.PolySegmentContainer.prototype.closed=null,b.PolySegmentContainer.prototype.count=0,b.PolySegmentContainer.prototype.insertSegment=function(a,b){a.next=null,a.previous=null,this.head?b?(this.head==b?this.head=a:(a.previous=b.previous,b.previous.next=a),a.next=b,b.previous=a):(this.end.next=a,a.previous=this.end,this.end=a):(this.head=a,this.end=a),++this.count},b.PolySegmentContainer.prototype.deleteSegment=function(a){a.previous&&(a.previous.next=a.next),a.next&&(a.next.previous=a.previous),this.head==a&&(this.head=a.next),this.end==a&&(this.end=a.previous),--this.count},b.IntersectionPt=function(a,b,c,d,e){this.x=a,this.y=b,this.slope=c,this.segm=d,this.segmIdx=e
},b.IntersectionPt.prototype.x=null,b.IntersectionPt.prototype.y=null,b.IntersectionPt.prototype.slope=null,b.IntersectionPt.prototype.segm=null,b.IntersectionPt.prototype.segmIdx=null,b.prototype._source=null,b.prototype._offset=null,b.prototype._makeInset=!1,b.prototype._makeOutset=!1,b.prototype._tolerance=null,b.prototype._tolRange=1,b.prototype._polyline=null,b.prototype._polyinset=null,b.prototype._polyoutset=null,b.prototype._pieces=null,b.prototype._pieceIdx=0,b.prototype._startVertex=null,b.prototype.rewindVertices=function(a){return 0!=a?!1:(this._pieces=null,this._pieceIdx=0,this._startVertex=null,this._source.rewindVertices(0))},b.prototype.readVertex=function(a){return this._pieces&&this._pieces.length&&this._readVertex(a)?!0:(this._polyline=new b.PolySegmentContainer,this._polyoutset=[],this._polyinset=[],this._pieces=[],this._pieceIdx=0,this._startVertex=this.generatePolyLine(this._tolerance,this._startVertex),this._polyline.count&&(this.generatePolyOffset(Math.abs(this._offset),this._makeInset,this._makeOutset,this._tolerance),this.generateOffset(this._makeInset,this._makeOutset,this._tolerance),this._pieces.length&&(this._rewindVertices(),this._pieceIdx=0),this._pieces&&this._pieces.length&&this._readVertex(a))?!0:!1)},b.prototype.addCurveToPolyline=function(a,c,d,e,f){if(++f,this._isQudraticCurveFlat(a,c,d,e)){var g=new b.PolySegment(a,0);return void this._polyline.insertSegment(g)}var h=GMath.ptDist(a.getX(),a.getY(),c.getX(),c.getY()),i=GMath.ptDist(c.getX(),c.getY(),d.getX(),d.getY()),j=GMath.ptDist(a.getX(),a.getY(),d.getX(),d.getY()),k=new GPoint((c.getX()-a.getX())/h,(c.getY()-a.getY())/h),l=new GPoint((d.getX()-c.getX())/i,(d.getY()-c.getY())/i),m=new GPoint((d.getX()-a.getX())/j,(d.getY()-a.getY())/j),n=GMath.vDotProduct(k.getX(),k.getY(),l.getX(),l.getY()),o=new GPoint(h*(l.getX()-k.getX()*n),h*(l.getY()-k.getY()*n)),p=h*n-i,q=i*n-h,r=new GPoint(o.getX()+p*k.getX()+q*l.getX(),o.getY()+p*k.getY()+q*l.getY());p=Math.sqrt(GMath.vDotProduct(o.getX(),o.getY(),o.getX(),o.getY())),q=Math.sqrt(GMath.vDotProduct(r.getX(),r.getY(),r.getX(),r.getY()));var s=new GPoint(o.getX()/p,o.getY()/p),t=new GPoint(r.getX()/q,r.getY()/q),u=1-n,v=GMath.vDotProduct(l.getX(),l.getY(),s.getX(),s.getY()),w=GMath.vDotProduct(m.getX(),m.getY(),k.getX(),k.getY()),x=GMath.vDotProduct(m.getX(),m.getY(),s.getX(),s.getY()),y=GMath.vDotProduct(k.getX(),k.getY(),t.getX(),t.getY()),z=GMath.vDotProduct(m.getX(),m.getY(),l.getX(),l.getY()),A=GMath.vDotProduct(m.getX(),m.getY(),t.getX(),t.getY()),B=v*w/x+y*z/A,C=-(v*y)/(x*A*2),D=[];GMath.getQuadraticRoots(u,B,C,D);var E=null;null!=D[0]&&D[0]<1&&D[0]>0?E=D[0]:null!=D[1]&&D[1]<1&&D[1]>0&&(E=D[1]);var F=E*j*A/y,G=E*j*x/v,H=Math.sqrt((1-w)/2),I=Math.sqrt((1+w)/2),J=F*I/H,K=Math.sqrt((1-z)/2),L=Math.sqrt((1+z)/2),M=G*L/K,N=new GPoint(a.getX()+J*s.getX(),a.getY()+J*s.getY()),O=new GPoint(d.getX()+M*t.getX(),d.getY()+M*t.getY());p=2*h*w,D=[],GMath.getQuadraticRoots(j-p,p,-F*(1+w),D);var P=.5;null!=D[0]&&D[0]<1&&D[0]>0?P=D[0]:null!=D[1]&&D[1]<1&&D[1]>0&&(P=D[1]);var Q=Math.sqrt(1-w*w),R=Math.abs((2*h*P*(1-P)-F)*Q),S=h*h,T=i*i,U=h*i*n;p=S+T-U;var V=Math.sqrt(1-n*n),W=R,X=P;if(D=[],GMath.getQuadraticRoots(p,3*(U-S),2*S-J*i*V,D),null!=D[0]&&D[0]<P&&D[0]>0){var Y=new GPoint(GMath.getCurveAtT(a.getX(),d.getX(),c.getX(),D[0]),GMath.getCurveAtT(a.getY(),d.getY(),c.getY(),D[0])),Z=Math.abs(J-GMath.ptDist(Y.getX(),Y.getY(),N.getX(),N.getY()));Z>W&&(W=Z,X=D[0])}if(null!=D[1]&&D[1]<P&&D[1]>0){var $=new GPoint(GMath.getCurveAtT(a.getX(),d.getX(),c.getX(),D[1]),GMath.getCurveAtT(a.getY(),d.getY(),c.getY(),D[1])),_=Math.abs(J-GMath.ptDist($.getX(),$.getY(),N.getX(),N.getY()));_>W&&(W=_,X=D[1])}if(D=[],GMath.getQuadraticRoots(p,-2*S+T+U,S+U-M*h*V,D),null!=D[0]&&D[0]<1&&D[0]>P){var ab=new GPoint(GMath.getCurveAtT(a.getX(),d.getX(),c.getX(),D[0]),GMath.getCurveAtT(a.getY(),d.getY(),c.getY(),D[0])),bb=Math.abs(M-GMath.ptDist(ab.getX(),ab.getY(),O.getX(),O.getY()));bb>W&&(W=bb,X=D[0])}if(null!=D[1]&&D[1]<1&&D[1]>P){var cb=new GPoint(GMath.getCurveAtT(a.getX(),d.getX(),c.getX(),D[1]),GMath.getCurveAtT(a.getY(),d.getY(),c.getY(),D[1])),db=Math.abs(M-GMath.ptDist(cb.getX(),cb.getY(),O.getX(),O.getY()));db>W&&(W=db,X=D[1])}if(W>e&&f<b.MAX_RECURS){var eb=new Float64Array(3),fb=new Float64Array(3),gb=new Float64Array(3),hb=new Float64Array(3);GMath.divideQuadraticCurve(a.getX(),c.getX(),d.getX(),X,eb,gb),GMath.divideQuadraticCurve(a.getY(),c.getY(),d.getY(),X,fb,hb),this.addCurveToPolyline(a,new GPoint(eb[1],fb[1]),new GPoint(eb[2],fb[2]),e,f),this.addCurveToPolyline(new GPoint(gb[0],hb[0]),new GPoint(gb[1],hb[1]),d,e,f)}else{var ib=new GPoint(a.getX()+F*(k.getX()+m.getX()),a.getY()+F*(k.getY()+m.getY())),jb=H/(I+1);GMath.segmentSide(a.getX(),a.getY(),ib.getX(),ib.getY(),N.getX(),N.getY())>0&&(jb=-jb);var g=new b.PolySegment(a,jb,N,J);this._polyline.insertSegment(g);var kb=K/(L+1);0>jb&&(kb=-kb),g=new b.PolySegment(ib,kb,O,M),this._polyline.insertSegment(g)}},b.prototype.addCubicCurveToPolyline=function(a,b,c,d,e){for(var f,g,h=b.getX()-a.getX(),i=b.getY()-a.getY(),j=2*(c.getX()-b.getX()-h),k=2*(c.getY()-b.getY()-i),l=d.getX()-c.getX()-h-j,m=d.getY()-c.getY()-i-k,n=[],o=GMath.getCubicCurveSplits(l,j,h,m,k,i,n),p=new Float64Array(4),q=new Float64Array(4),r=0;o-1>r;++r){f=n[r],g=n[r+1],GMath.getCtrlPts(a.getX(),d.getX(),b.getX(),c.getX(),f,g,p),GMath.getCtrlPts(a.getY(),d.getY(),b.getY(),c.getY(),f,g,q);var s=0;this._addCubicSegmToPolyline(p,q,e,s)}},b.prototype._isQudraticCurveFlat=function(a,b,c,d){var e=GMath.getCurveAtT(a.getX(),c.getX(),b.getX(),.5),f=GMath.getCurveAtT(a.getY(),c.getY(),b.getY(),.5),g=GMath.ptSqrDist(e,f,(a.getX()+c.getX())/2,(a.getY()+c.getY())/2);return d*d>=g},b.prototype._isCubicCurveFlat=function(a,b,c){var d=3*a[1]-2*a[0]-a[3];d*=d;var e=3*b[1]-2*b[0]-b[3];e*=e;var f=3*a[2]-2*a[3]-a[0];f*=f;var g=3*b[2]-2*b[3]-b[0];return g*=g,f>d&&(d=f),g>e&&(e=g),16*c*c>=d+e},b.prototype._addCubicSegmToPolyline=function(a,c,d,e){++e;var f=a[0],g=c[0],h=a[3],i=c[3];if(this._isCubicCurveFlat(a,c,d)){var j=new b.PolySegment(new GPoint(f,g),0);return void this._polyline.insertSegment(j)}var k,l=!GMath.isEqualEps(f,a[1])||!GMath.isEqualEps(g,c[1]),m=!GMath.isEqualEps(h,a[2])||!GMath.isEqualEps(i,c[2]);if(l&&m){var n=[];k=GMath.getIntersectionPoint(f,g,a[1],c[1],a[2],c[2],h,i,n)}else if(l)k=new GPoint(a[1],c[1]);else{if(!m)return void this._polyline.insertSegment(new b.PolySegment(new GPoint(f,g),0));k=new GPoint(a[2],c[2])}var o=GMath.ptDist(f,g,h,i),p=GMath.ptDist(f,g,k.getX(),k.getY()),q=GMath.ptDist(h,i,k.getX(),k.getY()),r=o+p+q,s=(f*q+h*p+k.getX()*o)/r,t=(g*q+i*p+k.getY()*o)/r;if(GMath.isEqualEps(f,s)||GMath.isEqualEps(g,t)||GMath.isEqualEps(h,s)||GMath.isEqualEps(i,t)){var j=new b.PolySegment(new GPoint(f,g),0);this._polyline.insertSegment(j)}else{var u=(g-t)/(f-s),v=(i-t)/(h-s),w=(u*v*(g-i)+v*(f+s)-u*(s+h))/2/(v-u),x=-1/u*(w-(f+s)/2)+(g+t)/2,y=GMath.ptDist(f,g,w,x),z=a[1]-f,A=3*z,B=c[1]-g,C=3*B,D=a[2]-a[1]-z,E=3*D,F=2*D;D=c[2]-c[1]-B;var G=3*D,H=2*D,I=h-a[2]-z-F,J=i-c[2]-B-H,K=f-w,L=g-x,M=new Float64Array(7);M[0]=I*I+J*J,M[1]=2*(I*E+J*G),M[2]=E*E+G*G+2*(I*A+J*C),M[3]=2*(I*K+E*A+J*L+G*C),M[4]=A*A+C*C+2*(E*K+G*L),M[5]=2*(A*K+C*L),M[6]=K*K+L*L;var N=new Float64Array(6);GMath.getCoeffPolyDeriv(M,6,N);var O=new Float64Array(5);GMath.getCoeffPolyDeriv(N,5,O);var P=new Float64Array(4);GMath.getCoeffPolyDeriv(O,4,P);var Q=new Float64Array(6);GMath.inversePolyUnaryInterval(N,5,Q);var R,S,T,U,V=GMath.estimPositiveRootsDescartes(Q,5),W=0,X=[];if(V>0){var Y=0,Z=1;R=GMath.evalPoly(N,5,Y),GMath.isEqualEps(R,0)&&(Y+=.005,R=GMath.evalPoly(N,5,Y)),S=GMath.evalPoly(N,5,Z),GMath.isEqualEps(S,0)&&(Z-=.005,S=GMath.evalPoly(N,5,Z)),V>1&&(GMath.getSturmPRS(N,5,O,X),T=[],U=[R,S],V=GMath.countRootsNSturm(N,5,O,Y,Z,X,T,U))}if(0==V);else if(1==V){var $=GMath.locateByNewton(Y,Z,R,S,N,5,O,P,.005);null==$&&($=(Y+Z)/2);var _=GMath.evalCubic(I,E,A,f,$),ab=GMath.evalCubic(J,G,C,g,$);W=Math.abs(GMath.ptDist(_,ab,w,x)-y)}else{var bb=[];GMath.locRootsSturm(N,5,O,Y,Z,X,V,T,U,bb);for(var cb=0;cb<bb.length;++cb){$=GMath.locateByNewton(bb[cb][0],bb[cb][1],bb[cb][2],bb[cb][3],N,5,O,P,.005,X),null==$&&($=(bb[cb][0]+bb[cb][1])/2),_=GMath.evalCubic(I,E,A,f,$),ab=GMath.evalCubic(J,G,C,g,$);var db=Math.abs(GMath.ptDist(_,ab,w,x)-y);db>W&&(W=db)}}if(W>d&&e<b.MAX_RECURS){var eb=new Float64Array(4),fb=new Float64Array(4),gb=new Float64Array(4),hb=new Float64Array(4);GMath.getCtrlPtsCasteljau(a[0],a[1],a[2],a[3],.5,null,eb,gb),GMath.getCtrlPtsCasteljau(c[0],c[1],c[2],c[3],.5,null,fb,hb),this._addCubicSegmToPolyline(eb,fb,d,e),this._addCubicSegmToPolyline(gb,hb,d,e)}else{var ib=o/2/y,jb=ib/(Math.sqrt(1-ib*ib)+1);GMath.segmentSide(f,g,h,i,w,x)>0&&(jb=-jb);var kb=new b.PolySegment(new GPoint(f,g),jb,new GPoint(w,x),y);this._polyline.insertSegment(kb)}}},b.prototype.generatePolyLine=function(a,c){for(var d,e=null,f=c,g=f,h=new GVertex,i=!0;i&&this._source.readVertex(h);)switch(h.command){case GVertex.Command.Move:f&&this._polyline.count?(e=h,i=!1):(g=h,f=g,h=new GVertex);break;case GVertex.Command.Line:g?(d=new b.PolySegment(new GPoint(g.x,g.y),0),this._polyline.insertSegment(d),g=h,h=new GVertex):(g=h,h=new GVertex);break;case GVertex.Command.Curve:if(g){var j=new GPoint(g.x,g.y);if(g=h,h=new GVertex,this._source.readVertex(h)){var k=0;this.addCurveToPolyline(j,new GPoint(h.x,h.y),new GPoint(g.x,g.y),a,k),h=new GVertex}}else g=h,h=new GVertex;break;case GVertex.Command.Curve2:if(g){var j=new GPoint(g.x,g.y),l=new GPoint(h.x,h.y);g=h,h=new GVertex;var m=new GVertex;this._source.readVertex(h)&&this._source.readVertex(m)&&(this.addCubicCurveToPolyline(j,new GPoint(h.x,h.y),new GPoint(m.x,m.y),l,a),h=new GVertex)}else g=h,h=new GVertex;break;case GVertex.Command.Close:this._polyline&&(g&&(d=new b.PolySegment(new GPoint(g.x,g.y),0),this._polyline.insertSegment(d),g=null),this._polyline.closed=!0,d=new b.PolySegment(this._polyline.head.point,0),this._polyline.insertSegment(d),e=new GVertex,e.command=GVertex.Command.Move,e.x=this._polyline.head.point.getX(),e.y=this._polyline.head.point.getY(),i=!1);break;default:throw new Error("Unknown vertex command: "+vertex.command.toString())}return g&&this._polyline.count&&(d=new b.PolySegment(new GPoint(g.x,g.y),0),this._polyline.insertSegment(d),GMath.isEqualEps(g.x,this._polyline.head.point.getX())&&GMath.isEqualEps(g.y,this._polyline.head.point.getY())&&(this._polyline.closed=!0)),e},b.prototype.generatePolyOffset=function(a,c,d,e){var f=null,g=null;d&&(f=new b.PolySegmentContainer),c&&(g=new b.PolySegmentContainer);for(var h,i=0,j=this._polyline.head;i<this._polyline.count;++i)d&&(h=this._offsetPolySegment(j,-a,e),h&&f.insertSegment(h)),c&&(h=this._offsetPolySegment(j,a,e),h&&g.insertSegment(h)),j=j.next;var k=new b.PolySegmentContainer,l=new b.PolySegmentContainer;d&&this._trimOffsetPoly(f,-a,k),c&&this._trimOffsetPoly(g,a,l);var m=[],n=[];c&&d&&this._calcIntersectionPoints(k,l,m,n),d&&this._calcSelfIntersectionPoints(k,m),c&&this._calcSelfIntersectionPoints(l,n),m.length>0&&this._sortInsertsectionPoints(m),n.length>0&&this._sortInsertsectionPoints(n);var o=[],p=[],q=[],r=[];if(d)if(m.length>0){q=this._splitForClipping(k,m);for(var i=0;i<q.length;++i){var s=[],t=[];if(this._calcIntersectionPoints(q[i],this._polyline,s,t),0==s.length)o.push(q[i]);else if(!this._polyline.closed){for(var u=!1,v=0;v<t.length;++v)if(0==t[v].segmIdx||t[v].segmIdx==this._polyline.count-1){u=!0;break}u&&this._excludeCircleInside(q[i],s,t,a,o)}}}else o[0]=k;if(c)if(n.length>0){r=this._splitForClipping(l,n);for(var i=0;i<r.length;++i){var s=[],t=[];if(this._calcIntersectionPoints(r[i],this._polyline,s,t),0==s.length)p.push(r[i]);else if(!this._polyline.closed){for(var u=!1,v=0;v<t.count;++v)if(0==t[v].segmIdx||t[v].segmIdx==this._polyline.count-1){u=!0;break}u&&this._excludeCircleInside(r[i],s,t,a,p)}}}else p[0]=l;c&&d||this._polyline.closed?(this._gcppFilter(o,this._polyline,a,3*e,this._polyoutset),this._gcppFilter(p,this._polyline,a,3*e,this._polyinset)):(this._gcppClipping(o,this._polyline,a,this._polyoutset),this._gcppClipping(p,this._polyline,a,this._polyinset))},b.prototype.generateOffset=function(a,b,c){var d=[];b&&a&&!this._polyline.closed?(this._genCurves(this._polyoutset,d,c),this._genCurves(this._polyinset,d,c)):(b&&this._genCurves(this._polyoutset,d,c),a&&this._genCurves(this._polyinset,d,c)),this._pieces=this._mergePieces(d)},b.prototype._mergePieces=function(a){for(var b=[];a.length>0;){var c=a[0];a.splice(0,1);for(var d=c.stPt.getX()!=c.endPt.getX()||c.stPt.getY()!=c.endPt.getY();d;){d=!1;for(var e=null,f=a.length-1;f>=0;--f)e=a[f],e.stPt.getX()==c.endPt.getX()&&e.stPt.getY()==c.endPt.getY()?(c.endPt=e.endPt,c.vrt.push.apply(c.vrt,e.vrt),d=!0,a.splice(f,1)):c.stPt.getX()==e.endPt.getX()&&c.stPt.getY()==e.endPt.getY()&&(e.endPt=c.endPt,e.vrt.push.apply(e.vrt,c.vrt),c=e,d=!0,a.splice(f,1))}var g=new GVertexContainer;g.addVertex(GVertex.Command.Move,c.stPt.getX(),c.stPt.getY());for(var f=0;f<c.vrt.length;++f){var h=c.vrt[f];g.addVertex(h.c,h.x,h.y)}b.push(g)}return b},b.prototype._offsetPolySegment=function(a,c,d){var e=null,f=Math.abs(c),g=a.point.getX(),h=a.point.getY();if(a.bulge){if(a.radius){var i=a.radius,j=null;if(c*a.bulge>0?(i+=f,j=i/a.radius):GMath.isEqualEps(a.radius,f,d)||(a.radius>f?(i-=f,j=i/a.radius):(i=f-a.radius,j=f/a.radius)),null!=j){var k,l,m=a.center.getX(),n=a.center.getY();a.next?(k=a.next.point.getX(),l=a.next.point.getY()):(k=this._polyline.head.point.getX(),l=this._polyline.head.point.getY());var o=new GPoint(m+j*(g-m),n+j*(h-n)),p=new GPoint(m+j*(k-m),n+j*(l-n));e=new b.PolyOffsetSegment(a.point,o,p,a.bulge,a.center,i)}}}else if(a.next||this._polyline.closed){var k,l;a.next?(k=a.next.point.getX(),l=a.next.point.getY()):(k=this._polyline.head.point.getX(),l=this._polyline.head.point.getY());var q=GMath.ptDist(g,h,k,l);if(!GMath.isEqualEps(q,0)){var r=new GPoint(-c*(l-h)/q,-c*(g-k)/q),o=new GPoint(g+r.getX(),h+r.getY()),p=new GPoint(k+r.getX(),l+r.getY());e=new b.PolyOffsetSegment(a.point,o,p,0)}}return e},b.prototype._insersectOffsetSegments=function(a,b,c){if(0==a.bulge&&0==b.bulge){var d=[null,null],e=GMath.getIntersectionPoint(a.point.getX(),a.point.getY(),a.point2.getX(),a.point2.getY(),b.point.getX(),b.point.getY(),b.point2.getX(),b.point2.getY(),d);c.point=e,e&&(this._fillLineIntType(d[0],c.intTypes[0]),this._fillLineIntType(d[1],c.intTypes[1]))}else if(0!=a.bulge&&0==b.bulge||0==a.bulge&&0!=b.bulge){var d=[null,null],f=null,g=null,h=null;if(0==a.bulge){var i=a.point.getX(),j=a.point.getY(),k=a.point2.getX()-a.point.getX(),l=a.point2.getY()-a.point.getY();if(GMath.circleLineIntersection(i,j,k,l,b.center.getX(),b.center.getY(),b.radius,d),null!=d[0]&&(f=i+k*d[0],g=j+l*d[0],h=d[0]),null!=d[0]&&null!=d[1]){var m=i+k*d[1],n=j+l*d[1],o=GMath.ptSqrDist(f,g,b.basepoint.getX(),b.basepoint.getY()),p=GMath.ptSqrDist(m,n,b.basepoint.getX(),b.basepoint.getY());o>p&&(f=m,g=n,h=d[1])}null!=h&&(c.point=new GPoint(f,g),this._fillLineIntType(h,c.intTypes[0]),this._fillArcIntType(b,f,g,c.intTypes[1]))}else{var i=b.point.getX(),j=b.point.getY(),k=b.point2.getX()-b.point.getX(),l=b.point2.getY()-b.point.getY();if(GMath.circleLineIntersection(i,j,k,l,a.center.getX(),a.center.getY(),a.radius,d),null!=d[0]&&(f=i+k*d[0],g=j+l*d[0],h=d[0]),null!=d[0]&&null!=d[1]){var m=i+k*d[1],n=j+l*d[1],o=GMath.ptSqrDist(f,g,b.basepoint.getX(),b.basepoint.getY()),p=GMath.ptSqrDist(m,n,b.basepoint.getX(),b.basepoint.getY());o>p&&(f=m,g=n,h=d[1])}null!=h&&(c.point=new GPoint(f,g),this._fillLineIntType(h,c.intTypes[1]),this._fillArcIntType(a,f,g,c.intTypes[0]))}}else{var d=[null,null];GMath.circleCircleIntersection(a.center.getX(),a.center.getY(),a.radius,b.center.getX(),b.center.getY(),b.radius,d);var q=null;if(null!=d[0]&&(q=0),null!=d[0]&&null!=d[1]){var o=GMath.ptSqrDist(d[0].getX(),d[0].getY(),b.basepoint.getX(),b.basepoint.getY()),p=GMath.ptSqrDist(d[1].getX(),d[1].getY(),b.basepoint.getX(),b.basepoint.getY());o>p&&(q=1)}null!==q&&(c.point=d[q],this._fillArcIntType(a,d[q].getX(),d[q].getY(),c.intTypes[0]),this._fillArcIntType(b,d[q].getX(),d[q].getY(),c.intTypes[1]))}},b.prototype._fillArcIntType=function(a,b,c,d){var e=a.point.getX(),f=a.point.getY(),g=a.point2.getX(),h=a.point2.getY(),i=a.center.getX(),j=a.center.getY();if(GMath.segmentSide(e,f,g,h,b,c)==GMath.segmentSide(e,f,g,h,i,j)){var k=(e+g)/2,l=(f+h)/2,m=a.radius/GMath.ptDist(k,l,i,j),n=i+(i-k)*m,o=j+(j-l)*m;GMath.segmentSide(e,f,n,o,b,c)==GMath.segmentSide(e,f,n,o,i,j)?(d.FIP=!0,d.PFIP=!0):d.FIP=!0}else d.TIP=!0},b.prototype._fillLineIntType=function(a,b){0>a?b.FIP=!0:a>1?(b.FIP=!0,b.PFIP=!0):b.TIP=!0},b.prototype._trimOffsetPoly=function(a,c,d){var e=1e-6,f=null,g=a.head;if(g){d.insertSegment(new b.PolySegment(g.point,g.bulge,g.center,g.radius));for(var h=new b.IntersectionResult,i=0;i<a.count-1;++i)if(f=new b.PolyOffsetSegment(g.basepoint,d.end.point,g.point2,d.end.bulge,g.center,g.radius),g=g.next,GMath.isEqualEps(f.point2.getX(),g.point.getX(),e)&&GMath.isEqualEps(f.point2.getY(),g.point.getY(),e))d.insertSegment(new b.PolySegment(g.point,g.bulge,g.center,g.radius));else if(h.clear(),this._insersectOffsetSegments(f,g,h),0==f.bulge&&0==g.bulge)h.point?h.intTypes[0].TIP&&h.intTypes[1].TIP||h.intTypes[0].FIP&&h.intTypes[1].FIP&&h.intTypes[0].PFIP?d.insertSegment(new b.PolySegment(h.point,0)):(d.insertSegment(new b.PolySegment(f.point2,0)),d.insertSegment(new b.PolySegment(g.point,0))):d.insertSegment(new b.PolySegment(f.point2,0));else if(0==f.bulge&&0!=g.bulge)if(h.point)if(h.intTypes[0].TIP&&h.intTypes[1].TIP||h.intTypes[0].TIP&&h.intTypes[1].FIP&&!h.intTypes[1].PFIP||h.intTypes[0].PFIP&&h.intTypes[1].TIP){var j=((h.point.getX()+g.point2.getX())/2,(h.point.getY()+g.point2.getY())/2,this._calculateBulge(h.point.getX(),h.point.getY(),g.point2.getX(),g.point2.getY(),g.center.getX(),g.center.getY(),g.bulge));d.insertSegment(new b.PolySegment(h.point,j,g.center,g.radius))}else if(h.intTypes[0].PFIP&&h.intTypes[1].FIP){var k=this._constructJoinArc(f,g,!0);d.insertSegment(k),d.insertSegment(new b.PolySegment(g.point,g.bulge,g.center,g.radius))}else d.insertSegment(new b.PolySegment(f.point2,0)),d.insertSegment(new b.PolySegment(g.point,g.bulge,g.center,g.radius));else{var k=this._constructJoinArc(f,g,!0);d.insertSegment(k),d.insertSegment(new b.PolySegment(g.point,g.bulge,g.center,g.radius))}else if(0!=f.bulge&&0==g.bulge)if(h.point)if(h.intTypes[0].TIP&&h.intTypes[1].TIP){var l=this._calculateBulge(f.point.getX(),f.point.getY(),h.point.getX(),h.point.getY(),f.center.getX(),f.center.getY(),f.bulge);d.end.bulge=l,d.insertSegment(new b.PolySegment(h.point,0))}else if(h.intTypes[0].FIP&&h.intTypes[1].FIP&&!h.intTypes[1].PFIP){var k=this._constructJoinArc(f,g,!0);d.insertSegment(k),d.insertSegment(new b.PolySegment(g.point,0))}else d.insertSegment(new b.PolySegment(f.point2,0)),d.insertSegment(new b.PolySegment(g.point,0));else{var k=this._constructJoinArc(f,g,!0);d.insertSegment(k),d.insertSegment(new b.PolySegment(g.point,0))}else if(h.point)if(h.intTypes[0].FIP&&!h.intTypes[0].PFIP||h.intTypes[1].PFIP){var k=this._constructJoinArc(f,g,!1);d.insertSegment(k),d.insertSegment(new b.PolySegment(g.point,g.bulge,g.center,g.radius))}else{var l=this._calculateBulge(f.point.getX(),f.point.getY(),h.point.getX(),h.point.getY(),f.center.getX(),f.center.getY(),f.bulge);d.end.bulge=l,l=this._calculateBulge(h.point.getX(),h.point.getY(),g.point2.getX(),g.point2.getY(),g.center.getX(),g.center.getY(),g.bulge),d.insertSegment(new b.PolySegment(h.point,l,g.center,g.radius))}else{var k=this._constructJoinArc(f,g,!0);d.insertSegment(k),d.insertSegment(new b.PolySegment(g.point,g.bulge,g.center,g.radius))}if(this._polyline.closed)if(f=new b.PolyOffsetSegment(g.basepoint,d.end.point,g.point2,d.end.bulge,g.center,g.radius),g=a.head,GMath.isEqualEps(f.point2.getX(),g.point.getX(),e)&&GMath.isEqualEps(f.point2.getY(),g.point.getY(),e))d.insertSegment(new b.PolySegment(g.point,0));else if(h.clear(),this._insersectOffsetSegments(f,g,h),0==f.bulge&&0==g.bulge)h.point?h.intTypes[0].TIP&&h.intTypes[1].TIP||h.intTypes[0].FIP&&h.intTypes[1].FIP&&h.intTypes[0].PFIP?(d.insertSegment(new b.PolySegment(h.point,0)),d.head.point=h.point):(d.insertSegment(new b.PolySegment(f.point2,0)),d.insertSegment(new b.PolySegment(g.point,0))):d.insertSegment(new b.PolySegment(f.point2,0));else if(0==f.bulge&&0!=g.bulge)if(h.point)if(h.intTypes[0].TIP&&h.intTypes[1].TIP||h.intTypes[0].TIP&&h.intTypes[1].FIP&&!h.intTypes[1].PFIP||h.intTypes[0].PFIP&&h.intTypes[1].TIP){var j=this._calculateBulge(h.point.getX(),h.point.getY(),g.point2.getX(),g.point2.getY(),g.center.getX(),g.center.getY(),g.bulge);d.insertSegment(new b.PolySegment(h.point,0)),d.head.point=h.point,d.head.bulge=j}else if(h.intTypes[0].PFIP&&h.intTypes[1].FIP){var k=this._constructJoinArc(f,g,!0);d.insertSegment(k),d.insertSegment(new b.PolySegment(g.point,0))}else d.insertSegment(new b.PolySegment(f.point2,0)),d.insertSegment(new b.PolySegment(g.point,0));else{var k=this._constructJoinArc(f,g,!0);d.insertSegment(k),d.insertSegment(new b.PolySegment(g.point,0))}else if(0!=f.bulge&&0==g.bulge)if(h.point)if(h.intTypes[0].TIP&&h.intTypes[1].TIP){var l=this._calculateBulge(f.point.getX(),f.point.getY(),h.point.getX(),h.point.getY(),f.center.getX(),f.center.getY(),f.bulge);d.end.bulge=l,d.insertSegment(new b.PolySegment(h.point,0)),d.head.point=h.point}else if(h.intTypes[0].FIP&&h.intTypes[1].FIP&&!h.intTypes[1].PFIP){var k=this._constructJoinArc(f,g,!0);d.insertSegment(k),d.insertSegment(new b.PolySegment(g.point,0))}else d.insertSegment(new b.PolySegment(f.point2,0)),d.insertSegment(new b.PolySegment(g.point,0));else{var k=this._constructJoinArc(f,g,!0);d.insertSegment(k),d.insertSegment(new b.PolySegment(g.point,0))}else if(h.point)if(h.intTypes[0].FIP&&!h.intTypes[0].PFIP||h.intTypes[1].PFIP){var k=this._constructJoinArc(f,g,!1);d.insertSegment(k),d.insertSegment(new b.PolySegment(g.point,0))}else{var l=this._calculateBulge(f.point.getX(),f.point.getY(),h.point.getX(),h.point.getY(),f.center.getX(),f.center.getY(),f.bulge);d.end.bulge=l,d.insertSegment(new b.PolySegment(h.point,0)),l=this._calculateBulge(h.point.getX(),h.point.getY(),g.point2.getX(),g.point2.getY(),g.center.getX(),g.center.getY(),g.bulge),d.head.point=h.point,d.head.bulge=l}else{var k=this._constructJoinArc(f,g,!0);d.insertSegment(k),d.insertSegment(new b.PolySegment(g.point,0))}else d.insertSegment(new b.PolySegment(g.point2,0))}},b.prototype._constructJoinArc=function(a,c,d){var e=0;if(a.bulge){var f=a.bulge>0?1:-1,g=(a.point2.getY()-a.center.getY())*f,h=(a.center.getX()-a.point2.getX())*f;e=-GMath.segmentSide(a.point2.getX(),a.point2.getY(),a.point2.getX()+g,a.point2.getY()+h,c.point.getX(),c.point.getY())}else e=-GMath.segmentSide(a.point.getX(),a.point.getY(),a.point2.getX(),a.point2.getY(),c.point.getX(),c.point.getY());d||(e=-e);var i=null,j=0;return e&&(j=this._calculateBulge(a.point2.getX(),a.point2.getY(),c.point.getX(),c.point.getY(),c.basepoint.getX(),c.basepoint.getY(),e)),i=j?new b.PolySegment(a.point2,j,c.basepoint,GMath.ptDist(a.point2.getX(),a.point2.getY(),c.basepoint.getX(),c.basepoint.getY())):new b.PolySegment(a.point2,0)},b.prototype._calculateBulge=function(a,b,c,d,e,f,g){var h=GMath.ptSqrDist(a,b,e,f),i=GMath.ptSqrDist(c,d,e,f),j=0;if(GMath.isEqualEps(h,i,1e-8)){var k=GMath.ptSqrDist((a+c)/2,(b+d)/2,e,f);if(GMath.isEqualEps(k,0,1e-8))j=1;else{var l=Math.sqrt(k/h);j=Math.sqrt((1-l)/(1+l))}var m=Math.sqrt(h),n=(b-f)/m,o=(a-e)/m,p=(d-f)/m,q=(c-e)/m,r=n*q-o*p;j=0>r?-j:j,g&&(0>g&&j>0||g>0&&0>j)&&(j=-1/j)}return j},b.prototype._calcIntersectionPoints=function(a,b,c,d){for(var e,f=a.head,g=0;g<a.count-1;++g){e=b.head;for(var h=0;h<b.count-1;++h)this._calcSegmIntersectionPoints(f,e,g,h,c,d),e=e.next;f=f.next}},b.prototype._calcSelfIntersectionPoints=function(a,b){for(var c,d=a.head,e=0;e<a.count-2;++e){c=d.next;for(var f=e+1;f<a.count-1;++f)0==e&&f==a.count-2&&this._polyline.closed?this._calcSegmIntersectionPoints(c,d,f,e,b,b,!0):this._calcSegmIntersectionPoints(d,c,e,f,b,b,f==e+1),c=c.next;d=d.next}},b.prototype._calcSegmIntersectionPoints=function(a,c,d,e,f,g,h){if(a.bulge||c.bulge)if(!a.bulge&&c.bulge){var i=[null,null],j=a.next.point.getX()-a.point.getX(),k=a.next.point.getY()-a.point.getY();if(GMath.circleLineIntersection(a.point.getX(),a.point.getY(),j,k,c.center.getX(),c.center.getY(),c.radius,i),null!=i[0]&&i[0]>=0&&i[0]<=1&&(!h||!GMath.isEqualEps(i[0],1))){var l=a.point.getX()+j*i[0],m=a.point.getY()+k*i[0],n=this._calculateBulge(c.point.getX(),c.point.getY(),l,m,c.center.getX(),c.center.getY(),c.bulge);(0>n&&n>=c.bulge||n>0&&n<=c.bulge)&&(f.push(new b.IntersectionPt(l,m,i[0],a,d)),g.push(new b.IntersectionPt(l,m,n,c,e)))}if(null!=i[1]&&i[1]>=0&&i[1]<=1&&(!h||!GMath.isEqualEps(i[1],1))){var l=a.point.getX()+j*i[1],m=a.point.getY()+k*i[1],n=this._calculateBulge(c.point.getX(),c.point.getY(),l,m,c.center.getX(),c.center.getY(),c.bulge);(0>n&&n>=c.bulge||n>0&&n<=c.bulge)&&(f.push(new b.IntersectionPt(l,m,i[1],a,d)),g.push(new b.IntersectionPt(l,m,n,c,e)))}}else if(a.bulge&&!c.bulge){var i=[null,null],j=c.next.point.getX()-c.point.getX(),k=c.next.point.getY()-c.point.getY();if(GMath.circleLineIntersection(c.point.getX(),c.point.getY(),j,k,a.center.getX(),a.center.getY(),a.radius,i),null!=i[0]&&i[0]>=0&&i[0]<=1&&(!h||!GMath.isEqualEps(i[0],0))){var l=c.point.getX()+j*i[0],m=c.point.getY()+k*i[0],n=this._calculateBulge(a.point.getX(),a.point.getY(),l,m,a.center.getX(),a.center.getY(),a.bulge);(0>n&&n>=a.bulge||n>0&&n<=a.bulge)&&(f.push(new b.IntersectionPt(l,m,n,a,d)),g.push(new b.IntersectionPt(l,m,i[0],c,e)))}if(null!=i[1]&&i[1]>=0&&i[1]<=1&&(!h||!GMath.isEqualEps(i[1],0))){var l=c.point.getX()+j*i[1],m=c.point.getY()+k*i[1],n=this._calculateBulge(a.point.getX(),a.point.getY(),l,m,a.center.getX(),a.center.getY(),a.bulge);(0>n&&n>=a.bulge||n>0&&n<=a.bulge)&&(f.push(new b.IntersectionPt(l,m,n,a,d)),g.push(new b.IntersectionPt(l,m,i[1],c,e)))}}else{var i=[null,null];if(GMath.circleCircleIntersection(a.center.getX(),a.center.getY(),a.radius,c.center.getX(),c.center.getY(),c.radius,i),i[0]&&(!h||!GMath.isEqualEps(i[0].getX(),c.point.getX())&&!GMath.isEqualEps(i[0].getY(),c.point.getY()))){var o=this._calculateBulge(a.point.getX(),a.point.getY(),i[0].getX(),i[0].getY(),a.center.getX(),a.center.getY(),a.bulge);if(0>o&&o>=a.bulge||o>0&&o<=a.bulge){var p=this._calculateBulge(c.point.getX(),c.point.getY(),i[0].getX(),i[0].getY(),c.center.getX(),c.center.getY(),c.bulge);(0>p&&p>=c.bulge||p>0&&p<=c.bulge)&&(f.push(new b.IntersectionPt(i[0].getX(),i[0].getY(),o,a,d)),g.push(new b.IntersectionPt(i[0].getX(),i[0].getY(),p,c,e)))}}if(i[1]&&(!h||!GMath.isEqualEps(i[1].getX(),c.point.getX())&&!GMath.isEqualEps(i[1].getY(),c.point.getY()))){var q=this._calculateBulge(a.point.getX(),a.point.getY(),i[1].getX(),i[1].getY(),a.center.getX(),a.center.getY(),a.bulge);if(0>q&&q>=a.bulge||q>0&&q<=a.bulge){var r=this._calculateBulge(c.point.getX(),c.point.getY(),i[1].getX(),i[1].getY(),c.center.getX(),c.center.getY(),c.bulge);(0>r&&r>=c.bulge||r>0&&r<=c.bulge)&&(f.push(new b.IntersectionPt(i[1].getX(),i[1].getY(),q,a,d)),g.push(new b.IntersectionPt(i[1].getX(),i[1].getY(),r,c,e)))}}}else if(!h){var i=[null,null],s=GMath.getIntersectionPoint(a.point.getX(),a.point.getY(),a.next.point.getX(),a.next.point.getY(),c.point.getX(),c.point.getY(),c.next.point.getX(),c.next.point.getY(),i);s&&0<=i[0]&&i[0]<=1&&0<=i[1]&&i[1]<=1&&(f.push(new b.IntersectionPt(s.getX(),s.getY(),i[0],a,d)),g.push(new b.IntersectionPt(s.getX(),s.getY(),i[1],c,e)))}},b.prototype._sortInsertsectionPoints=function(a){a.sort(function(a,b){return a.segmIdx!=b.segmIdx?a.segmIdx-b.segmIdx:a.slope>0?a.slope-b.slope:b.slope-a.slope})},b.prototype._splitForClipping=function(a,c){for(var d,e=1e-4,f=a.head,g=0,h=f,i=h,j=[],k=0;k<c.length;++k){j[k]=new b.PolySegmentContainer;for(var l=g;l<c[k].segmIdx;++l)j[k].insertSegment(new b.PolySegment(h.point,h.bulge,h.center,h.radius)),h=i.next,i=h;h.bulge?GMath.isEqualEps(c[k].x,h.point.getX(),e)&&GMath.isEqualEps(c[k].y,h.point.getY(),e)?j[k].insertSegment(new b.PolySegment(h.point,0)):(h==i?j[k].insertSegment(new b.PolySegment(h.point,c[k].slope,h.center,h.radius)):(d=(c[k].slope-c[k-1].slope)/(1+c[k].slope*c[k-1].slope),j[k].insertSegment(new b.PolySegment(h.point,d,h.center,h.radius))),j[k].insertSegment(new b.PolySegment(new GPoint(c[k].x,c[k].y),0)),d=(i.bulge-c[k].slope)/(1+i.bulge*c[k].slope),h=new b.PolySegment(new GPoint(c[k].x,c[k].y),d,h.center,h.radius)):(j[k].insertSegment(new b.PolySegment(h.point,0)),GMath.isEqualEps(c[k].x,h.point.getX(),e)&&GMath.isEqualEps(c[k].y,h.point.getY(),e)||(h=new b.PolySegment(new GPoint(c[k].x,c[k].y),0),j[k].insertSegment(h))),g=l,i.next&&GMath.isEqualEps(c[k].x,i.next.point.getX(),e)&&GMath.isEqualEps(c[k].y,i.next.point.getY(),e)&&(++g,h=i.next,i=h)}var m=this._polyline.closed;if(g!=a.count-1){j[k]=new b.PolySegmentContainer;for(var l=g;l<a.count;++l)j[k].insertSegment(new b.PolySegment(h.point,h.bulge,h.center,h.radius)),h=i.next,i=h}if(1==j[0].count&&(j=j.slice(1)),m){var n=j.length,o=j[n-1],p=o.end.point,q=j[0].head.point;if(n>1&&GMath.isEqualEps(p.getX(),q.getX(),e)&&GMath.isEqualEps(p.getY(),q.getY(),e)){o.deleteSegment(o.end),h=j[0].head;for(var k=0;k<j[0].count;++k)o.insertSegment(new b.PolySegment(h.point,h.bulge,h.center,h.radius)),h=h.next;j=j.slice(1)}else j[0].closed=!0}for(var r=[],k=0;k<j.length;++k)1!=j[k].count&&r.push(j[k]);return r},b.prototype._excludeCircleInside=function(a,c,d,e,f){for(var g=0,h=new b.PolySegment(a.head.point,a.head.bulge,a.head.center,a.head.radius),i=a.head,j=new b.PolySegmentContainer,k=0;k<c.length;++k){for(var l=g;l<c[k].segmIdx-1;++l)j.insertSegment(h),i=i.next,h=new b.PolySegment(i.point,i.bulge,i.center,i.radius);if(h.bulge){var m=[null,null];if(GMath.circleCircleIntersection(i.center.getX(),i.center.getY(),i.radius,d[k].x,d[k].y,e,m),null!=m[0]){var n=this._calculateBulge(h.point.getX(),h.point.getY(),m[0].getX(),m[0].getY(),i.center.getX(),i.center.getY(),h.bulge);0>n&&n>h.bulge||n>0&&n<h.bulge?(j.insertSegment(new b.PolySegment(h.point,n,i.center,i.radius)),j.insertSegment(new b.PolySegment(m[0],0)),f.push(j)):(j.insertSegment(new b.PolySegment(h.point,0)),f.push(j))}if(null!=m[1]){var o=this._calculateBulge(h.point.getX(),h.point.getY(),m[1].getX(),m[1].getY(),i.center.getX(),i.center.getY(),h.bulge);if(0>o&&o>h.bulge&&n>o||o>0&&o<h.bulge&&o>n){j=new b.PolySegmentContainer;var p=(h.bulge-o)/(1+h.bulge*o);h=new b.PolySegment(new GPoint(s,t),p,i.center,i.radius)}else j=new b.PolySegmentContainer}else j=new b.PolySegmentContainer}else{var m=[null,null],q=i.next.point.getX()-h.point.getX(),r=i.next.point.getY()-h.point.getY();if(GMath.circleLineIntersection(h.point.getX(),h.point.getY(),q,r,d[k].x,d[k].y,e,m),null!=m[0])if(m[0]<=0)j.insertSegment(new b.PolySegment(h.point,0)),f.push(j);else if(m[0]>0&&m[0]<1){var s=h.point.getX()+q*m[0],t=h.point.getY()+r*m[0];j.insertSegment(new b.PolySegment(h.point,0)),j.insertSegment(new b.PolySegment(new GPoint(s,t),0)),f.push(j)}else j.insertSegment(new b.PolySegment(h.point,0)),j.insertSegment(new b.PolySegment(i.next.point,0)),f.push(j);null!=m[1]&&m[1]>m[0]&&m[1]<1?(j=new b.PolySegmentContainer,s=h.point.getX()+q*m[1],t=h.point.getY()+r*m[1],h=new b.PolySegment(new GPoint(s,t),0)):j=new b.PolySegmentContainer}g=c[k].segmIdx}for(var l=g;l<a.count;++l)h&&(j.insertSegment(h),i=i.next,h=i?new b.PolySegment(i.point,i.bulge,i.center,i.radius):null)},b.prototype._gcppClipping=function(a,b,c,d){for(var e,f=0;f<a.length;++f){e=a[f];for(var g=b.head,h=0;h<b.count-1;++h){for(var i=e.head,j=0;j<e.count-1;++j)i=i.next;g=g.next}d.push(e)}},b.prototype._gcppFilter=function(a,b,c,d,e){for(var f,g,h=(c-d)*(c-d),i=c+d,j=i*i,k=0;k<a.length;++k){f=a[k];var l=b.head;g=j;for(var m=0;m<b.count-1&&g>=h;++m){for(var n=f.head,o=0;o<f.count-1&&g>=h;++o)g=this._getPlSegmSqrDist(l,l.next.point,n,n.next.point,i),n=n.next;l=l.next}g>=h&&e.push(f)}},b.prototype._getPlSegmSqrDist=function(a,b,c,d,e){var f;return f=a.bulge||c.bulge?c.bulge?a.bulge?this._getArcToArcSqrDist(a,b,c,d,e):this._getSegmToArcSqrDist(c.point,c.bulge,c.center,c.radius,d,a.point,b,e*e):this._getSegmToArcSqrDist(a.point,a.bulge,a.center,a.radius,b,c.point,d,e*e):GMath.getSegmToSegmSqrDist(a.point,b,c.point,d)
},b.prototype._getSegmToArcSqrDist=function(a,b,c,d,e,f,g,h){if(GMath.isEqualEps(f.getX(),g.getX())&&GMath.isEqualEps(f.getY(),g.getY()))return this._getPtToArcSqrDist(a,b,c,d,e,f);var i,j=h,k=[null,null],l=g.getX()-f.getX(),m=g.getY()-f.getY();if(GMath.circleLineIntersection(f.getX(),f.getY(),l,m,c.getX(),c.getY(),d,k),null!=k[0]&&null==k[1]){var n=this._calculateBulge(a.getX(),a.getY(),k[0].getX(),k[0].getY(),c.getX(),c.getY(),b),o=k[1].getX()-f.getX(),p=k[1].getY()-f.getY();(0>o&&o>=l||o>=0&&l>=o)&&(0>p&&p>=m||p>=0&&m>=p)?0>n&&n>=b||n>=0&&b>=n?j=0:(j=GMath.sqrSegmentDist(f.getX(),f.getY(),g.getX(),g.getY(),a.getX(),a.getY()),i=GMath.sqrSegmentDist(f.getX(),f.getY(),g.getX(),g.getY(),e.getX(),e.getY()),j>i&&(j=i)):(j=this._getPtToArcSqrDist(a,b,c,d,e,f),i=this._getPtToArcSqrDist(a,b,c,d,e,g),j>i&&(j=i))}else{if(null==k[0]){var q=[null];if(i=GMath.sqrSegmentDist(f.getX(),f.getY(),g.getX(),g.getY(),c.getX(),c.getY(),q),q[0]>0&&1>q){var r=f.getX()+q[0]*(g.getX()-f.getX()),s=f.getY()+q[0]*(g.getY()-f.getY()),t=d/Math.sqrt(i),u=c.getX()+t*(r-c.getX()),v=c.getY()+t*(s-c.getY()),w=this._calculateBulge(a.getX(),a.getY(),u,v,c.getX(),c.getY(),b);(0>w&&w>=b||w>=0&&b>=w)&&(j=GMath.sqrSegmentDist(f.getX(),f.getY(),g.getX(),g.getY(),u,v))}}i=GMath.sqrSegmentDist(f.getX(),f.getY(),g.getX(),g.getY(),a.getX(),a.getY()),j>i&&(j=i),j>0&&(i=GMath.sqrSegmentDist(f.getX(),f.getY(),g.getX(),g.getY(),e.getX(),e.getY()),j>i&&(j=i),j>0&&(i=this._getPtToArcSqrDist(a,b,c,d,e,f),j>i&&(j=i),j>0&&(i=this._getPtToArcSqrDist(a,b,c,d,e,g),j>i&&(j=i))))}return j},b.prototype._getPtToArcSqrDist=function(a,b,c,d,e,f){var g,h=GMath.ptSqrDist(f.getX(),f.getY(),c.getX(),c.getY());if(GMath.isEqualEps(h,0))g=d*d;else{var i=d/Math.sqrt(h),j=c.getX()+i*(f.getX()-c.getX()),k=c.getY()+i*(f.getY()-c.getY()),l=this._calculateBulge(a.getX(),a.getY(),j,k,c.getX(),c.getY(),b);0>l&&l>=b||l>=0&&b>=l?g=GMath.ptSqrDist(f.getX(),f.getY(),j,k):(g=GMath.ptSqrDist(f.getX(),f.getY(),a.getX(),a.getY()),h=GMath.ptSqrDist(f.getX(),f.getY(),e.getX(),e.getY()),g>h&&(g=h))}return g},b.prototype._getArcToArcSqrDist=function(a,b,c,d,e){var f=a.center.getX(),g=a.center.getY(),h=c.center.getX(),i=c.center.getY(),j=a.radius+c.radius+e,k=e*e;if(GMath.ptSqrDist(f,g,h,i)>j*j)return k;var l=null,m=[a.point,b],n=[c.point,d],o=[null,null];GMath.circleCircleIntersection(f,g,a.radius,h,i,c.radius,o);for(var p,q,r,s=0;2>s&&null!=o[s]&&null===l;++s)p=this._calculateBulge(a.point.getX(),a.point.getY(),o[s].getX(),o[s].getY(),a.center.getX(),a.center.getY(),a.bulge),q=0>p&&a.bulge<=p||p>=0&&a.bulge>=p,p=this._calculateBulge(c.point.getX(),c.point.getY(),o[s].getX(),o[s].getY(),c.center.getX(),c.center.getY(),c.bulge),r=0>p&&c.bulge<=p||p>=0&&c.bulge>=p,q&&r?l=0:q?m.push(o[s]):r&&n.push(o[s]);if(!(o[0]||GMath.isEqualEps(f,h)&&GMath.isEqualEps(g,i))){var t=h-f,u=i-g,v=[null,null];GMath.circleLineIntersection(f,g,t,u,h,i,c.radius,v);for(var w,x,s=0;2>s&&null!=v[s];++s)w=f+t*v[s],x=g+u*v[s],p=this._calculateBulge(c.point.getX(),c.point.getY(),w,x,c.center.getX(),c.center.getY(),c.bulge),r=0>p&&c.bulge<=p||p>=0&&c.bulge>=p,r&&n.push(new GPoint(w,x));t=-t,u=-u,v=[null,null],GMath.circleLineIntersection(h,i,t,u,f,g,a.radius,v);for(var s=0;2>s&&null!=v[s];++s)w=h+t*v[s],x=i+u*v[s],p=this._calculateBulge(a.point.getX(),a.point.getY(),w,x,a.center.getX(),a.center.getY(),a.bulge),q=0>p&&a.bulge<=p||p>=0&&a.bulge>=p,q&&m.push(new GPoint(w,x))}if(0!==l){l=k;for(var y,s=0;s<m.length&&l>0;++s)y=this._getPtToArcSqrDist(c.point,c.bulge,c.center,c.radius,d,m[s]),l>y&&(l=y);for(var s=0;s<n.length&&l>0;++s)y=this._getPtToArcSqrDist(a.point,a.bulge,a.center,a.radius,b,n[s]),l>y&&(l=y)}return l},b.prototype._roundOut=function(a){var b=Math.round(a*this._tolRange)/this._tolRange;return b},b.prototype._genCurves=function(a,b,c){for(var d,e=0;e<a.length;++e){d=a[e];for(var f=d.head,g=[],h=new GPoint(this._roundOut(f.point.getX()),this._roundOut(f.point.getY())),i=h,j=0;j<d.count-1;++j){if(f.bulge){if(this._genBeziers(f.point,f.next.point,f.bulge,f.center,f.radius,c,g),j==d.count-2){var k=g[g.length-3];i=new GPoint(k.x,k.y)}}else g.push({c:GVertex.Command.Line,x:this._roundOut(f.next.point.getX()),y:this._roundOut(f.next.point.getY())}),j==d.count-2&&(i=new GPoint(this._roundOut(f.next.point.getX()),this._roundOut(f.next.point.getY())));f=f.next}var l={stPt:h,endPt:i,vrt:g};b.push(l)}},b.prototype._genBeziers=function(a,b,c,d,e,f,g){var h=Math.abs(4*Math.atan(c)),i=Math.ceil(2*h/Math.PI);for(h/=i;32>=i&&this._getCubicBezierArcError(h,e)>f;)h/=2,i=2*i;c>0&&(h=-h);for(var j,k,l,m,n,o,p,q,r=Math.cos(h),s=Math.sin(h),t=(1-r)/(1+r),u=e*s*(Math.sqrt(4+3*t)-1)/3,v=(a.getX()-d.getX())/e,w=(a.getY()-d.getY())/e,x=a.getX(),y=a.getY(),z=0;i>z;++z)l=x,m=y,j=v,k=w,v=j*r-k*s,w=k*r+j*s,x=d.getX()+e*v,y=d.getY()+e*w,n=l-u*k,o=m+u*j,p=x+u*w,q=y-u*v,g.push({c:GVertex.Command.Curve2,x:this._roundOut(x),y:this._roundOut(y)}),g.push({c:GVertex.Command.Curve2,x:this._roundOut(n),y:this._roundOut(o)}),g.push({c:GVertex.Command.Curve2,x:this._roundOut(p),y:this._roundOut(q)})},b.prototype._getCubicBezierArcError=function(a,b){var c=5.15347174*b,d=Math.cos(a),e=d*d,f=2*e-1,g=(4*e-3)*d,h=-19.65763511+22979e-8*d+42715e-8*f+.00103256*g,i=9.92683097+45907e-8*d+.00174813*f-34153e-8*g;return c*Math.exp(h+i*a)},b.prototype._rewindVertices=function(){for(var a=0;a<this._pieces.length;++a)this._pieces[a].rewindVertices(0)},b.prototype._readVertex=function(a){return this._pieces[this._pieceIdx]&&this._pieces[this._pieceIdx].readVertex(a)?!0:(++this._pieceIdx,this._pieces[this._pieceIdx]&&this._pieces[this._pieceIdx].readVertex(a))},b.prototype.toString=function(){return"[Object GVertexOffsetter]"},a.GVertexOffsetter=b}(this),function(a){function b(){}b.getCurve=function(a){var b,d,e=[],f=[],g=[];for(d=0;d<a.length;d++)b=a[d],f.push(b[0]),g.push(b[1]);for(cubicSpline=new c(f,g),d=0;256>=d;d++)e[d]=Math.round(cubicSpline.interpolate(d))||0;return e},b.getCurves=function(a){var c,d,e=[],f={},g=0;Array.prototype.getLowestAbove=function(a){return Math.min.apply(0,this.filter(function(a){return a>this},a))||0};for(g in a)e.push(b.getCurve(a[g]));f.a=e[0],f.r=e[1],f.g=e[2],f.b=e[3];for(g in f)for(c=f[g].getLowestAbove(0)-1,d=0;d<=f[g].length;d++)0==f[g][d]&&(f[g][d]=c);return f},b.apply=function(a,c,d,e){var f=b.getCurves(e);if(f){for(var g=a.length,h=0;g>h;h+=4)a[h]=f.r[a[h]],a[h+1]=f.g[a[h+1]],a[h+2]=f.b[a[h+2]];for(var h=0;g>h;h+=4)a[h]=f.a[a[h]],a[h+1]=f.a[a[h+1]],a[h+2]=f.a[a[h+2]]}},a.GColorGradingFilter=b;var c=function(){function a(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;for(i=a.length,e=[],h=[],c=[],d=[],f=[],j=[],g=0,p=i-1;p>=0?p>g:g>p;p>=0?g+=1:g-=1)e[g]=(b[g+1]-b[g])/(a[g+1]-a[g]),g>0&&(h[g]=(e[g-1]+e[g])/2);for(h[0]=e[0],h[i-1]=e[i-2],k=[],g=0,q=i-1;q>=0?q>g:g>q;q>=0?g+=1:g-=1)0===e[g]&&k.push(g);for(l=0,n=k.length;n>l;l++)g=k[l],h[g]=h[g+1]=0;for(g=0,r=i-1;r>=0?r>g:g>r;r>=0?g+=1:g-=1)c[g]=h[g]/e[g],d[g]=h[g+1]/e[g],f[g]=Math.pow(c[g],2)+Math.pow(d[g],2),j[g]=3/Math.sqrt(f[g]);for(k=[],g=0,s=i-1;s>=0?s>g:g>s;s>=0?g+=1:g-=1)f[g]>9&&k.push(g);for(m=0,o=k.length;o>m;m++)g=k[m],h[g]=j[g]*c[g]*e[g],h[g+1]=j[g]*d[g]*e[g];this.x=a.slice(0,i),this.y=b.slice(0,i),this.m=h}return a.prototype.interpolate=function(a){var b,c,d,e,f,g,h,i,j,k,l;for(g=l=this.x.length-2;(0>=l?0>=g:g>=0)&&!(this.x[g]<=a);0>=l?g+=1:g-=1);return b=this.x[g+1]-this.x[g],h=(a-this.x[g])/b,i=Math.pow(h,2),j=Math.pow(h,3),c=2*j-3*i+1,e=j-2*i+h,d=-2*j+3*i,f=j-i,k=c*this.y[g]+e*b*this.m[g]+d*this.y[g+1]+f*b*this.m[g+1]},a}()}(this),function(a){function b(){}b.COLOR_MATRIX_IDENTITY=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],b.COLOR_MATRIX_INVERT=[-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0],b.COLOR_MATRIX_GRAYSCALE=[.33,.33,.33,0,0,.33,.33,.33,0,0,.33,.33,.33,0,0,0,0,0,1,0],b.apply=function(a,b,c,d){for(var e=0;c>e;++e)for(var f=0;b>f;++f){var g=4*(e*b+f),h=a[g],i=a[g+1],j=a[g+2],k=a[g+3];a[g]=d[0]*h+d[1]*i+d[2]*j+d[3]*k+d[4],a[g+1]=d[5]*h+d[6]*i+d[7]*j+d[8]*k+d[9],a[g+2]=d[10]*h+d[11]*i+d[12]*j+d[13]*k+d[14],a[g+3]=d[15]*h+d[16]*i+d[17]*j+d[18]*k+d[19]}},a.GColorMatrixFilter=b}(this),function(a){function b(){}b.apply=function(a,b,c,d){for(var e=0;c>e;++e)for(var f=0;b>f;++f){var g=4*(e*b+f);a[g]=a[g]*d.multiplier[0]+d.offsets[0],a[g+1]=a[g+1]*d.multiplier[1]+d.offsets[1],a[g+2]=a[g+2]*d.multiplier[2]+d.offsets[2],a[g+3]=a[g+3]*d.multiplier[3]+d.offsets[3]}},a.GColorTransformFilter=b}(this),function(a){function b(){}function c(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}b.apply=function(a,b,f,g){var h=g||0;if(!(isNaN(h)||1>h)){h|=0;var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G=h+h+1,H=b-1,I=f-1,J=h+1,K=J*(J+1)/2,L=new c,M=L;for(k=1;G>k;k++)if(M=M.next=new c,k==J)var N=M;M.next=L;var O=null,P=null;o=n=0;var Q=d[h],R=e[h];for(j=0;f>j;j++){for(x=y=z=A=p=q=r=s=0,t=J*(B=a[n]),u=J*(C=a[n+1]),v=J*(D=a[n+2]),w=J*(E=a[n+3]),p+=K*B,q+=K*C,r+=K*D,s+=K*E,M=L,k=0;J>k;k++)M.r=B,M.g=C,M.b=D,M.a=E,M=M.next;for(k=1;J>k;k++)l=n+((k>H?H:k)<<2),p+=(M.r=B=a[l])*(F=J-k),q+=(M.g=C=a[l+1])*F,r+=(M.b=D=a[l+2])*F,s+=(M.a=E=a[l+3])*F,x+=B,y+=C,z+=D,A+=E,M=M.next;for(O=L,P=N,i=0;b>i;i++)a[n]=p*Q>>R,a[n+1]=q*Q>>R,a[n+2]=r*Q>>R,a[n+3]=s*Q>>R,p-=t,q-=u,r-=v,s-=w,t-=O.r,u-=O.g,v-=O.b,w-=O.a,l=o+((l=i+h+1)<H?l:H)<<2,x+=O.r=a[l],y+=O.g=a[l+1],z+=O.b=a[l+2],A+=O.a=a[l+3],p+=x,q+=y,r+=z,s+=A,O=O.next,t+=B=P.r,u+=C=P.g,v+=D=P.b,w+=E=P.a,x-=B,y-=C,z-=D,A-=E,P=P.next,n+=4;o+=b}for(i=0;b>i;i++){for(y=z=A=x=q=r=s=p=0,n=i<<2,t=J*(B=a[n]),u=J*(C=a[n+1]),v=J*(D=a[n+2]),w=J*(E=a[n+3]),p+=K*B,q+=K*C,r+=K*D,s+=K*E,M=L,k=0;J>k;k++)M.r=B,M.g=C,M.b=D,M.a=E,M=M.next;for(m=b,k=1;h>=k;k++)n=m+i<<2,p+=(M.r=B=a[n])*(F=J-k),q+=(M.g=C=a[n+1])*F,r+=(M.b=D=a[n+2])*F,s+=(M.a=E=a[n+3])*F,x+=B,y+=C,z+=D,A+=E,M=M.next,I>k&&(m+=b);for(n=i,O=L,P=N,j=0;f>j;j++)l=n<<2,a[l+3]=E=s*Q>>R,E>0?(E=255/E,a[l]=(p*Q>>R)*E,a[l+1]=(q*Q>>R)*E,a[l+2]=(r*Q>>R)*E):a[l]=a[l+1]=a[l+2]=0,p-=t,q-=u,r-=v,s-=w,t-=O.r,u-=O.g,v-=O.b,w-=O.a,l=i+((l=j+J)<I?l:I)*b<<2,p+=x+=O.r=a[l],q+=y+=O.g=a[l+1],r+=z+=O.b=a[l+2],s+=A+=O.a=a[l+3],O=O.next,t+=B=P.r,u+=C=P.g,v+=D=P.b,w+=E=P.a,x-=B,y-=C,z-=D,A-=E,P=P.next,n+=b}}};var d=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],e=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];a.GStackBlurFilter=b}(this),function(a){function b(a,b){var c=0,d=0,e=null,f=null;if("number"==typeof a?(c=a,d=b):a instanceof Image||a instanceof HTMLImageElement?(c=a.naturalWidth,d=a.naturalHeight,f=a):a instanceof GPaintCanvas?e=a._canvasContext.canvas:a instanceof HTMLCanvasElement?e=a:a instanceof CanvasRenderingContext2D&&(e=a.canvas),e)this._canvas=e;else{if(0>=c||0>=d)throw new Error("Invalid bitmap size");this._canvas=document.createElement("canvas"),this._canvas.width=c,this._canvas.height=d}this._canvasContext=this._canvas.getContext("2d"),f&&this._canvasContext.drawImage(f)}b.ImageType={PNG:"image/png",JPEG:"image/jpeg"},b.prototype._canvas=null,b.prototype._canvasContext=null,b.prototype.getWidth=function(){return this._canvas.width},b.prototype.getHeight=function(){return this._canvas.height},b.prototype.toImageDataUrl=function(a,b){var c=[a];return b&&(c=c.concat(b)),this._canvas.toDataURL.apply(this._canvas,c)},b.prototype.toImageBuffer=function(a,b,c){var d=[function(a){var c=new FileReader;c.onload=function(a){b(a.target.result)},c.readAsArrayBuffer(a)},a];c&&(d=d.concat(c)),this._canvas.toBlob.apply(this._canvas,d)},b.prototype.clone=function(a){if(a=a||new GRect(0,0,this.getWidth(),this.getHeight()),a.isEmpty())return null;var c=new b(a.getWidth(),a.getHeight()),d=this._canvasContext.getImageData(a.getX(),a.getY(),a.getWidth(),a.getHeight());return c._canvasContext.putImageData(d,0,0),c},b.prototype.resize=function(a,b,c){if(a=a||0,b=b||0,c=c||GRect.Side.TOP_LEFT,a||b){var d=a-this.getWidth(),e=b-this.getHeight(),f=0,g=0,h=0,i=0;if(d!==this.getWidth())switch(c){case GRect.Side.TOP_LEFT:case GRect.Side.LEFT_CENTER:case GRect.Side.BOTTOM_LEFT:h=d;break;case GRect.Side.TOP_CENTER:case GRect.Side.CENTER:case GRect.Side.BOTTOM_CENTER:f=-d/2,h=d/2;break;case GRect.Side.TOP_RIGHT:case GRect.Side.RIGHT_CENTER:case GRect.Side.BOTTOM_RIGHT:f=-d}if(e!==this.getHeight())switch(c){case GRect.Side.TOP_LEFT:case GRect.Side.TOP_CENTER:case GRect.Side.TOP_RIGHT:i=e;break;case GRect.Side.LEFT_CENTER:case GRect.Side.CENTER:case GRect.Side.RIGHT_CENTER:g=-e/2,i=e/2;break;case GRect.Side.BOTTOM_LEFT:case GRect.Side.BOTTOM_CENTER:case GRect.Side.BOTTOM_RIGHT:g=-e}var j=this._canvasContext.getImageData(0,0,this.getWidth(),this.getHeight());this._canvas.width=this.getWidth()-f+h,this._canvas.height=this.getHeight()-g+i,this._canvasContext.clearRect(0,0,this.getWidth(),this.getHeight()),this._canvasContext.putImageData(j,-f,-g)}},b.prototype.crop=function(a,b,c,d){a=a||0,b=b||0,c=c||0,d=d||0;var e=this.getWidth()-c,f=this.getHeight()-d,g=this._canvasContext.getImageData(a,b,e,f);this._canvas.width=e,this._canvas.height=f,this._canvasContext.clearRect(0,0,e,f),this._canvasContext.putImageData(g,0,0)},b.prototype.trim=function(){for(var a,b=this._canvasContext.getImageData(0,0,this.getWidth(),this.getHeight()),c=b.data.length,d={top:null,left:null,right:null,bottom:null},e=this.getWidth(),f=this.getHeight(),g=null,h=0;c>h;h+=4)0!==b.data[h+3]&&(a=h/4%e,g=~~(h/4/e),null===d.top&&(d.top=g),null===d.left?d.left=a:a<d.left&&(d.left=a),null===d.right?d.right=a:d.right<a&&(d.right=a),null===d.bottom?d.bottom=g:d.bottom<g&&(d.bottom=g));this.crop(d.left,d.top,e-(d.right-d.left),f-(d.bottom-d.top))},b.prototype.modifyPixels=function(a,b,c){if(c=c||new GRect(0,0,this.getWidth(),this.getHeight()),!c.isEmpty()){var d=this._canvasContext.getImageData(c.getX(),c.getY(),c.getWidth(),c.getHeight());a(d.data,c.getWidth(),c.getHeight(),b),this._canvasContext.putImageData(d,c.getX(),c.getY())}},b.prototype.applyFilter=function(a,b,c){this.modifyPixels(a.apply,b,c)},b.prototype.toString=function(){return"[Object GBitmap]"},a.GBitmap=b}(this),function(a){function b(){}var c='url("data:image/svg+xml;base64,'+btoa('<svg xmlns="http://www.w3.org/2000/svg" width="8" height="8"><rect width="8" height="8" fill="white"/><rect width="4" height="4" fill="#CDCDCD"/><rect x="4" y="4" width="4" height="4" fill="#CDCDCD"/></svg>')+'")';b.MIME_TYPE="application/infinity+pattern",b.inherit=function(a,c,d){GObject.inherit(c,d?d:b),b._idClassMap[a]=c},b._idClassMap={},b.smartCreate=function(a,b){if(a){if(a===GBackground)return new GBackground;if(a===GGradient){var c=[{opacity:1,position:0},{opacity:1,position:1},{color:GRGBColor.WHITE,position:0},{color:GRGBColor.BLACK,position:1}];return b instanceof GColor&&!GUtil.equals(b.toScreen(),c[3].color.toScreen())&&(c[2].color=b),new GLinearGradient(c)}if(a===GColor){if(b instanceof GGradient)for(var c=b.getStops(),d=0;d<c.length;++d)if(c[d].hasOwnProperty("color"))return c[d].color;return new GRGBColor}throw new Error("Unknown pattern class.")}return null},b.asCSSBackground=function(a,b){b="number"==typeof b?b:1;var d=c;return a&&(d=a.asCSSBackground(b)+","+d),d},b.serialize=function(a){if(a){for(var c in b._idClassMap)if(a.constructor===b._idClassMap[c])return c+"#"+a.serialize();throw new Error("Unregistered Pattern Class.")}return null},b.deserialize=function(a){if(a){var c=a.indexOf("#");if(c>0){var d=a.substr(0,c);if(d&&d.length>0){var e=b._idClassMap[d];if(!e)throw new Error("Unregistered Pattern Class.");var f=new e;return f.deserialize(a.substr(c+1)),f}}}return null},b.prototype.asCSSBackground=function(){throw new Error("Not Supported")},b.prototype.serialize=function(){return""},b.prototype.deserialize=function(){},b.prototype.clone=function(){throw new Error("Not Supported")},a.GPattern=b}(this),function(a){function b(){}var c=null;GPattern.inherit("B",b),b.equals=function(a,b){return a||a!==b?a&&b?!0:!1:!0},b.prototype.asCSSBackground=function(){return c||(c='url("data:image/svg+xml;base64,'+btoa('<svg xmlns="http://www.w3.org/2000/svg" width="10" height="20" viewBox="0 0 5 10"><rect width="110%" x="-5%" y="-5%" height="110%" fill="#545454"/><line x1="-2" y1="1" x2="7" y2="10" stroke="#6e6e6e" stroke-width="2"/><line x1="-2" y1="6" x2="7" y2="15" stroke="#6e6e6e" stroke-width="2"/><line x1="-2" y1="-4" x2="7" y2="5" stroke="#6e6e6e" stroke-width="2"/></svg>')+'")'),c},b.prototype.toString=function(){return"[Object GBackground]"},a.GBackground=b}(this),function(a){function b(a){this._value=a&&a instanceof Array?a.slice():null}function c(a){return Math.min(255,Math.max(0,Math.round(a)))}GObject.inherit(b,GPattern),b.rgbToHSV=function(a){var b=a[0]/255,c=a[1]/255,d=a[2]/255,e=Math.min(b,Math.min(c,d)),f=Math.max(b,Math.max(c,d));if(e===f)return[0,0,e];var g=b===e?c-d:d===e?b-c:d-b,h=b===e?3:d===e?1:5;return[Math.min(360,Math.max(0,Math.round(60*(h-g/(f-e))))),(f-e)/f,f]},b.hsvToRGB=function(a){var b,d=a[2]*a[1],e=a[0]/60,f=d*(1-Math.abs(e%2-1)),g=a[2]-d;return 1>e?b=[d,f,0]:2>e?b=[f,d,0]:3>e?b=[0,d,f]:4>e?b=[0,f,d]:5>e?b=[f,0,d]:6>=e&&(b=[d,0,f]),[c(255*(b[0]+g)),c(255*(b[1]+g)),c(255*(b[2]+g))]},b.cmykToRGB=function(a){var b=4===a.length?a[3]:0,d=a[0]*(1-b)+b,e=a[1]*(1-b)+b,f=a[2]*(1-b)+b;return[c(255*(1-d)),c(255*(1-e)),c(255*(1-f))]},b.rgbToCMYK=function(a){var b=1-a[0]/255,c=1-a[1]/255,d=1-a[2]/255,e=Math.min(d,Math.min(c,Math.min(b,1)));return[Math.min(1,Math.max(0,(b-e)/(1-e))),Math.min(1,Math.max(0,(c-e)/(1-e))),Math.min(1,Math.max(0,(d-e)/(1-e))),Math.min(1,Math.max(0,e))]},b.rgbToHtmlHex=function(a){var b=a[0]<<16|a[1]<<8|a[2];return"#"+function(a){return new Array(7-a.length).join("0")+a}(b.toString(16).toUpperCase())},b.rgbToCSS=function(a,c){return"number"==typeof c&&1!==c?"rgba("+a[0]+","+a[1]+","+a[2]+","+c+")":b.rgbToHtmlHex(a)},b.prototype._value=null,b.prototype.getValue=function(){return this._value},b.prototype.serialize=function(){return this._value?JSON.stringify(this._value):""},b.prototype.deserialize=function(a){a&&(this._value=JSON.parse(a))},b.prototype.toHumanString=function(){throw new Error("Not Supported.")},b.prototype.toScreen=function(){throw new Error("Not Supported.")},b.prototype.toScreenCSS=function(a,c){return b.rgbToCSS(this.toScreen(c),a)},b.prototype.asCSSBackground=function(a){var b=this.toScreenCSS(a);return"linear-gradient("+b+", "+b+")"},b.prototype.toString=function(){return"[Object GColor]"},a.GColor=b}(this),function(a){function b(a){return a=Math.round(a),0>a?0:a>255?255:a}function c(a){a=a?[b(a[0]),b(a[1]),b(a[2])]:[0,0,0],GColor.call(this,a)}GPattern.inherit("C",c,GColor),c.BLACK=new c([0,0,0]),c.WHITE=new c([255,255,255]),c.fromCSSColor=function(a){var b=c.parseCSSColor(a);return b?new c(b.slice(0,3)):null},c.parseCSSColor=function(a){function d(a){return 0>a?0:a>1?1:a}function e(a){return b("%"===a[a.length-1]?parseFloat(a)/100*255:parseInt(a))}function f(a){return d("%"===a[a.length-1]?parseFloat(a)/100:parseFloat(a))}function g(a,b,c){return 0>c?c+=1:c>1&&(c-=1),1>6*c?a+(b-a)*c*6:1>2*c?b:2>3*c?a+(b-a)*(2/3-c)*6:a}var h={transparent:[255,255,255,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50]},i=a.replace(/ /g,"").toLowerCase();if(i in h)return h[i].slice();if("#"===i[0]){if(4===i.length){var j=parseInt(i.substr(1),16);return j>=0&&4095>=j?[(3840&j)>>4|(3840&j)>>8,240&j|(240&j)>>4,15&j|(15&j)<<4,1]:null}if(7===i.length){var j=parseInt(i.substr(1),16);return j>=0&&16777215>=j?[(16711680&j)>>16,(65280&j)>>8,255&j,1]:null}return null}var k=i.indexOf("("),l=i.indexOf(")");if(-1!==k&&l+1===i.length){var m=i.substr(0,k),n=i.substr(k+1,l-(k+1)).split(","),o=100;switch(m){case"rgba":if(4!==n.length)return null;o=f(n.pop());case"rgb":return 3!==n.length?null:[e(n[0]),e(n[1]),e(n[2]),o];case"hsla":if(4!==n.length)return null;o=f(n.pop());case"hsl":if(3!==n.length)return null;var p=(parseFloat(n[0])%360+360)%360/360,q=f(n[1]),r=f(n[2]),s=.5>=r?r*(q+1):r+q-r*q,t=2*r-s;return[b(255*g(t,s,p+1/3)),b(255*g(t,s,p)),b(255*g(t,s,p-1/3)),o];default:return null}}return c.parseCSSColor("#"+a)},c.equals=function(a,b){return a instanceof c&&b instanceof c?GUtil.equals(a._value,b._value):!1},c.prototype.toHumanString=function(){return"rgb "+this._value[0]+","+this._value[1]+","+this._value[2]},c.prototype.toScreen=function(){return this._value},c.prototype.clone=function(){return new c(this._value)},c.prototype.toString=function(){return"[Object GRGBColor]"},a.GRGBColor=c}(this),function(a){function b(a){GColor.call(this,a?a:[1,1,1,1])}GPattern.inherit("Y",b,GColor),b.equals=function(a,c){return a instanceof b&&c instanceof b?GUtil.equals(a._value,c._value):!1},b.prototype.toHumanString=function(){return"cmyk "+(100*this._value[0]).toFixed()+"%,"+(100*this._value[1]).toFixed()+"%,"+(100*this._value[2]).toFixed()+"%,"+(100*this._value[3]).toFixed()+"%"},b.prototype.toScreen=function(a){return GColor.cmykToRGB(this._value,a)},b.prototype.clone=function(){return new b(this._value)},b.prototype.toString=function(){return"[Object GCMYKColor]"},a.GCMYKColor=b}(this),function(a){function b(a,b){if(a){this._stops=[];for(var c=0;c<a.length;++c){var d=a[c],e={position:d.position};d.hasOwnProperty("color")?e.color=d.color:d.hasOwnProperty("opacity")&&(e.opacity=d.opacity),this._stops.push(e)}}else this._stops=[{opacity:1,position:0},{opacity:1,position:1},{color:GRGBColor.WHITE,position:0},{color:GRGBColor.BLACK,position:1}];this._scale="number"==typeof b?b:1}function c(a,b,c,d){for(var e=null,f=null,g=0;g<a.length;++g){var h=a[g];if(c(h)){if(h.position===b)return d(h,h);h.position<b&&(!e||h.position>e.position)&&(e=h),h.position>b&&(!f||h.position<f.position)&&(f=h)}}return d(e,f)}GObject.inherit(b,GPattern),b.interpolateOpacity=function(a,b){return c(a,b,function(a){return a.hasOwnProperty("opacity")},function(a,c){return a===c||a&&!c?a.opacity:c&&!a?c.opacity:c.opacity*b+a.opacity*(1-b)})},b.interpolateColor=function(a,b,d,e){return c(a,b,function(a){return a.hasOwnProperty("color")},function(a,c){if(a===c||a&&!c)return d?null:a.color;if(c&&!a)return c.color;var f=c.color.toScreen(e),g=a.color.toScreen(e);return new GRGBColor([Math.round(f[0]*b+g[0]*(1-b)),Math.round(f[1]*b+g[1]*(1-b)),Math.round(f[2]*b+g[2]*(1-b))])})},b.interpolateStops=function(a,c){for(var d=[],e=0;e<a.length;++e){var f=a[e];if(f.hasOwnProperty("color"))d.push({position:f.position,color:f.color,opacity:b.interpolateOpacity(a,f.position,!0)});else if(f.hasOwnProperty("opacity")){var g=b.interpolateColor(a,f.position,!0,c);null!==g&&d.push({position:f.position,color:g,opacity:f.opacity})}}return d.sort(function(a,b){return a.position>b.position})},b.equals=function(a,b,c){if(!a&&a===b)return!0;if(a&&b){if(!c&&a._scale!==b._scale)return!1;if(a._stops.length!==b._stops.length)return!1;for(var d=a._stops,e=b._stops,f=0;f<d.length;++f){if(d[f].position!==e[f].position)return!1;if(d[f].hasOwnProperty("opacity")){if(!e[f].hasOwnProperty("opacity"))return!1;if(d[f].opacity!==e[f].opacity)return!1}else if(!GUtil.equals(d[f].color,e[f].color))return!1}}return!1},b.prototype._stops=null,b.prototype._scale=null,b.prototype.getInterpolatedStops=function(a){return b.interpolateStops(this._stops,a)},b.prototype.getStops=function(){return this._stops},b.prototype.serialize=function(){return JSON.stringify(this._serializeToBlob())},b.prototype.deserialize=function(a){var b=JSON.parse(a);b&&this._deserializeFromBlob(b)},b.prototype.getScale=function(){return this._scale},b.prototype.toScreenCSS=function(a,b){for(var c=this.getInterpolatedStops(),d=[],e=0;e<c.length;++e){var f=c[e],g=f.opacity;"number"==typeof a&&(g*=a),d.push(""+f.color.toScreenCSS(g,b)+" "+Math.round(100*f.position)+"%")}return d.join(", ")},b.prototype._serializeToBlob=function(){var a={};this._scale&&1!==this._scale&&(a.s=this._scale),a.x=[];for(var b=0;b<this._stops.length;++b){var c=this._stops[b],d={p:c.position};c.hasOwnProperty("color")?d.c=GPattern.serialize(c.color):c.hasOwnProperty("opacity")&&(d.o=c.opacity),a.x.push(d)}return a},b.prototype._deserializeFromBlob=function(a){this._scale=a.hasOwnProperty("s")?a.s:1,this._stops=[];for(var b=0;b<a.x.length;++b){var c=a.x[b],d={position:c.p};c.hasOwnProperty("c")?d.color=GPattern.deserialize(c.c):c.hasOwnProperty("o")&&(d.opacity=c.o),this._stops.push(d)}},b.prototype.toString=function(){return"[Object GGradient]"},a.GGradient=b}(this),function(a){function b(a,b,c){GGradient.call(this,a,b),this._angle="number"==typeof c?c:0}GPattern.inherit("L",b,GGradient),b.equals=function(a,c,d){return a instanceof b&&c instanceof b&&GGradient.equals(a,c,d)&&!d?GMath.isEqualEps(a._angle,c._angle):!1},b._angle=0,b.prototype.getAngle=function(){return this._angle},b.prototype.asCSSBackground=function(a){var b=Math.round(GMath.toDegrees(this._angle))+90;return"linear-gradient("+b+"deg, "+this.toScreenCSS(a)+")"},b.prototype.clone=function(){return new b(this._stops)},b.prototype._serializeToBlob=function(){var a=GGradient.prototype._serializeToBlob.call(this);return a&&!GMath.isEqualEps(this._angle,0)&&(a.r=this._angle),a},b.prototype._deserializeFromBlob=function(a){GGradient.prototype._deserializeFromBlob.call(this,a),this._angle=a.hasOwnProperty("r")?a.r:0},b.prototype.toString=function(){return"[Object GLinearGradient]"},a.GLinearGradient=b}(this),function(a){function b(a,b){GGradient.call(this,a,b)}GPattern.inherit("R",b,GGradient),b.equals=function(a,c,d){return a instanceof b&&c instanceof b?GGradient.equals(a,c,d):!1},b.prototype.asCSSBackground=function(a){return"radial-gradient(ellipse at center, "+this.toScreenCSS(a)+")"},b.prototype.toString=function(){return"[Object GRadialGradient]"},a.GRadialGradient=b}(this),function(a){function b(){}b.prototype.AnnotType={Rectangle:0,Circle:1,Diamond:2};var c={};b.prototype.paintAnnotation=function(a,b,c,d,e,f,g,h){var i=this._getAnnotationTemplate(d);b&&(c=b.mapPoint(c));var j=h?h:a.selectionOutlineColor,k=g?g:null;e&&(k=j,j=GRGBColor.WHITE);var l=Math.floor(c.getX())+(k?.5:0),m=Math.floor(c.getY())+(k?.5:0),n=f/2/i.scaleFactor,o=f/2/i.scaleFactor,p=a.canvas,q=new GVertexTransformer(i.vertices,new GTransform(n,0,0,o,l,m));p.putVertices(q),p.fillVertices(j),k&&p.strokeVertices(k,1)},b.prototype.getAnnotationBBox=function(a,b,c){a&&(b=a.mapPoint(b));var d=Math.floor(b.getX())+.5,e=Math.floor(b.getY())+.5;return new GRect(d-c/2-1,e-c/2-1,c+2,c+2)},b.prototype._getAnnotationTemplate=function(a){var b=c[a];if(!b){var d=new GVertexContainer,e=1;switch(a){case this.AnnotType.Rectangle:d.addVertex(GVertex.Command.Move,-1,-1),d.addVertex(GVertex.Command.Line,1,-1),d.addVertex(GVertex.Command.Line,1,1),d.addVertex(GVertex.Command.Line,-1,1),d.addVertex(GVertex.Command.Close);break;case this.AnnotType.Circle:d.addVertex(GVertex.Command.Move,-1,0),d.addVertex(GVertex.Command.Curve,0,-1),d.addVertex(GVertex.Command.Curve,-1,-1),d.addVertex(GVertex.Command.Curve,1,0),d.addVertex(GVertex.Command.Curve,1,-1),d.addVertex(GVertex.Command.Curve,0,1),d.addVertex(GVertex.Command.Curve,1,1),d.addVertex(GVertex.Command.Curve,-1,0),d.addVertex(GVertex.Command.Curve,-1,1);
break;case this.AnnotType.Diamond:d.addVertex(GVertex.Command.Move,-1,0),d.addVertex(GVertex.Command.Line,0,-1),d.addVertex(GVertex.Command.Line,1,0),d.addVertex(GVertex.Command.Line,0,1),d.addVertex(GVertex.Command.Close),e=Math.cos(Math.PI/4)}b={vertices:d,scaleFactor:e},c[a]=b}return b},a.ifAnnotation=new b}(this),function(a){function b(){this._types={}}b.Style={Normal:"N",Italic:"I"},b.Weight={Thin:100,ExtraLight:200,Light:300,Regular:400,Medium:500,SemiBold:600,Bold:700,ExtraBold:800,Heavy:900},b.WeightName={100:new GLocale.Key(b,"weight.thin"),200:new GLocale.Key(b,"weight.extra-light"),300:new GLocale.Key(b,"weight.light"),400:new GLocale.Key(b,"weight.regular"),500:new GLocale.Key(b,"weight.medium"),600:new GLocale.Key(b,"weight.semi-bold"),700:new GLocale.Key(b,"weight.bold"),800:new GLocale.Key(b,"weight.extra-bold"),900:new GLocale.Key(b,"weight.heavy")},b.Category={Other:0,Serif:100,Monospace:200,Iconic:300},b.CategoryName={0:new GLocale.Key(b,"category.other"),100:new GLocale.Key(b,"category.serif"),200:new GLocale.Key(b,"category.monospace"),300:new GLocale.Key(b,"category.iconic")},b.prototype._types=null,b.prototype.addType=function(a,c,d,e,f){var g=this._types[a];g||(g={styles:{},weights:{},variants:{},category:f||b.Category.Other},this._types[a]=g);var h=c+d.toString();g.styles[c]=!0,g.weights[d]=!0;var i=function(a){switch(a){case b.Style.Normal:return"normal";case b.Style.Italic:return"italic";default:throw new Error("Unknown style")}};return $.ajax({type:"GET",url:e,dataType:"arraybuffer"}).fail(function(){console.log("Font fail: "+e,arguments)}).done(function(b){if(b instanceof ArrayBuffer){console.log("Font loaded: "+e);var f=opentype.parse(b);f&&f.supported&&(g.variants[h]={url:e,font:f,outlines:{}},$("<style></style>").attr("type","text/css").text('@font-face {font-family: "'+a+'";src: url("'+e+'");font-weight: '+d.toString()+";font-style: "+i(c)+";} ").appendTo($("body")),$("<span></span>").css({position:"absolute",left:"0px",top:"0px",opacity:"0","font-family":a,"font-weight":d.toString(),"font-style":i(c)}).text(".").appendTo($("body")))}})},b.prototype.getFamilies=function(){var a=Object.keys(this._types);return a.sort(),a},b.prototype.getCategory=function(a){var c=this._types[a];return c?c.category:b.Category.Other},b.prototype.getStyles=function(a){var b=this._types[a];return b?Object.keys(b.styles):null},b.prototype.getWeights=function(a){var b=this._types[a];if(b){for(var c=Object.keys(b.weights),d=[],e=0;e<c.length;++e)d.push(parseInt(c[e]));return d.sort(),d}return null},b.prototype.getVariant=function(a,c,d,e){var f=this._types[a];if(f){if(f.styles.hasOwnProperty(c)||e||(c=b.Style.Normal),d="number"==typeof d?d:parseInt(d),!e){for(;!f.weights.hasOwnProperty(d)&&d>=100;)d-=100;for(;!f.weights.hasOwnProperty(d)&&900>=d;)d+=100}var g=c+d.toString();if(f.variants.hasOwnProperty(g))return g}return null},b.prototype.getGlyphBaseline=function(a,b,c){var d=this._types[a].variants[b].font,e=1/d.unitsPerEm*c;return d.ascender*e},b.prototype.getGlyphCharSzRect=function(a,b,c,d){var e=this._types[a].variants[b].font,f=e.charToGlyph(d),g=1/e.unitsPerEm*c,h=(f.yMax-f.yMin)*g,i=(f.xMax-f.xMin)*g;return new GRect(f.xMin*g,-f.yMax*g,i,h)},b.prototype.getGlyphOutline=function(a,b,c,d,e,f){var g=this._types[a].variants[b],h=g.font,i=g.outlines[f],j=1/h.unitsPerEm*c;if(!i){var k=h.charToGlyph(f),l=k.getPath(0,0,h.unitsPerEm);i=new GVertexContainer,g.outlines[f]=i;for(var m=0;m<l.commands.length;m+=1){var n=l.commands[m];"M"===n.type?i.addVertex(GVertex.Command.Move,n.x,n.y):"L"===n.type?i.addVertex(GVertex.Command.Line,n.x,n.y):"C"===n.type?(i.addVertex(GVertex.Command.Curve2,n.x,n.y),i.addVertex(GVertex.Command.Curve2,n.x1,n.y1),i.addVertex(GVertex.Command.Curve2,n.x2,n.y2)):"Q"===n.type?(i.addVertex(GVertex.Command.Curve,n.x,n.y),i.addVertex(GVertex.Command.Curve,n.x1,n.y1)):"Z"===n.type&&i.addVertex(GVertex.Command.Close)}}return new GVertexTransformer(i,new GTransform(j,0,0,j,d,e))},a.GFont=b,a.ifFont=new b}(this),function(a){function b(){}b.options={epsilon:2500,bufferSize:10},b.Matcher=function(){},b.Matcher.prototype._unitedArea=null,b.Matcher.prototype._rects=null,b.Matcher.prototype.isDirty=function(a){if(this._unitedArea&&!this._unitedArea.intersectsRect(a))return!1;if(this._rects&&this._rects.length>0)for(var b=0;b<this._rects.length;++b){var c=this._rects[b];if(c.intersectsRect(a))return!0}return!1},b.Matcher.prototype.transform=function(a){if(this._unitedArea&&(this._unitedArea=a.mapRect(this._unitedArea)),this._rects&&this._rects.length>0)for(var b=0;b<this._rects.length;++b)this._rects[b]=a.mapRect(this._rects[b])},b.Matcher.prototype.clip=function(a){if(this._rects&&this._rects.length>0){this._unitedArea&&(this._unitedArea=a.intersected(this._unitedArea));for(var b=0;b<this._rects.length;++b)this._rects[b]=a.intersected(this._rects[b])}else this._unitedArea=a,this._rects=[a]},b.Matcher.prototype.getDirtyRectangles=function(){return this._rects},b.prototype._area=null,b.prototype._dirties=null,b.prototype._numDirties=0,b.prototype.setArea=function(a){this._area=a},b.prototype.getArea=function(){return this._area},b.prototype.dirty=function(a,c,d,e){var f=Math.floor(a),g=Math.floor(c);if(d=Math.ceil(a+d)-f,e=Math.ceil(c+e)-g,a=f,c=g,this._area){if(!this._area.intersectsRectXYWH(a,c,d,e))return!1;a<this._area.getX()&&(a=this._area.getX()),c<this._area.getY()&&(c=this._area.getY()),a+d>this._area.getX()+this._area.getWidth()&&(d=this._area.getX()+this._area.getWidth()-a),c+e>this._area.getY()+this._area.getHeight()&&(e=this._area.getY()+this._area.getHeight()-c)}null==this._dirties?this._dirties=new Array(b.options.bufferSize):this._numDirties==this._dirties.length&&(this._dirties.length+=b.options.bufferSize);for(var h=0;h<this._numDirties;h++){var i=this._dirties[h];if(a>=i[0]&&c>=i[1]&&a+d<=i[0]+i[2]&&c+e<=i[1]+i[3])return!1;if(a<=i[0]&&c<=i[1]&&a+d>=i[0]+i[2]&&c+e>=i[1]+i[3])this._dirties[h][2]=0,this._dirties[h][3]=0;else{if(a>=i[0]&&a<i[0]+i[2]&&c>=i[1]&&c+e<=i[1]+i[3]){d=a+d-(i[0]+i[2]),a=i[0]+i[2],h=-1;continue}if(a+d>i[0]&&a+d<=i[0]+i[2]&&c>=i[1]&&c+e<=i[1]+i[3]){d=i[0]-a,h=-1;continue}if(a>=i[0]&&a+d<=i[0]+i[2]&&c>=i[1]&&c<i[1]+i[3]){e=c+e-(i[1]+i[3]),c=i[1]+i[3],h=-1;continue}if(a>=i[0]&&a+d<=i[0]+i[2]&&c+e>i[1]&&c+e<=i[1]+i[3]){e=i[1]-c,h=-1;continue}if(this._dirties[h][0]>=a&&this._dirties[h][0]<a+d&&this._dirties[h][1]>=c&&this._dirties[h][1]+this._dirties[h][3]<=c+e){this._dirties[h][2]=this._dirties[h][2]-(a+d-this._dirties[h][0]),this._dirties[h][0]=a+d,h=-1;continue}if(this._dirties[h][0]+this._dirties[h][2]>a&&this._dirties[h][0]+this._dirties[h][2]<=a+d&&this._dirties[h][1]>=c&&this._dirties[h][1]+this._dirties[h][3]<=c+e){this._dirties[h][2]=a-this._dirties[h][0],h=-1;continue}if(this._dirties[h][0]>=a&&this._dirties[h][0]+this._dirties[h][2]<=a+d&&this._dirties[h][1]>=c&&this._dirties[h][1]<c+e){this._dirties[h][3]=this._dirties[h][3]-(c+e-this._dirties[h][1]),this._dirties[h][1]=c+e,h=-1;continue}if(this._dirties[h][0]>=a&&this._dirties[h][0]+this._dirties[h][2]<=a+d&&this._dirties[h][1]+this._dirties[h][3]>c&&this._dirties[h][1]+this._dirties[h][3]<=c+e){this._dirties[h][3]=c-this._dirties[h][1],h=-1;continue}}}for(var h=0;h<this._numDirties;h++){var i=this._dirties[h];if(d>0&&e>0&&i[2]>0&&i[3]>0&&(Math.max(a+d,i[0]+i[2])-Math.min(a,i[0]))*(Math.max(c+e,i[1]+i[3])-Math.min(c,i[1]))<d*e+i[2]*i[3]+b.options.epsilon){var j=Math.min(i[0],a),k=Math.min(i[1],c),l=Math.max(a+d,i[0]+i[2])-Math.min(i[0],a),m=Math.max(c+e,i[1]+i[3])-Math.min(i[1],c);return this._dirties[h][2]=0,this._dirties[h][3]=0,this.dirty(j,k,l,m)}}return this._dirties[this._numDirties++]=[a,c,d,e],!0},b.prototype.flush=function(){var a=null;if(this._numDirties>0){a=new b.Matcher,a._rects=new Array(this._numDirties);for(var c=0,d=0;d<this._numDirties;++d){var e=this._dirties[d];if(e&&e[2]>0&&e[3]>0){var f=new GRect(e[0],e[1],e[2],e[3]);a._rects[c++]=f,a._unitedArea=null==a._unitedArea?f:a._unitedArea.united(f)}}a._rects.length=c,0==a._rects.length&&(a=null)}return this.reset(),a},b.prototype.reset=function(){this._numDirties>0&&(this._dirties.length=b.options.bufferSize,this._numDirties=0)},b.prototype.toString=function(){return"[Object GDirtyList]"},a.GDirtyList=b}(this),function(a){function b(){var a=document.createElement("canvas");this._canvasContext=a.getContext("2d")}GObject.inherit(b,GObject),b.LineCap={Butt:"butt",Round:"round",Square:"square"},b.LineJoin={Miter:"miter",Bevel:"bevel",Round:"round"},b.BlendMode={Normal:"normal",Multiply:"multiply",Screen:"screen",Overlay:"overlay",Darken:"darken",Lighten:"lighten",ColorDodge:"color-dodge",ColorBurn:"color-burn",HardLight:"hard-light",SoftLight:"soft-light",Difference:"difference",Exclusion:"exclusion",Hue:"hue",Saturation:"saturation",Color:"color",Luminosity:"luminosity"},b.CompositeOperator={SourceOver:"source-over",SourceAtTop:"source-atop",SourceIn:"source-in",SourceOut:"source-out",DestinationOver:"destination-over",DestinationAtTop:"destination-atop",DestinationIn:"destination-in",DestinationOut:"destination-out",Copy:"copy",Xor:"xor",Lighter:"lighter",Darker:"darker"},b.RepeatMode={Both:"repeat",Horizontal:"repeat-x",Vertical:"repeat-y",None:"no-repeat"},b.createChessboard=function(a,b,c){var d=document.createElement("canvas");d.width=2*a,d.height=2*a;var e=d.getContext("2d");return e.fillStyle=b,e.fillRect(0,0,d.width,d.height),e.fillStyle=c,e.fillRect(0,0,a,a),e.fillRect(a,a,a,a),d},b.prototype._canvasContext=null,b.prototype._bitmap=null,b.prototype._transform=null,b.prototype._offset=null,b.prototype._origin=null,b.prototype._scale=null,b.prototype._areas=null,b.prototype.getWidth=function(){return this._canvasContext.canvas.width},b.prototype.getHeight=function(){return this._canvasContext.canvas.height},b.prototype.getBitmap=function(){return this._bitmap||(this._bitmap=new GBitmap(this)),this._bitmap},b.prototype.asPNGImage=function(){return this._canvasContext.canvas.toDataURL("image/png")},b.prototype.asJPEGImage=function(a){return a=a||1,this._canvasContext.canvas.toDataURL("image/jpeg",a)},b.prototype.asPNGImageBuffer=function(a){this._canvasContext.canvas.toBlob(function(b){var c=new FileReader;c.onload=function(b){a(b.target.result)},c.readAsArrayBuffer(b)},"image/png")},b.prototype.asJPEGImageBuffer=function(a,b){b=b||1,this._canvasContext.canvas.toBlob(function(b){var c=new FileReader;c.onload=function(b){a(b.target.result)},c.readAsArrayBuffer(b)},"image/jpeg",b)},b.prototype.resize=function(a,b){(a!=this._canvasContext.canvas.width||b!=this._canvasContext.canvas.height)&&(this._canvasContext.canvas.width=a,this._canvasContext.canvas.height=b)},b.prototype.getOffset=function(){return this._offset},b.prototype.setOffset=function(a){this._offset=a},b.prototype.getOrigin=function(){return this._origin},b.prototype.setOrigin=function(a){GPoint.equals(a,this._origin)||(this._origin=a,this._updateTransform())},b.prototype.getScale=function(){return this._scale},b.prototype.setScale=function(a){a!==this._scale&&(this._scale=a,this._updateTransform())},b.prototype.getTransform=function(a){var b=this._transform;if(!a){var c=this._origin.getX(),d=this._origin.getY(),e=this._scale;b=b.multiplied((new GTransform).scaled(e,e).translated(-c,-d))}return b},b.prototype.setTransform=function(a){null==a&&(a=new GTransform);var b=this._transform;return this._transform=a,this._updateTransform(),b},b.prototype.resetTransform=function(){return this.setTransform(null)},b.prototype.prepare=function(a){if(this._canvasContext.save(),this._transform=new GTransform,this._origin=new GPoint(0,0),this._scale=1,this._areas=a?a.slice():null,this._updateTransform(),a&&a.length>0){this._canvasContext.beginPath();for(var b=0;b<a.length;++b){var c=a[b],d=c.getX(),e=d+c.getWidth(),f=c.getY(),g=f+c.getHeight();d=Math.max(0,d),e=Math.min(this.getWidth(),e),f=Math.max(0,f),g=Math.min(this.getHeight(),g),this._canvasContext.moveTo(d,f),this._canvasContext.lineTo(e,f),this._canvasContext.lineTo(e,g),this._canvasContext.lineTo(d,g),this._canvasContext.lineTo(d,f),this._canvasContext.clearRect(d,f,e-d,g-f)}this._canvasContext.clip()}else this._canvasContext.clearRect(0,0,this.getWidth(),this.getHeight())},b.prototype.finish=function(){this._canvasContext.restore(),this._transform=null,this._origin=null,this._scale=null,this._areas=null},b.prototype.createCanvas=function(a,c){var d=new b,e=this.getTransform(!1).mapRect(a),f=e.getX(),g=e.getY(),h=e.getWidth(),i=e.getHeight();0>g&&(i+=g,g=0),0>f&&(h+=f,f=0),f+h>this.getWidth()&&(h=this.getWidth()-f),g+i>this.getHeight()&&(i=this.getHeight()-g);var j=this.getTransform(!1).inverted().mapRect(new GRect(f,g,h,i)),k=new GRect(j.getX()*this._scale,j.getY()*this._scale,j.getWidth()*this._scale,j.getHeight()*this._scale);d.resize(k.getWidth(),k.getHeight());var l=null;if(c&&this._areas){l=[];for(var m=0;m<this._areas.length;++m)l.push(this._areas[m].translated(-f,-g))}d.prepare(l);var n=k.getSide(GRect.Side.TOP_LEFT);return d.setOrigin(n),d.setOffset(n),d.setScale(this._scale),d},b.prototype.clear=function(){var a=this.getTransform(!1).inverted().mapRect(new GRect(0,0,this.getWidth(),this.getHeight()));this._canvasContext.clearRect(a.getX(),a.getY(),a.getWidth(),a.getHeight())},b.prototype.drawCanvas=function(a,c,d,e,f,g){var h=this._getImageSmoothingEnabled(),i=this._scale;this._setImageSmoothingEnabled(1>i),1!==a.getScale()&&this.setScale(1);var j=this.resetTransform(),k=j?j.getTranslation():new GPoint(0,0);c=0|c,d=0|d;var l=a.getOffset(),m=l?l.getX():0,n=l?l.getY():0,o=a.getWidth(),p=a.getHeight(),q=a.getScale();q=q?q:1,m+=c+k.getX()*q,n+=d+k.getY()*q,g&&this._canvasContext.clearRect(m,n,o,p),this._canvasContext.globalAlpha="number"==typeof e?e:1,this._canvasContext.globalCompositeOperation=f?f:b.CompositeOperator.SourceOver,this._canvasContext.drawImage(a._canvasContext.canvas,0,0,o,p,m,n,o,p),this.setTransform(j),this.setScale(i),this._setImageSmoothingEnabled(h)},b.prototype.createTexture=function(a,c){return c=c||b.RepeatMode.Both,a=this._convertImage(a),this._canvasContext.createPattern(a,c)},b.prototype.createPatternPaint=function(a,b){var c=null,d=null;if(a instanceof GColor)c=a;else{if(!(a instanceof GGradient))throw new Error("Unknown pattern.");var e=a.getScale();if(a instanceof GLinearGradient){var f=-a.getAngle();c=this._canvasContext.createLinearGradient(.5-Math.cos(f)/2*e,.5-Math.sin(f)/2*e,.5+Math.cos(f)/2*e,.5+Math.sin(f)/2*e)}else{if(!(a instanceof GRadialGradient))throw new Error("Unknown pattern");c=this._canvasContext.createRadialGradient(.5,.5,0,.5,.5,.5*e)}for(var g=a.getInterpolatedStops(),h=0;h<g.length;++h)c.addColorStop(g[h].position,g[h].color.toScreenCSS(g[h].opacity));b&&(d=(new GTransform).scaled(b.getWidth(),b.getHeight()).translated(b.getX(),b.getY()))}return c?{paint:c,transform:d}:void 0},b.prototype.clipRect=function(a,b,c,d){this._canvasContext.save(),this._canvasContext.beginPath(),this._canvasContext.moveTo(a,b),this._canvasContext.lineTo(a+c,b),this._canvasContext.lineTo(a+c,b+d),this._canvasContext.lineTo(a,b+d),this._canvasContext.lineTo(a,b),this._canvasContext.clip()},b.prototype.resetClip=function(){this._canvasContext.restore()},b.prototype.putVertices=function(a){if(a.rewindVertices(0)){this._canvasContext.beginPath();for(var b=new GVertex;a.readVertex(b);)switch(b.command){case GVertex.Command.Move:this._canvasContext.moveTo(b.x,b.y);break;case GVertex.Command.Line:this._canvasContext.lineTo(b.x,b.y);break;case GVertex.Command.Curve:var c=b.x,d=b.y;a.readVertex(b)&&this._canvasContext.quadraticCurveTo(b.x,b.y,c,d);break;case GVertex.Command.Curve2:var c=b.x,d=b.y;if(a.readVertex(b)){var e=b.x,f=b.y;a.readVertex(b)&&this._canvasContext.bezierCurveTo(e,f,b.x,b.y,c,d)}break;case GVertex.Command.Close:this._canvasContext.closePath();break;default:throw new Error("Unknown Command Type - "+b.command)}}},b.prototype.strokeVertices=function(a,c,d,e,f,g,h){this._canvasContext.strokeStyle=this._convertStyle(a),this._canvasContext.lineWidth="number"==typeof c?c:1,this._canvasContext.lineCap=d?d:"butt",this._canvasContext.lineJoin=e?e:"miter",this._canvasContext.miterLimit="number"==typeof f?f:10,this._canvasContext.globalAlpha="number"==typeof g?g:1,this._canvasContext.globalCompositeOperation=h?h:b.CompositeOperator.SourceOver,this._canvasContext.stroke()},b.prototype.fillVertices=function(a,c,d,e){this._canvasContext.fillStyle=this._convertStyle(a),this._canvasContext.globalAlpha="number"==typeof c?c:1,this._canvasContext.globalCompositeOperation=d?d:b.CompositeOperator.SourceOver,this._canvasContext.fill(e?"evenodd":"nonzero")},b.prototype.fillCanvas=function(a,b,c){var d=this.getTransform(!1).inverted().mapRect(new GRect(0,0,this.getWidth(),this.getHeight()));this.fillRect(d.getX(),d.getY(),d.getWidth(),d.getHeight(),a,b,c)},b.prototype.fillRect=function(a,c,d,e,f,g,h){f=this._convertStyle(f?f:GRGBColor.BLACK),this._canvasContext.globalCompositeOperation=h?h:b.CompositeOperator.SourceOver,this._canvasContext.globalAlpha="number"==typeof g?g:1,this._canvasContext.fillStyle=f,this._canvasContext.fillRect(a,c,d,e)},b.prototype.strokeRect=function(a,c,d,e,f,g,h,i){g=this._convertStyle(g?g:GRGBColor.BLACK),f=f||1,this._canvasContext.globalCompositeOperation=i?i:b.CompositeOperator.SourceOver,this._canvasContext.globalAlpha="number"==typeof h?h:1,this._canvasContext.strokeStyle=g,this._canvasContext.lineWidth=f,this._canvasContext.strokeRect(a,c,d,e)},b.prototype.strokeLine=function(a,c,d,e,f,g){g=this._convertStyle(g?g:GRGBColor.BLACK),f=f||1,this._canvasContext.globalCompositeOperation=b.CompositeOperator.SourceOver,this._canvasContext.globalAlpha=1,this._canvasContext.strokeStyle=g,this._canvasContext.lineWidth=f,this._canvasContext.beginPath(),this._canvasContext.moveTo(a,c),this._canvasContext.lineTo(d,e),this._canvasContext.stroke()},b.prototype.drawImage=function(a,c,d,e,f,g){c=c||0,d=d||0,a=this._convertImage(a),this._canvasContext.globalAlpha="number"==typeof f?f:1,this._canvasContext.globalCompositeOperation=g?g:b.CompositeOperator.SourceOver;var h=this._getImageSmoothingEnabled();this._setImageSmoothingEnabled(!e),this._canvasContext.drawImage(a,c?c:0,d?d:0),this._setImageSmoothingEnabled(h)},b.prototype._updateTransform=function(){var a=this.getTransform(!1).getMatrix();this._canvasContext.setTransform(a[0],a[1],a[2],a[3],a[4],a[5])},b.prototype._convertStyle=function(a){if(a instanceof CanvasPattern||a instanceof CanvasGradient)return a;if(a instanceof GColor)return GColor.rgbToHtmlHex(a.toScreen());throw new Error("Not Supported.")},b.prototype._convertImage=function(a){if(a instanceof HTMLImageElement||a instanceof Image||a instanceof HTMLCanvasElement)return a;if(a instanceof b)return a._canvasContext.canvas;throw new Error("Not Supported.")};var c=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled"];b.prototype._getImageSmoothingEnabled=function(){for(var a=0;a<c.length;++a)if(this._canvasContext.hasOwnProperty(c[a]))return this._canvasContext[c[a]]},b.prototype._setImageSmoothingEnabled=function(a){for(var b=0;b<c.length;++b)if(this._canvasContext.hasOwnProperty(c[b]))return void(this._canvasContext[c[b]]=a)},a.GPaintCanvas=b}(this),function(a){function b(){}b.prototype.toString=function(){return"[Object GPaintConfiguration]"},a.GPaintConfiguration=b}(this),function(a){function b(){this.outlineColors=[],this.canvasStack=[]}b.prototype.configuration=null,b.prototype.canvas=null,b.prototype.canvasStack=null,b.prototype.dirtyMatcher=null,b.prototype.outlineColors=null,b.prototype.selectionOutlineColor=new GRGBColor([0,168,255]),b.prototype.highlightOutlineColor=new GRGBColor([255,0,0]),b.prototype.guideOutlineColor=new GRGBColor([46,204,64]),b.prototype.isOutline=function(){return this.outlineColors&&this.outlineColors.length>0},b.prototype.getOutlineColor=function(){return this.outlineColors&&this.outlineColors.length>0?this.outlineColors[this.outlineColors.length-1]:GRGBColor.BLACK},b.prototype.getRootCanvas=function(){return this.canvasStack.length>0?this.canvasStack[0]:this.canvas},b.prototype.pushCanvas=function(a){var b=this.canvas;return this.canvasStack.push(this.canvas),this.canvas=a,b},b.prototype.popCanvas=function(){if(this.canvasStack.length<=0)throw new Error("Invalid call, stack length is zero.");this.canvas=this.canvasStack.pop()},b.prototype.toString=function(){return"[Object GPaintContext]"},a.GPaintContext=b}(this),function(a){function b(){}GObject.inherit(b,GObject),b.MIME_TYPE="application/infinity+node",b.inherit=function(a,c,d){GObject.inherit(c,d),b._registerNodeClass(a,c)},b.inheritAndMix=function(a,c,d,e){GObject.inheritAndMix(c,d,e),b._registerNodeClass(a,c)},b.getName=function(a){return b._nodeClassToNameMap[GObject.getTypeId(a)]},b.store=function(a){if(a.hasMixin(b.Store)){var c={"@":b._nodeClassToNameMap[GObject.getTypeId(a)]};if(a._notifyChange(b._Change.PrepareStore,c),a.hasMixin(b.Container))for(var d=a.getFirstChild();null!==d;d=d.getNext()){var e=b.store(d);e&&(c.hasOwnProperty("$")?c.$.push(e):c.$=[e])}if(a.hasMixin(b.Properties))for(var f in a)a.hasOwnProperty(f)&&f.length>1&&"@"===f.charAt(0)&&(c[f]=a[f]);return a.hasMixin(b.Reference)&&a._referenceId&&(c["#"]=a._referenceId),a._notifyChange(b._Change.Store,c),c}return null},b.restore=function(a){if(!a||!a.hasOwnProperty("@"))return null;var c=b._nameToNodeClassMap[a["@"]];if(!c)return null;var d=new c;return b.restoreInstance(a,d),d},b.restoreInstance=function(a,c){if(c._notifyChange(b._Change.PrepareRestore,a),a.hasOwnProperty("$")&&c.hasMixin(b.Container)){var d=a.$;if(d.length>0)for(var e=0;e<d.length;++e){var f=b.restore(d[e]);f&&c.appendChild(f)}}if(c.hasMixin(b.Properties))for(var g in a)a.hasOwnProperty(g)&&g.length>1&&"@"===g.charAt(0)&&(c[g]=a[g]);c.hasMixin(b.Reference)&&a.hasOwnProperty("#")&&(c._referenceId=a["#"]),c._notifyChange(b._Change.Restore,a)},b.serialize=function(a,c){if(a instanceof Array){for(var d=[],e=0;e<a.length;++e){var f=b.store(a[e]);f&&d.push(f)}if(d.length>0)return JSON.stringify(d,null,c?4:null)}else{var f=b.store(a);if(f)return JSON.stringify(f,null,c?4:null)}return null},b.deserialize=function(a){if(a){var c=JSON.parse(a);if(c&&c instanceof Array){for(var d=[],e=0;e<c.length;++e){var f=b.restore(c[e]);f&&d.push(f)}return d&&d.length>0?d:null}return b.restore(c)}return null},b.order=function(a){return a.slice()},b._nodeClassToNameMap={},b._nameToNodeClassMap={},b._registerNodeClass=function(a,c){b._nodeClassToNameMap[GObject.getTypeId(c)]=a,b._nameToNodeClassMap[a]=c},b.Flag={Selected:2,Highlighted:4,Active:8,Expanded:16},b._Change={BeforeChildInsert:1,AfterChildInsert:2,BeforeChildRemove:10,AfterChildRemove:11,BeforePropertiesChange:20,AfterPropertiesChange:21,BeforeFlagChange:30,AfterFlagChange:31,PrepareStore:40,Store:41,PrepareRestore:42,Restore:43,Attached:50,Detach:51},b.BeforeInsertEvent=function(a){this.node=a},GObject.inherit(b.BeforeInsertEvent,GEvent),b.BeforeInsertEvent.prototype.node=null,b.BeforeInsertEvent.prototype.toString=function(){return"[Event GNode.BeforeInsertEvent]"},b.AfterInsertEvent=function(a){this.node=a},GObject.inherit(b.AfterInsertEvent,GEvent),b.AfterInsertEvent.prototype.node=null,b.AfterInsertEvent.prototype.toString=function(){return"[Event GNode.AfterInsertEvent]"},b.BeforeRemoveEvent=function(a){this.node=a},GObject.inherit(b.BeforeRemoveEvent,GEvent),b.BeforeRemoveEvent.prototype.node=null,b.BeforeRemoveEvent.prototype.toString=function(){return"[Event GNode.BeforeRemoveEvent]"},b.AfterRemoveEvent=function(a){this.node=a},GObject.inherit(b.AfterRemoveEvent,GEvent),b.AfterRemoveEvent.prototype.node=null,b.AfterRemoveEvent.prototype.toString=function(){return"[Event GNode.AfterRemoveEvent]"},b.BeforePropertiesChangeEvent=function(a,b,c){this.node=a,this.properties=b,this.values=c},GObject.inherit(b.BeforePropertiesChangeEvent,GEvent),b.BeforePropertiesChangeEvent.prototype.node=null,b.BeforePropertiesChangeEvent.prototype.properties=null,b.BeforePropertiesChangeEvent.prototype.values=null,b.BeforePropertiesChangeEvent.prototype.toString=function(){return"[Event GNode.BeforePropertiesChangeEvent]"},b.AfterPropertiesChangeEvent=function(a,b,c){this.node=a,this.properties=b,this.values=c},GObject.inherit(b.AfterPropertiesChangeEvent,GEvent),b.AfterPropertiesChangeEvent.prototype.node=null,b.AfterPropertiesChangeEvent.prototype.properties=null,b.AfterPropertiesChangeEvent.prototype.values=null,b.AfterPropertiesChangeEvent.prototype.toString=function(){return"[Event GNode.AfterPropertiesChangeEvent]"},b.BeforeFlagChangeEvent=function(a,b,c){this.node=a,this.flag=b,this.set=c},GObject.inherit(b.BeforeFlagChangeEvent,GEvent),b.BeforeFlagChangeEvent.prototype.node=null,b.BeforeFlagChangeEvent.prototype.flag=null,b.BeforeFlagChangeEvent.prototype.set=null,b.BeforeFlagChangeEvent.prototype.toString=function(){return"[Event GNode.BeforeFlagChangeEvent]"},b.AfterFlagChangeEvent=function(a,b,c){this.node=a,this.flag=b,this.set=c},GObject.inherit(b.AfterFlagChangeEvent,GEvent),b.AfterFlagChangeEvent.prototype.node=null,b.AfterFlagChangeEvent.prototype.flag=null,b.AfterFlagChangeEvent.prototype.set=null,b.AfterFlagChangeEvent.prototype.toString=function(){return"[Event GNode.AfterFlagChangeEvent]"},b.Properties=function(){},b.Properties.prototype.arePropertiesEqual=function(a,b,c){for(var d=0;d<b.length;++d){var e=b[d],f=this.hasProperty(e,c),g=a.hasProperty(e,c);if(f){if(!g)return!1;if(!GUtil.equals(this.getProperty(e,c),a.getProperty(e,c)))return!1}else if(g)return!1}return!0},b.Properties.prototype.hasProperty=function(a,b){var c=(b?"@":"$")+a;return this.hasOwnProperty(c)},b.Properties.prototype.getProperty=function(a,b,c){var d=(b?"@":"$")+a;return this.hasOwnProperty(d)?this[d]:c},b.Properties.prototype.getProperties=function(a,b,c){for(var d=[],e=0;e<a.length;++e){var f=c&&c.length>e?c[e]:null;d.push(this.getProperty(a[e],b,f))}return d},b.Properties.prototype.setProperty=function(a,b,c,d){return this.setProperties([a],[b],c,d)},b.Properties.prototype.setProperties=function(a,c,d,e){if(a.length!==c.length)throw new Error("Properties length does not match values length");for(var f=[],g=[],h=0;h<a.length;++h){var i=c[h],j=(d?"@":"$")+a[h],k=this[j];(e||!GUtil.equals(i,k,!1))&&(f.push(a[h]),g.push(c[h]))}if(0===f.length)return!1;this._notifyChange(b._Change.BeforePropertiesChange,{properties:f,values:g});for(var l=[],h=0;h<f.length;++h){var j=(d?"@":"$")+f[h];l.push(this[j]),this[j]=g[h]}return this._notifyChange(b._Change.AfterPropertiesChange,{properties:f,values:l}),!0},b.Properties.prototype.storeProperties=function(a,b,c){c=c||function(a,b){return b};for(var d in b){var e=b[d],f=this["$"+d];if(!GUtil.equals(f,e,!0)){var g=c(d,f);a[d]=g}}},b.Properties.prototype.restoreProperties=function(a,b,c){c=c||function(a,b){return b};var d=[],e=[];for(var f in b)d.push(f),e.push(a.hasOwnProperty(f)?c(f,a[f]):b[f]);this.setProperties(d,e,!1)},b.Properties.prototype.transferProperties=function(a,b){for(var c=[],d=[],e=0;e<b.length;++e)for(var f in b[e])c.push(f),d.push(a.hasProperty(f)?a.getProperty(f):b[e][f]);this.setProperties(c,d,!1)},b.Properties.prototype._setDefaultProperties=function(){for(var a=0;a<arguments.length;++a){var b=arguments[a];for(var c in b)this["$"+c]=b[c]}},b.Identity=function(){},b.Identity.prototype.getId=function(){throw new Error("Not Supported.")},b.Tag=function(){},b.Tag.prototype.getTags=function(){throw new Error("Not Supported.")},b.Reference=function(){},b.Reference.prototype._referenceId=null,b.Reference.prototype.getReferenceId=function(){return this._referenceId||(this._referenceId=GUtil.uuid()),this._referenceId},b.Container=function(){},b.Container.prototype._firstChild=null,b.Container.prototype._lastChild=null,b.Container.prototype.getChildren=function(){for(var a=[],b=this.getFirstChild();null!==b;b=b.getNext())a.push(b);return a},b.Container.prototype.getFirstChild=function(){return this._firstChild},b.Container.prototype.getLastChild=function(){return this._lastChild},b.Container.prototype.appendChild=function(a){this.insertChild(a,null)},b.Container.prototype.insertChild=function(a,c){if(null!=a._scene)throw new Error("Child is already appended somewhere else");if(null!=c&&c.getParent()!=this)throw new Error("Reference is not a child of this node");if(!a.validateInsertion(this,c))throw new Error("Child insertion validation failed.");if(this._notifyChange(b._Change.BeforeChildInsert,a),a._setParent(this),null!=c?(a._setNext(c),a._setPrevious(c._previous),c._setPrevious(a),null==a._previous?this._firstChild=a:a._previous._setNext(a)):(null!=this._lastChild&&(a._setPrevious(this._lastChild),this._lastChild._setNext(a),this._lastChild=a),a._setNext(null)),null==this._firstChild&&(this._firstChild=a,a._setPrevious(null),a._setNext(null)),null==a._next&&(this._lastChild=a),this.isAttached()){var d=this;a.accept&&a.accept(function(a){a._setScene(d._scene)},!0)}this._notifyChange(b._Change.AfterChildInsert,a)},b.Container.prototype.removeChild=function(a){if(a._parent!=this)throw new Error("Child is not a child of this node");if(!a.validateRemoval())throw new Error("Child removal validation failed.");this._notifyChange(b._Change.BeforeChildRemove,a),this._firstChild==a&&(this._firstChild=a._next),this._lastChild==a&&(this._lastChild=a._previous),null!=a._previous&&a._previous._setNext(a._next),null!=a._next&&a._next._setPrevious(a._previous),a._setParent(null),a._setPrevious(null),a._setNext(null),this.isAttached()&&a.accept&&a.accept(function(a){a._setScene(null)},!0),this._notifyChange(b._Change.AfterChildRemove,a)},b.Container.prototype.clearChildren=function(){for(;this.getFirstChild();)this.removeChild(this.getFirstChild())},b.Container.prototype.getIndexOfChild=function(a){if(a._parent===this)for(var b=0,c=this.getFirstChild();null!==c;c=c.getNext()){if(c===a)return b;b++}return-1},b.Container.prototype.getChildByIndex=function(a){for(var b=0,c=this.getFirstChild();null!==c;c=c.getNext()){if(b===a)return c;b++}return null},b.Container.prototype.acceptChildren=function(a){for(var b=this.getFirstChild();null!=b;b=b.getNext())if(b.accept(a)===!1)return!1;return!0},b.Container.prototype.toString=function(){return"[Mixin GNode.Container]"},b.Store=function(){},b.Store.prototype.clone=function(){var a=b.serialize(this);if(a){var c=b.deserialize(a);return c.hasMixin(b.Reference)&&(c._referenceId=null),c}return null},b.prototype._scene=null,b.prototype._parent=null,b.prototype._previous=null,b.prototype._next=null,b.prototype._flags=0,b.prototype.getNodeName=function(){return b.getName(this)},b.prototype.getNodeNameTranslated=function(){return ifLocale.getValue(this,"name",this.getNodeName())},b.prototype.isAttached=function(){return null!=this._scene},b.prototype.getScene=function(){return this._scene},b.prototype.getParent=function(){return this._parent},b.prototype.getPrevious=function(){return this._previous},b.prototype.getNext=function(){return this._next},b.prototype.getNodesByName=function(a){var b=[];return this.accept(function(c){a&&"*"!=a&&a!==c.getNodeName()||c!==this&&b.push(c)}.bind(this)),b},b.prototype.queryCount=function(a){var b=GSelector.queryAll(a,this);return b?b.length:0},b.prototype.queryAll=function(a){return GSelector.queryAll(a,this)},b.prototype.querySingle=function(a){var b=GSelector.querySingle(a,this);return b?b:null},b.prototype.matches=function(a){return GSelector.match(a,this)},b.prototype.filtered=function(a){return 1===GSelector.filter(a,[this]).length},b.prototype.accept=function(a){return a.call(null,this)===!1?!1:this.hasMixin(b.Container)?this.acceptChildren(a):!0},b.prototype.hasFlag=function(a){return 0!=(this._flags&a)},b.prototype.setFlag=function(a){this._canModifyFlag(a,!0)&&0==(this._flags&a)&&(this._notifyChange(b._Change.BeforeFlagChange,{flag:a,set:!0}),this._flags=this._flags|a,this._notifyChange(b._Change.AfterFlagChange,{flag:a,set:!0}))},b.prototype.removeFlag=function(a){this._canModifyFlag(a,!1)&&0!=(this._flags&a)&&(this._notifyChange(b._Change.BeforeFlagChange,{flag:a,set:!1}),this._flags=this._flags&~a,this._notifyChange(b._Change.AfterFlagChange,{flag:a,set:!1}))
},b.prototype.assignFrom=function(a){this.hasMixin(b.Reference)&&a.hasMixin(b.Reference)&&(this._referenceId=a._referenceId)},b.prototype.validateInsertion=function(){return!1},b.prototype.validateRemoval=function(){return!0},b.prototype._canModifyFlag=function(){return!0},b.prototype._beginBlockChanges=function(a){this._blockedChanges||(this._blockedChanges={},this._blockedChanges._counter=0);for(var b=0;b<a.length;++b){var c=a[b];c in this._blockedChanges?this._blockedChanges[c]++:this._blockedChanges[c]=1,this._blockedChanges._counter++}},b.prototype._endBlockChanges=function(a){if(this._blockedChanges)for(var b=0;b<a.length;++b){var c=a[b];c in this._blockedChanges&&0==--this._blockedChanges[c]&&0==--this._blockedChanges._counter&&delete this._blockedChanges}},b.prototype._beginBlockEvents=function(a){this._blockedEvents||(this._blockedEvents={},this._blockedEvents._counter=0);for(var b=0;b<a.length;++b){var c=GObject.getTypeId(a[b]);c in this._blockedEvents?this._blockedEvents[c]++:this._blockedEvents[c]=1,this._blockedEvents._counter++}},b.prototype._endBlockEvents=function(a){if(this._blockedEvents)for(var b=0;b<a.length;++b){var c=GObject.getTypeId(a[b]);c in this._blockedEvents&&0==--this._blockedEvents[c]&&0==--this._blockedEvents._counter&&delete this._blockedEvents}},b.prototype._getCompositeEvents=function(a,c,d){var e=[];return a&&(e=e.concat([b.BeforeInsertEvent,b.AfterInsertEvent,b.BeforeRemoveEvent,b.AfterRemoveEvent])),c&&(e=e.concat([b.BeforePropertiesChangeEvent,b.AfterPropertiesChangeEvent])),d&&(e=e.concat([b.BeforeFlagChangeEvent,b.AfterFlagChangeEvent])),e},b.prototype._beginBlockCompositeEvents=function(a,b,c){this._beginBlockEvents(this._getCompositeEvents(a,b,c))},b.prototype._endBlockCompositeEvents=function(a,b,c){this._endBlockEvents(this._getCompositeEvents(a,b,c))},b.prototype._notifyChange=function(a,b){return this._blockedChanges&&this._blockedChanges[a]?!1:(this._handleChange(a,b),!0)},b.prototype._canEventBeSend=function(a){if(!this.isAttached())return!1;if(!this._scene.hasEventListeners(a))return!1;var b=GObject.getTypeId(a);return!this._blockedEvents||!this._blockedEvents[b]},b.prototype._setSceneToChildren=function(){if(this.hasMixin(b.Container))for(var a=this._scene,c=this.getFirstChild();null!==c;c=c.getNext())c.accept&&c.accept(function(b){b._setScene(a)},!0)},b.prototype._setScene=function(a){a!==this._scene&&(this._scene&&(this._notifyChange(b._Change.Detach),this.hasMixin(b.Reference)&&this._scene.removeReference(this),this._scene=null,this._setSceneToChildren()),this._scene=a,this._scene&&(this.hasMixin(b.Reference)&&this._scene.addReference(this),this._setSceneToChildren(),this._notifyChange(b._Change.Attached)))},b.prototype._setParent=function(a){this._parent=a},b.prototype._setPrevious=function(a){this._previous=a},b.prototype._setNext=function(a){this._next=a},b.prototype._handleChange=function(a,c){if(a==b._Change.BeforeChildInsert){var d=c;this._canEventBeSend(b.BeforeInsertEvent)&&this._scene.trigger(new b.BeforeInsertEvent(d))}else if(a==b._Change.AfterChildInsert){var d=c;this._canEventBeSend(b.AfterInsertEvent)&&this._scene.trigger(new b.AfterInsertEvent(d))}else if(a==b._Change.BeforeChildRemove){var d=c;this._canEventBeSend(b.BeforeRemoveEvent)&&this._scene.trigger(new b.BeforeRemoveEvent(d))}else if(a==b._Change.AfterChildRemove){var d=c;this._canEventBeSend(b.AfterRemoveEvent)&&this._scene.trigger(new b.AfterRemoveEvent(d))}else if(a==b._Change.BeforePropertiesChange){var e=c;this._canEventBeSend(b.BeforePropertiesChangeEvent)&&this._scene.trigger(new b.BeforePropertiesChangeEvent(this,e.properties,e.values))}else if(a==b._Change.AfterPropertiesChange){var e=c;this._canEventBeSend(b.AfterPropertiesChangeEvent)&&this._scene.trigger(new b.AfterPropertiesChangeEvent(this,e.properties,e.values))}else if(a==b._Change.BeforeFlagChange){var f=c;this._canEventBeSend(b.BeforeFlagChangeEvent)&&this._scene.trigger(new b.BeforeFlagChangeEvent(this,f.flag,f.set))}else if(a==b._Change.AfterFlagChange){var f=c;this._canEventBeSend(b.AfterFlagChangeEvent)&&this._scene.trigger(new b.AfterFlagChangeEvent(this,f.flag,f.set))}},a.GNode=b}(this),function(a){GStylable=function(){},GObject.inherit(GStylable,GObject),GStylable._effects=null,GStylable.StyleLayer={Fill:"F",Border:"B"},GStylable.StyleLayerName={"":new GLocale.Key(GStylable,"layer.element"),F:new GLocale.Key(GStylable,"layer.fill"),B:new GLocale.Key(GStylable,"layer.border")},GStylable.StyleLayer={Fill:"F",Border:"B"},GStylable.BorderAlignment={Center:"C",Outside:"O",Inside:"I"},GStylable.ParagraphAlignment={Left:"l",Center:"c",Right:"r",Justify:"j"},GStylable.ParagraphWrapMode={None:"n",Words:"w",All:"a"},GStylable.PropertySet={Style:"S",Effects:"E",Fill:"F",Border:"B",Text:"T",Paragraph:"P"},GStylable.PropertySetInfo={S:{visualProperties:{_sdf:null,_sbl:GPaintCanvas.BlendMode.Normal,_sfop:1,_stop:1}},E:{},F:{visualProperties:{_fpt:null,_fop:1},geometryProperties:{_fpx:null},storeFilter:function(a,b){if(b){if("_fpt"===a)return GPattern.serialize(b);if("_fpx"===a)return GTransform.serialize(b)}return b},restoreFilter:function(a,b){if(b){if("_fpt"===a)return GPattern.deserialize(b);if("_fpx"===a)return GTransform.deserialize(b)}return b}},B:{visualProperties:{_bop:1},geometryProperties:{_bpt:null,_bpx:null,_bw:1,_ba:GStylable.BorderAlignment.Center,_blc:GPaintCanvas.LineCap.Square,_blj:GPaintCanvas.LineJoin.Miter,_bml:3},storeFilter:function(a,b){if(b){if("_bpt"===a)return GPattern.serialize(b);if("_bpx"===a)return GTransform.serialize(b)}return b},restoreFilter:function(a,b){if(b){if("_bpt"===a)return GPattern.deserialize(b);if("_bpx"===a)return GTransform.deserialize(b)}return b}},T:{geometryProperties:{_tff:"Open Sans",_tfi:20,_tfw:GFont.Weight.Regular,_tfs:GFont.Style.Normal,_tcs:null,_tws:null}},P:{geometryProperties:{_pcc:null,_pcg:null,_pwm:GStylable.ParagraphWrapMode.Words,_pal:null,_pin:null,_plh:1}}},GStylable.AllVisualProperties={},GStylable.AllGeometryProperties={};for(var b in GStylable.PropertySetInfo){var c=GStylable.PropertySetInfo[b];if(c.visualProperties)for(var d in c.visualProperties)GStylable.AllVisualProperties[d]=c.visualProperties[d];if(c.geometryProperties)for(var d in c.geometryProperties)GStylable.AllGeometryProperties[d]=c.geometryProperties[d]}GStylable.Effects=function(){},GNode.inheritAndMix("effects",GStylable.Effects,GNode,[GNode.Container,GNode.Store]),GStylable.Effects.prototype.getLayersEffects=function(a,b){if(a&&a.length){for(var c=[],d=0;d<=a.length;++d){var e=d<a.length?a[d]:null;c.push(this.getEffectsForLayer(e,b))}return c}return[this.getEffectsForLayer(null,b)]},GStylable.Effects.prototype.getEffectsForLayer=function(a,b){a=a||null;for(var c=null,d=this.getFirstChild();null!==d;d=d.getNext())if(d instanceof GEffect){var e=d.getProperty("ly");if(b&&d.getProperty("vs")===!1)continue;e===a&&(c||(c=[]),c.push(d))}return c},GStylable.Effects.prototype.insertChild=function(a,b){if(a instanceof GEffect&&a.getEffectType()===GEffect.Type.PreEffect)for(var c=b?b:this.getLastChild();null!==c;c=c.getPrevious())if(c instanceof GEffect){if(c.getEffectType()===GEffect.Type.PreEffect){b=c.getNext();break}c.getEffectType()===GEffect.Type.PostEffect&&(b=c)}GNode.Container.prototype.insertChild.call(this,a,b)},GStylable.Effects.prototype._handleChange=function(a,b){var c=this.getParent();c&&c.hasMixin(GStylable)&&((a==GNode._Change.BeforeChildInsert||a===GNode._Change.BeforeChildRemove)&&b instanceof GEffect&&c._stylePrepareGeometryChange(!0),(a==GNode._Change.AfterChildInsert||a===GNode._Change.AfterChildRemove)&&b instanceof GEffect&&c._styleFinishGeometryChange(!0)),GNode.prototype._handleChange.call(this,a,b)},GStylable.Effects.prototype.getEffectsBBox=function(a,b){var c=this.getEffectsPadding(b);return c?a.expanded(c[0],c[1],c[2],c[3]):a},GStylable.Effects.prototype.getEffectsPadding=function(a){var b=this.getEffectsForLayer(a,!0);if(!b)return null;for(var c=[0,0,0,0],d=[0,0,0,0],e=null,f=0;f<b.length;++f){var g=b[f],h=g.getEffectPadding();if(h){switch(h instanceof Array||(h=[h,h,h,h]),g.getEffectType()){case GEffect.Type.PreEffect:case GEffect.Type.PostEffect:d=[Math.max(d[0],h[0]),Math.max(d[1],h[1]),Math.max(d[2],h[2]),Math.max(d[3],h[3])];break;case GEffect.Type.Filter:e&&e.getEffectType()!==GEffect.Type.Filter&&(c=[c[0]+d[0],c[1]+d[1],c[2]+d[2],c[3]+d[3]],d=[0,0,0,0]),c=[c[0]+h[0],c[1]+h[1],c[2]+h[2],c[3]+h[3]]}e=g}}return e&&e.getEffectType()!==GEffect.Type.Filter&&(c=[c[0]+d[0],c[1]+d[1],c[2]+d[2],c[3]+d[3]]),c},GStylable.prototype.getStylePropertySets=function(){return[GStylable.PropertySet.Style,GStylable.PropertySet.Effects]},GStylable.prototype.getEffects=function(){return this.getStylePropertySets().indexOf(GStylable.PropertySet.Effects)>=0?(this._effects||(this._effects=new GStylable.Effects,this._effects._parent=this,this._effects._setScene(this._scene)),this._effects):void 0},GStylable.prototype.assignStyleFrom=function(a,b){for(var c=a.getStylePropertySets(),d=this.getStylePropertySets(),e=b?b.getStylePropertySets():null,f=[],g=0;g<c.length;++g)for(var h=c[g],i=0;i<d.length;++i)if(d[i]===h){f.push(h);break}if(f.length>0){if(f.indexOf(GStylable.PropertySet.Effects)>=0){var j=this.getEffects(),k=a.getEffects(),l=!1;j._beginBlockChanges([GNode._Change.BeforeChildRemove,GNode._Change.AfterChildRemove,GNode._Change.BeforeChildInsert,GNode._Change.AfterChildInsert]);try{if(b&&e.indexOf(GStylable.PropertySet.Effects))for(var m=b.getEffects(),n=0,o=k.getFirstChild();null!==o;o=o.getNext()){var p=j.getChildByIndex(n),q=m.getChildByIndex(n);p&&q&&GUtil.equals(p,q)&&(l||(this._stylePrepareGeometryChange(!0),l=!0),j.insertChild(o.clone(),p),j.removeChild(p)),n++}else{if(j.getFirstChild())for(l||(this._stylePrepareGeometryChange(!0),l=!0);j.getFirstChild();)j.removeChild(j.getFirstChild());for(var o=k.getFirstChild();null!==o;o=o.getNext())l||(this._stylePrepareGeometryChange(!0),l=!0),j.appendChild(o.clone())}}finally{j._endBlockChanges([GNode._Change.BeforeChildRemove,GNode._Change.AfterChildRemove,GNode._Change.BeforeChildInsert,GNode._Change.AfterChildInsert]),l&&this._styleFinishGeometryChange(!0)}}for(var r=[],s=0;s<f.length;++s){var t=GStylable.PropertySetInfo[f[s]],u=[];t.visualProperties&&(u=u.concat(Object.keys(t.visualProperties))),t.geometryProperties&&(u=u.concat(Object.keys(t.geometryProperties)));for(var g=0;g<u.length;++g){var v=u[g],w=!0;if(b&&e.indexOf(t)>=0){var x=this.getProperty(v),y=b.getProperty(v),z=a.getProperty(v);w=b.hasProperty(v)&&(GUtil.equals(x,y)||GUtil.equals(x,z))}w&&"_sdf"!==v&&r.push(v)}}if(r.length>0){var A=a.getProperties(r);this.setProperties(r,A,!1,!0)}}},GStylable.prototype.hasStyleBorder=function(){return!!this.$_bpt&&this.$_bw>0&&this.$_bop>0},GStylable.prototype.hasStyleFill=function(){return!!this.$_fpt&&this.$_fop>0},GStylable.prototype.getStyleBorderPadding=function(){return this.$_ba===GStylable.BorderAlignment.Center?this.$_bw/2:this.$_ba===GStylable.BorderAlignment.Outside?this.$_bw:0},GStylable.prototype._setStyleDefaultProperties=function(){for(var a=this.getStylePropertySets(),b=0;b<a.length;++b){var c=GStylable.PropertySetInfo[a[b]];c.visualProperties&&this._setDefaultProperties(c.visualProperties),c.geometryProperties&&this._setDefaultProperties(c.geometryProperties)}},GStylable.prototype._handleStyleChange=function(a,b){if(a===GNode._Change.BeforePropertiesChange||a===GNode._Change.AfterPropertiesChange){for(var c=!1,d=!1,e=0;e<b.properties.length;++e){var f=b.properties[e];if(GStylable.AllGeometryProperties.hasOwnProperty(f)){d=!0,a===GNode._Change.BeforePropertiesChange?this._stylePrepareGeometryChange():(this._styleFinishGeometryChange(),this._stylePropertiesUpdated(b.properties,b.values));break}GStylable.AllVisualProperties.hasOwnProperty(f)&&a===GNode._Change.AfterPropertiesChange&&(c=!0)}!d&&c&&(this._styleRepaint(),this._stylePropertiesUpdated(b.properties,b.values))}else if(a===GNode._Change.Store)for(var g=this.getStylePropertySets(),h=0;h<g.length;++h){var i=g[h];if(i===GStylable.PropertySet.Effects)this._effects&&(b._eff=GNode.store(this._effects));else{var j=GStylable.PropertySetInfo[i];j.visualProperties&&this.storeProperties(b,j.visualProperties,j.storeFilter),j.geometryProperties&&this.storeProperties(b,j.geometryProperties,j.storeFilter)}}else if(a===GNode._Change.Restore)for(var g=this.getStylePropertySets(),h=0;h<g.length;++h){var i=g[h];if(i===GStylable.PropertySet.Effects)b._eff&&(this._effects=GNode.restore(b._eff),this._effects._parent=this,this._effects._setScene(this._scene));else{var j=GStylable.PropertySetInfo[i];j.visualProperties&&this.restoreProperties(b,j.visualProperties,j.restoreFilter),j.geometryProperties&&this.restoreProperties(b,j.geometryProperties,j.restoreFilter)}}else a===GNode._Change.Attached?this._effects&&this._effects._setScene(this._scene):a===GNode._Change.Detach&&this._effects&&this._effects._setScene(null)},GStylable.prototype._stylePrepareGeometryChange=function(){},GStylable.prototype._styleFinishGeometryChange=function(){},GStylable.prototype._styleRepaint=function(){},GStylable.prototype._stylePropertiesUpdated=function(){},GStylable.prototype.toString=function(){return"[Mixin GStylable]"},a.GStylable=GStylable}(this),function(a){function b(){this.hasMixin(b.Stylable)&&this._setStyleDefaultProperties()}GObject.inherit(b,GNode),b.Flag={Hidden:1<<21,Locked:1<<22,NoPaint:1<<23},b.CollisionFlag={Partial:1,GeometryBBox:1024,PaintBBox:2048},b._Change={ChildGeometryUpdate:200,PrepareGeometryUpdate:220,FinishGeometryUpdate:221,InvalidationRequest:230,InvalidationRequested:231},b.GeometryChangeEvent=function(a,b){this.element=a,this.type=b},GObject.inherit(b.GeometryChangeEvent,GEvent),b.GeometryChangeEvent.Type={Before:0,After:1,Child:2},b.GeometryChangeEvent.prototype.element=null,b.GeometryChangeEvent.prototype.type=null,b.GeometryChangeEvent.prototype.toString=function(){return"[Event GElement.GeometryChangeEvent]"},b.HitResultInfo=function(a,b){this.element=a,this.data=b},b.HitResultInfo.prototype.element=null,b.HitResultInfo.prototype.data=null,b.Transform=function(){},b.Transform.prototype.getTransform=function(){return null},b.Transform.prototype.setTransform=function(){throw new Error("Not Supported.")},b.Transform.prototype.transform=function(a){this._transformChildren(a)},b.Transform.prototype._transformChildren=function(a){if(this.hasMixin(GNode.Container))for(var c=this.getFirstChild(!0);null!=c;c=c.getNext(!0))c instanceof b&&c.hasMixin(b.Transform)&&c.transform(a)},b.Transform.prototype.toString=function(){return"[Mixin GElement.Transform]"},b.Stylable=function(){},GObject.inherit(b.Stylable,GStylable),b.Stylable.GeometryProperties={sref:null},b.Stylable.prototype.assignStyleFrom=function(a,b){this.beginUpdate();try{GStylable.prototype.assignStyleFrom.call(this,a,b)}finally{this.endUpdate()}},b.Stylable.prototype.getReferencedStyle=function(){return this.isAttached()&&this.$sref?this.getScene().getReference(this.$sref):null},b.Stylable.prototype.getStyleLayers=function(){for(var a=this.getStylePropertySets(),b=null,c=0;c<a.length;++c){var d=a[c],e=null;switch(d){case GStylable.PropertySet.Fill:e=GStylable.StyleLayer.Fill;break;case GStylable.PropertySet.Border:e=GStylable.StyleLayer.Border}e&&(b?b.push(e):b=[e])}return b},b.Stylable.prototype._paintStyle=function(a,b){var c=this.getStyleLayers();if(a.configuration.isOutline(a))this._paintStyleFillLayer(a,b,c);else if(this.$_stop>0){var d=this._effects?this._effects.getLayersEffects(c,!0):null,e=null;if(d)for(var f=0;f<d.length;++f)if(d[f])for(var g=0;g<d[f].length;++g){var h=d[f][g].getEffectType();(h===GEffect.Type.PreEffect||h===GEffect.Type.PostEffect)&&(e=this._createStyleCanvas(a,b))}if(1!==this.$_stop||this.$_sbl!==GPaintCanvas.BlendMode.Normal){var i=this._createStyleCanvas(a,b),j=a.pushCanvas(i);try{if(this._paintStyleFillLayer(a,b,c,d,e),"mask"===this.$_sbl){var k=this._getStyleMaskClipArea();k&&j.clipRect(k.getX(),k.getY(),k.getWidth(),k.getHeight());try{j.drawCanvas(i,0,0,this.$_stop,GPaintCanvas.CompositeOperator.DestinationIn)}finally{k&&j.resetClip()}}else j.drawCanvas(i,0,0,this.$_stop,this.$_sbl);i.finish()}finally{a.popCanvas()}}else this._paintStyleFillLayer(a,b,c,d,e)}e&&e.finish()},b.Stylable.prototype._paintStyleFillLayer=function(a,b,c,d,e){if(a.configuration.isOutline(a))this._paintStyleContent(a,b,c,d,e);else{var f=d?d[c&&c.length?c.length:0]:null;if(1!==this.$_sfop||f){var g=this._createStyleCanvas(a,b),h=a.pushCanvas(g);try{this._paintStyleContent(a,b,c,d,e),f?this._paintWithEffects(g,a.getRootCanvas(),h,this.$_sfop,f,e):h.drawCanvas(g,0,0,this.$_sfop),g.finish()}finally{a.popCanvas()}}else this.$_sfop>0&&this._paintStyleContent(a,b,c,d,e)}},b.Stylable.prototype._paintStyleContent=function(a,b,c,d,e){if(c&&c.length){for(var f=a.configuration.isOutline(a),g=null,h=0;h<c.length;++h){var i=c[h];if(f)this._paintStyleLayer(a,i);else{var j=d?d[h]:null;if(j||this._isSeparateStylePaintLayer(a,i)){g?g.clear():g=this._createStyleCanvas(a,b);var k=a.pushCanvas(g);try{this._paintStyleLayer(a,i),j?this._paintWithEffects(g,a.getRootCanvas(),k,1,j,e):k.drawCanvas(g)}finally{a.popCanvas()}}else this._paintStyleLayer(a,i)}}g&&g.finish()}},b.Stylable.prototype._paintWithEffects=function(a,b,c,d,e,f){for(var g=!1,h=0;h<e.length;++h){var i=e[h],j=i.getEffectType();if(j===GEffect.Type.Filter)i.render(a,null,b,a.getScale());else if(j===GEffect.Type.PreEffect||j===GEffect.Type.PostEffect){j===GEffect.Type.PostEffect&&!g&&d>0&&(c.drawCanvas(a,0,0,d),g=!0),f.clear();var k=i.render(a,f,b,f.getScale()),l=GPaintCanvas.BlendMode.Normal;j===GEffect.Type.PostEffect&&k&&(l=k),c.drawCanvas(f,0,0,1,l)}}!g&&d>0&&c.drawCanvas(a,0,0,d)},b.Stylable.prototype._paintStyleLayer=function(){},b.Stylable.prototype._isSeparateStylePaintLayer=function(){return!1},b.Stylable.prototype._getStyleMaskClipArea=function(){return null},b.Stylable.prototype._createStyleCanvas=function(a,b){if(a.configuration.paintMode===GScenePaintConfiguration.PaintMode.Fast){var c=new GPaintCanvas;c.resize(b.getWidth(),b.getHeight()),c.prepare();var d=b.getSide(GRect.Side.TOP_LEFT);return c.setOrigin(d),c.setOffset(d),c}return a.canvas.createCanvas(b,!0)},b.Stylable.prototype._stylePrepareGeometryChange=function(a){if(this._notifyChange(b._Change.PrepareGeometryUpdate),a&&this.hasMixin(GNode.Container))for(var c=this.getFirstChild();null!==c;c=c.getNext())c instanceof b&&c.hasMixin(b.Stylable)&&c._stylePrepareGeometryChange(!0)},b.Stylable.prototype._styleFinishGeometryChange=function(a){if(this._notifyChange(b._Change.FinishGeometryUpdate,1),a&&this.hasMixin(GNode.Container))for(var c=this.getFirstChild();null!==c;c=c.getNext())c instanceof b&&c.hasMixin(b.Stylable)&&c._styleFinishGeometryChange(!0)},b.Stylable.prototype._styleRepaint=function(){this._notifyChange(b._Change.InvalidationRequest)},b.Stylable.prototype._handleStyleChange=function(a,b){if(this.isAttached()){if((a===GNode._Change.BeforePropertiesChange||a===GNode._Change.AfterPropertiesChange)&&b.properties.indexOf("sref")>=0||a===GNode._Change.Attached||a===GNode._Change.Detach){var c=this.getScene(),d=this.getReferencedStyle();if(d)switch(a){case GNode._Change.BeforePropertiesChange:case GNode._Change.Detach:c.unlink(d,this);break;case GNode._Change.AfterPropertiesChange:case GNode._Change.Attached:c.link(d,this)}}if(a===GNode._Change.AfterPropertiesChange){var e=b.properties.indexOf("_sbl");if(e>=0&&"mask"===b.values[e]||"mask"===this.$_sbl){var f=this.getPage();f&&f._requestInvalidation()}}}a===GNode._Change.Store?this.$sref&&(b.sref=this.$sref):a===GNode._Change.Restore&&(this.$sref=b.sref),GStylable.prototype._handleStyleChange.call(this,a,b)},b.Stylable.prototype._getStyleMaskClipArea=function(){var a=this.getPage();return a?a.getPageClipBBox():void 0},b.Stylable.prototype.toString=function(){return"[Mixin GElement.Stylable]"},b.prototype._geometryBBbox=null,b.prototype._paintBBox=null,b.prototype.getGeometryBBox=function(){return this.isVisible()?(null==this._geometryBBbox&&(this._geometryBBbox=this._calculateGeometryBBox()),this._geometryBBbox):null},b.prototype.getGroupGeometryBBox=function(a){var c=null;if(a&&a.length)for(var d=0;d<a.length;++d)if(a[d]instanceof b){var e=a[d].getGeometryBBox();e&&!e.isEmpty()&&(c=c?c.united(e):e)}return c},b.prototype.getChildrenGeometryBBox=function(){if(!this.isVisible())return null;if(this.hasMixin(GNode.Container)){for(var a=null,c=this.getFirstChild();null!=c;c=c.getNext())if(c instanceof b){var d=c.getGeometryBBox();d&&!d.isEmpty()&&(a=a?a.united(d):d)}return a?a:null}return null},b.prototype.getPaintBBox=function(){if(!this.isVisible())return null;if(null==this._paintBBox&&(this._paintBBox=this._calculatePaintBBox(),this._paintBBox)){var a=[0,0,0,0],b=this._paintBBox.getX(),c=this._paintBBox.getY(),d=b+this._paintBBox.getWidth(),e=c+this._paintBBox.getHeight();b!=Math.floor(b)&&(a[0]=.5),c!=Math.floor(c)&&(a[1]=.5),d!==Math.ceil(d)&&(a[2]=.5),e!==Math.ceil(e)&&(a[3]=.5),this._paintBBox=this._paintBBox.expanded(a[0],a[1],a[2],a[3])}return this._paintBBox},b.prototype.getChildrenPaintBBox=function(){if(!this.isVisible())return null;if(this.hasMixin(GNode.Container)){for(var a=null,c=this.getFirstChild();null!=c;c=c.getNext())if(c instanceof b){var d=c.getPaintBBox();d&&!d.isEmpty()&&(a=a?a.united(d):d)}return a?a:new GRect(0,0,0,0)}return null},b.prototype.isVisible=function(){return 0==(this._flags&b.Flag.Hidden)},b.prototype.hitTest=function(a,c,d,e,f,g,h,i){if("number"!=typeof f&&(f=-1),g=g||0,i&&i.call(null,this)===!1)return null;var j=this.getPaintBBox();if(!j||j.isEmpty())return null;if(c&&(j=c.mapRect(j)),!j.expanded(g,g,g,g).containsPoint(a))return null;var k=null;if(0!==f&&this.hasMixin(GNode.Container))for(var l=this.getLastChild();null!=l;l=l.getPrevious())if(l instanceof b){var m=l.hitTest(a,c,d,e,f-1,g,h,i);if(m){if(!e)return m;k?Array.prototype.push.apply(k,m):k=m}}if(d&&1==d.call(null,this)||!d){var n=this._detailHitTest(a,c,g,h);n&&(e&&k?k.push(n):k=[n])}return k},b.prototype.getCollisions=function(a,c,d,e){var f=[],g=function(a){(d&&1==d.call(null,a)||!d)&&f.push(a)};if(0!=(c&b.CollisionFlag.GeometryBBox)||0!=(c&b.CollisionFlag.PaintBBox)){if(e&&e.call(null,this)===!1)return f;var h=this.getPaintBBox();if(h&&!h.isEmpty()){var i=ifVertexInfo.calculateBounds(a,!0);0!=(c&b.CollisionFlag.Partial)?i.intersectsRect(h)&&g(this):i.containsRect(h)&&g(this)}}if(this.hasMixin(GNode.Container))for(var j=this.getFirstChild();null!=j;j=j.getNext())if(j instanceof b){var k=j.getCollisions(a,c,d,e);if(k&&k.length)for(var l=0;l<k.length;++l)g(k[l])}return f},b.prototype.isFullUnderCollision=function(a){var b=!1,c=this.getPaintBBox();if(c&&!c.isEmpty()){var d=ifVertexInfo.calculateBounds(a,!0);b=d.containsRect(c)}return b},b.prototype.beginUpdate=function(){this._updateCounter?this._updateCounter++:(this._updateCounter=1,this._notifyChange(b._Change.PrepareGeometryUpdate),this._blockUpdateChanges())},b.prototype.endUpdate=function(a){null!=this._updateCounter&&0==--this._updateCounter&&(this._releaseUpdateChanges(),this._notifyChange(b._Change.FinishGeometryUpdate,a?-1:0),delete this._updateCounter)},b.prototype.isPaintable=function(a){if(!this.isVisible())return!1;if(!a)return this.isAttached()&&this.getParent()||this instanceof GScene;var b=this.getPaintBBox();if(null==b||b.isEmpty())return!1;if(a){if(a.dirtyMatcher&&!a.dirtyMatcher.isDirty(b))return!1;if(a.configuration&&a.configuration.clipArea&&!a.configuration.clipArea.intersectsRect(b))return!1}return!0},b.prototype.paint=function(a){this._preparePaint(a)&&(this._paint(a),this._finishPaint(a))},b.prototype.toBitmap=function(a,b,c){var d=this._getBitmapPaintArea();c=c||0;var e=1,f=1,g=1,h=0,i=0;a&&("number"==typeof a?e=a:a instanceof GLength&&(e=a.toPoint()/d.getWidth())),b&&("number"==typeof b?f=b:b instanceof GLength&&(f=b.toPoint()/d.getHeight()));var j=Math.round(d.getWidth()*e),k=Math.round(d.getHeight()*f);if(e!==f)switch(c){case 0:f>e?(g=e,k=j):(g=f,j=k);break;case 1:e>f?(k=e,f=j):(g=f,j=k);break;case 2:f>e?(g=e,i=(k-d.getHeight()*g)/2):(g=f,h=(j-d.getWidth()*g)/2)}else g=e;var l=new GPaintCanvas;l.resize(j,k);var m=new GPaintContext;m.canvas=l;var n=new GScenePaintConfiguration;n.paintMode=GScenePaintConfiguration.PaintMode.Full,n.annotations=!1,m.configuration=n,n.clipArea=d,l.prepare(),l.setOrigin(new GPoint(d.getX()*g-h,d.getY()*g-i)),l.setScale(g);try{return this._paintToBitmap(m)}finally{l.finish()}},b.prototype.assignFrom=function(a){GNode.prototype.assignFrom.call(this,a),this.hasMixin(GStylable)&&a.hasMixin(GStylable)&&this.assignStyleFrom(a),this.hasMixin(b.Stylable)&&a.hasMixin(b.Stylable)&&(this.$sref=a.$sref)},b.prototype._getBitmapPaintArea=function(){return this.getPaintBBox()},b.prototype._paintToBitmap=function(a){return this.paint(a),a.canvas.getBitmap()},b.prototype._paint=function(a){this.hasMixin(b.Stylable)?this._paintStyle(a,this.getPaintBBox()):this._paintChildren(a)},b.prototype._preparePaint=function(a){return this.hasFlag(b.Flag.NoPaint)?!1:this.isPaintable(a)},b.prototype._finishPaint=function(){},b.prototype._paintChildren=function(a){if(this.hasMixin(GNode.Container))for(var c=this.getFirstChild();null!=c;c=c.getNext())c instanceof b&&c.paint(a)},b.prototype._calculateGeometryBBox=function(){return this.getChildrenGeometryBBox()},b.prototype._calculatePaintBBox=function(){return this.getChildrenPaintBBox()},b.prototype._detailHitTest=function(){return null},b.prototype._blockUpdateChanges=function(){this._beginBlockChanges([b._Change.InvalidationRequest,b._Change.PrepareGeometryUpdate,b._Change.FinishGeometryUpdate,b._Change.ChildGeometryUpdate])},b.prototype._releaseUpdateChanges=function(){this._endBlockChanges([b._Change.InvalidationRequest,b._Change.PrepareGeometryUpdate,b._Change.FinishGeometryUpdate,b._Change.ChildGeometryUpdate])},b.prototype._requestInvalidateNode=function(a){if(a.isPaintable()){var b=a.getPaintBBox();b&&this._requestInvalidationArea(b.expanded(2,2,2,2))}},b.prototype._requestInvalidationArea=function(a){this.isAttached()&&(this._scene._invalidateArea(a),this._handleChange(b._Change.InvalidationRequested,a))},b.prototype._requestInvalidation=function(){this._requestInvalidateNode(this)},b.prototype._handleChange=function(a,c){if(a==b._Change.InvalidationRequest)this.isPaintable()&&this._requestInvalidation();else if(a===b._Change.InvalidationRequested)this.getParent()&&this.getParent()._notifyChange(b._Change.InvalidationRequested,c);else if(a==b._Change.PrepareGeometryUpdate)this.isVisible()&&this._canEventBeSend(b.GeometryChangeEvent)&&this._scene.trigger(new b.GeometryChangeEvent(this,b.GeometryChangeEvent.Type.Before));else if(a==b._Change.FinishGeometryUpdate){if(this.isVisible()){var d=null;if(this.isPaintable()){var e=this.getPaintBBox();e&&!e.isEmpty()&&(d=e)}var f=0;if("number"==typeof c&&(f=c),1===f?this._paintBBox=null:0===f&&(this._geometryBBbox=null,this._paintBBox=null),this.isPaintable()){var g=this.getPaintBBox();GRect.equals(g,d)?this._requestInvalidation():(this.getParent()&&this.getParent()._notifyChange(b._Change.ChildGeometryUpdate,this),d&&this._requestInvalidationArea(d),this._handleChange(b._Change.InvalidationRequest))}this._canEventBeSend(b.GeometryChangeEvent)&&this._scene.trigger(new b.GeometryChangeEvent(this,b.GeometryChangeEvent.Type.After))}}else if(a==b._Change.ChildGeometryUpdate)this.isVisible()&&(this._invalidateGeometryForChildUpdate(),this._canEventBeSend(b.GeometryChangeEvent)&&this._scene.trigger(new b.GeometryChangeEvent(this,b.GeometryChangeEvent.Type.Child)),this.getParent()&&this.getParent()._notifyChange(a,c));else if(a==GNode._Change.AfterChildInsert)c instanceof b&&(this._notifyChange(b._Change.ChildGeometryUpdate,c),c._handleChange(b._Change.InvalidationRequest));else if(a==GNode._Change.BeforeChildRemove)c instanceof b&&this._requestInvalidateNode(c);else if(a==GNode._Change.AfterChildRemove)c instanceof b&&this._notifyChange(b._Change.ChildGeometryUpdate,c);else if(a==GNode._Change.AfterFlagChange)switch(c.flag){case b.Flag.NoPaint:this._requestInvalidation()}this.hasMixin(b.Stylable)&&this._handleStyleChange(a,c),GNode.prototype._handleChange.call(this,a,c)},b.prototype._invalidateGeometryForChildUpdate=function(){this.hasMixin(GNode.Container)&&(this._geometryBBbox=null,this._paintBBox=null)},b.prototype._handleGeometryChangeForProperties=function(a,c,d){if((a==GNode._Change.BeforePropertiesChange||a==GNode._Change.AfterPropertiesChange)&&GUtil.containsObjectKey(c.properties,d)){switch(a){case GNode._Change.BeforePropertiesChange:this._notifyChange(b._Change.PrepareGeometryUpdate);break;case GNode._Change.AfterPropertiesChange:this._notifyChange(b._Change.FinishGeometryUpdate)}return!0}return!1},b.prototype._handleVisualChangeForProperties=function(a,c,d){return a==GNode._Change.AfterPropertiesChange&&GUtil.containsObjectKey(c.properties,d)?(this._notifyChange(b._Change.InvalidationRequest),!0):!1},a.GElement=b}(this),function(a){function b(){GElement.call(this),this._setDefaultProperties(b.VisualProperties,b.MetaProperties)}GObject.inheritAndMix(b,GElement,[GNode.Properties,GNode.Store]),b.VisualProperties={visible:!0},b.MetaProperties={name:null,locked:!1},b.prototype.assignFrom=function(a){GElement.prototype.assignFrom.call(this,a),a instanceof b&&this.transferProperties(a,[b.VisualProperties,b.MetaProperties])},b.prototype.getLabel=function(){return this.$name&&""!==this.$name?this.$name:this.getNodeNameTranslated()},b.prototype.getOwnerLayer=function(){for(var a=this.getParent();null!==a;a=a.getParent())if(a instanceof GLayer)return a;return null},b.prototype.getRootLayer=function(){for(var a=null,b=this.getParent();null!==b;b=b.getParent())b instanceof GLayer&&(a=b);return a},b.prototype.getPage=function(){for(var a=this.getParent();null!==a;a=a.getParent())if(a instanceof GPage)return a;return null},b.prototype._handleChange=function(a,c){if(a===GNode._Change.Store)this.storeProperties(c,b.VisualProperties),this.storeProperties(c,b.MetaProperties);else if(a===GNode._Change.Restore)this.restoreProperties(c,b.VisualProperties),this.restoreProperties(c,b.MetaProperties);else if(a==GNode._Change.AfterPropertiesChange){var d=c;if(d.properties.indexOf("visible")>=0){var e=this.getProperty("visible"),f=e?null:this.getPaintBBox();this.accept(function(a){a instanceof GElement&&(e?a.removeFlag(GElement.Flag.Hidden):a.setFlag(GElement.Flag.Hidden),a._requestInvalidation())}),this.getParent()&&this.getParent()._notifyChange(GElement._Change.ChildGeometryUpdate,this),e?this._handleChange(GElement._Change.InvalidationRequest):this._requestInvalidationArea(f)}else if(d.properties.indexOf("locked")>=0){var g=this.getProperty("locked");this.accept(function(a){a instanceof GElement&&(g?a.setFlag(GElement.Flag.Locked):a.removeFlag(GElement.Flag.Locked))})}}GElement.prototype._handleChange.call(this,a,c)},a.GBlock=b}(this),function(a){function b(){GBlock.call(this)}GObject.inherit(b,GBlock),a.GItem=b}(this),function(a){function b(){GElement.call(this),this._scene=this,this._references={},this._links={},this._setDefaultProperties(b.MetaProperties)}GNode.inheritAndMix("scene",b,GElement,[GNode.Container,GNode.Properties,GNode.Store,GEventTarget]),b.PAGE_SPACING=10,b.VERSION=1,b.MetaProperties={version:b.VERSION,unit:GLength.Unit.PT,unitSnap:!0,snapDist:5,pickDist:3,crDistSmall:1,crDistBig:10,crConstraint:0,gridSizeX:10,gridSizeY:10,gridActive:!1,singlePage:!0,pathImage:"images",pathFont:"fonts",pathExport:"export"},b.InvalidationRequestEvent=function(a){this.area=a?a:null},GObject.inherit(b.InvalidationRequestEvent,GEvent),b.InvalidationRequestEvent.prototype.area=null,b.InvalidationRequestEvent.prototype.toString=function(){return"[Event GScene.InvalidationRequestEvent]"},b.ReferenceEvent=function(a,b,c){this.reference=a,this.target=b,this.linked=c},GObject.inherit(b.ReferenceEvent,GEvent),b.ReferenceEvent.prototype.reference=null,b.ReferenceEvent.prototype.target=null,b.ReferenceEvent.prototype.linked=null,b.ReferenceEvent.prototype.toString=function(){return"[Event GScene.ReferenceEvent]"
},b.ResolveUrlEvent=function(a,b){this.url=a,this.resolved=b},GObject.inherit(b.ResolveUrlEvent,GEvent),b.ResolveUrlEvent.prototype.url=null,b.ResolveUrlEvent.prototype.resolved=null,b.ResolveUrlEvent.prototype.toString=function(){return"[Event GScene.ResolveUrlEvent]"},b.StyleCollection=function(){GNode.call(this)},GNode.inheritAndMix("styles",b.StyleCollection,GNode,[GNode.Container,GNode.Store]),b.StyleCollection.prototype.validateInsertion=function(a){return a instanceof b},b.SwatchCollection=function(){GNode.call(this)},GNode.inheritAndMix("swatches",b.SwatchCollection,GNode,[GNode.Container,GNode.Store]),b.SwatchCollection.prototype.validateInsertion=function(a){return a instanceof b},b.prototype._references=null,b.prototype._links=null,b.prototype._styleCollection=null,b.prototype._swatchCollection=null,b.prototype.getStyleCollection=function(){if(this._styleCollection&&this._styleCollection.getParent()!==this&&(this._styleCollection=null),!this._styleCollection)for(var a=this.getFirstChild(!0);null!==a;a=a.getNext(!0))if(a instanceof b.StyleCollection){this._styleCollection=a;break}return this._styleCollection||(this._styleCollection=new b.StyleCollection,this.appendChild(this._styleCollection)),this._styleCollection},b.prototype.getSwatchCollection=function(){if(this._swatchCollection&&this._swatchCollection.getParent()!==this&&(this._swatchCollection=null),!this._swatchCollection)for(var a=this.getFirstChild(!0);null!==a;a=a.getNext(!0))if(a instanceof b.SwatchCollection){this._swatchCollection=a;break}return this._swatchCollection||(this._swatchCollection=new b.SwatchCollection,this.appendChild(this._swatchCollection)),this._swatchCollection},b.prototype.stringToLength=function(a){return GLength.parseEquation(a,this.$unit)},b.prototype.stringToPoint=function(a){var b=this.stringToLength(a);return b?b.toPoint():null},b.prototype.lengthToString=function(a){return GUtil.formatNumber(a.toUnit(this.$unit))},b.prototype.pointToString=function(a){return this.lengthToString(new GLength(a))},b.prototype.getElementsByBBox=function(a,b){var c=[];return this.acceptChildren(function(d){if(d instanceof GElement){var e=d.getPaintBBox();e&&!e.isEmpty()&&(b&&a.intersectsRect(e)||!b&&a.containsRect(e))&&c.push(d)}}),c},b.prototype.getActivePage=function(){return this.querySingle("page:active")},b.prototype.setActivePage=function(a){if(!a.isAttached())throw new Error("Page needs to be attached to be made active.");for(var b=this.getFirstChild();null!==b;b=b.getNext())b instanceof GPage&&b!==a&&b.removeFlag(GNode.Flag.Active);a.setFlag(GNode.Flag.Active)},b.prototype.getActiveLayer=function(){return this.querySingle("page:active layer:active")},b.prototype.setActiveLayer=function(a){if(!a.isAttached())throw new Error("Layer needs to be attached to be made active.");var b=a.getPage();this.setActivePage(b),b.acceptChildren(function(b){b instanceof GLayer&&b!==a&&b.removeFlag(GNode.Flag.Active)}),a.setFlag(GNode.Flag.Active)},b.prototype.getPageInsertPosition=function(){for(var a=this.getLastChild();null!==a;a=a.getPrevious())if(a instanceof GPage)return new GPoint(a.getProperty("x")+a.getProperty("w")+b.PAGE_SPACING,a.getProperty("y"));return new GPoint(0,0)},b.prototype.willPageIntersectWithOthers=function(a,c){c=c.expanded(b.PAGE_SPACING,b.PAGE_SPACING,b.PAGE_SPACING,b.PAGE_SPACING);for(var d=this.getLastChild();null!==d;d=d.getPrevious())if(d instanceof GPage&&d!==a){var e=d.getGeometryBBox();if(e&&e.intersectsRect(c))return!0}return!1},b.prototype.link=function(a,c){var d=a.getReferenceId();this._links.hasOwnProperty(d)||(this._links[d]=[]),this._links[d].push(c),this.hasEventListeners(b.ReferenceEvent)&&this.trigger(new b.ReferenceEvent(a,c,!0))},b.prototype.unlink=function(a,c){var d=a.getReferenceId();if(this._links.hasOwnProperty(d)){var e=this._links[d],f=e.indexOf(c);f>=0&&(e.splice(f,1),0===e.length&&delete this._links[d],this.hasEventListeners(b.ReferenceEvent)&&this.trigger(new b.ReferenceEvent(a,c,!1)))}},b.prototype.visitLinks=function(a,b){var c=this._links[a.getReferenceId()];if(c){c=c.slice();for(var d=0;d<c.length;++d)b(c[d])}},b.prototype.hasLinks=function(a){return this._links.hasOwnProperty(a.getReferenceId())},b.prototype.linkCount=function(a){var b=this._links[a.getReferenceId()];return b?b.length:0},b.prototype.addReference=function(a){var b=a.getReferenceId();if(this._references.hasOwnProperty(b))throw new Error("Reference already added.");this._references[b]=a},b.prototype.removeReference=function(a){var b=a.getReferenceId();if(!this._references.hasOwnProperty(b))throw new Error("Reference not yet added.");delete this._references[b]},b.prototype.getReference=function(a){return this._references.hasOwnProperty(a)?this._references[a]:null},b.prototype.resolveUrl=function(a,c){a&&0!==a.indexOf("data:")?this.hasEventListeners(b.ResolveUrlEvent)&&this.trigger(new b.ResolveUrlEvent(a,c)):c(a)},b.prototype.hitTest=function(a,b,c,d,e,f,g,h){if(this.$singlePage){var i=this.getActivePage();if(i)return i.hitTest(a,b,c,d,e,f,g,h)}return GElement.prototype.hitTest.call(this,a,b,c,d,e,f,g,h)},b.prototype._invalidateArea=function(a){this.hasEventListeners(b.InvalidationRequestEvent)&&this.trigger(new b.InvalidationRequestEvent(a))},b.prototype._paintChildren=function(a){if(a.configuration.clipArea){var b=a.configuration.clipArea;a.canvas.clipRect(b.getX(),b.getY(),b.getWidth(),b.getHeight())}for(var c=this.getFirstChild();null!=c;c=c.getNext())c instanceof GPage?(!this.$singlePage||c.hasFlag(GNode.Flag.Active))&&c.paint(a):c instanceof GElement&&c.paint(a);a.configuration.clipArea&&a.canvas.resetClip()},b.prototype._calculatePaintBBox=function(){var a=GElement.prototype._calculatePaintBBox.call(this);if(this.__editor__&&this.__editor__.isTransformBoxActive()){var b=this.__editor__.getTransformBox()._calculatePaintBBox();b&&!b.isEmpty()&&(a=a?a.united(b):b)}return a},b.prototype._calculateGeometryBBox=function(){var a=GElement.prototype._calculateGeometryBBox.call(this);if(this.__editor__&&this.__editor__.isTransformBoxActive()){var b=this.__editor__.getTransformBox()._calculatePaintBBox();b&&!b.isEmpty()&&(a=a?a.united(b):b)}return a},b.prototype._handleChange=function(a,c){a===GNode._Change.Store?this.storeProperties(c,b.MetaProperties):a===GNode._Change.Restore&&this.restoreProperties(c,b.MetaProperties),GElement.prototype._handleChange.call(this,a,c)},a.GScene=b}(this),function(a){function b(){}GObject.inherit(b,GPaintConfiguration),b.PaintMode={Full:"F",Fast:"S",Outline:"L",Output:"O"},b.PaintModeName={F:new GLocale.Key(b,"paint.full"),S:new GLocale.Key(b,"paint.fast"),L:new GLocale.Key(b,"paint.outline"),O:new GLocale.Key(b,"paint.output")},b.prototype.paintMode=b.PaintMode.Fast,b.prototype.pixelMode=!1,b.prototype.pagesClip=!1,b.prototype.guides=!0,b.prototype.slices=!0,b.prototype.annotations=!0,b.prototype.clipArea=null,b.prototype.isOutline=function(a){return this.paintMode===b.PaintMode.Outline?!0:a&&a.isOutline()?!0:!1},b.prototype.isAnnotationsVisible=function(){return this.annotations&&this.paintMode!==b.PaintMode.Output?!0:!1},b.prototype.isGuidesVisible=function(){return this.guides&&this.isAnnotationsVisible()?!0:!1},b.prototype.isSlicesVisible=function(){return this.slices&&this.isAnnotationsVisible()?!0:!1},b.prototype.isPagesClip=function(){return this.pagesClip||this.paintMode===b.PaintMode.Output},b.prototype.toString=function(){return"[Object GScenePaintConfiguration]"},a.GScenePaintConfiguration=b}(this);var GSelector=function(){function a(a,b,c,d){return a?d?function(d,e){return b(d,c,e)&&a(d,e)}:function(d,e){return a(d,e)&&b(d,c,e)}:function(a,d){return b(a,c,d)}}var b={},c=function(a,d,e,f){a="string"==typeof a?a.replace(/^\s+|\s+$/g,""):"";var g=b[a]||(b[a]=new c.initialize(a));return null==d?g:g.search(d,e,f)};c.initialize=function(a){this.text=a};var d=c.initialize.prototype=c.prototype,e=function(){return!0};d.queryAll=function(a,b,d){d=d||{};var f,g,h;if(!(a&&a instanceof GNode))throw new Error("Missing context or invalid context");if(!(a instanceof GNode))if("string"==typeof a)a=c.queryAll(a),f=!0;else if("[object Array]"==Object.prototype.toString.call(a)||"number"==typeof a.length&&a.item){var i=[];for(g=0;h=a[g];g++)h instanceof GNode&&i.push(h);f=i.length>1,a=f?i:i[0]}var j,k,l,m={},n={},o=m,p=c.getUid,q=function(a){var b=p(a);return o[b]?null:o[b]=!0};if(b&&b.length)for(g=0;h=b[g];g++)q(h);var r=this.parse();if(!r.length)return[];for(var s,g=0;s=r[g];g++){var t=q;if(s.first&&(b?j=!0:t=e,f?l=a:s.combinator&&(l=[a])),s.last&&b?(o=m,k=b):(o={},k=[]),s.combinator||f)for(var u=0,v=l.length;v>u;u++)k=s.combine(k,l[u],s,n,t);else k=s.combine(k,a,s,n,t,!k.length);s.last?k.length&&(b=k):l=k}return b||[]},d.querySingle=function(a,b,c){return this.queryAll(a,b,c)[0]},d.match=function(a,b){var c=this.parse();if(1==c.length)return!!this.parse()[0].match(a,{});if(!b)for(b=a;b.getParent();)b=b.getParent();for(var d=this.queryAll(b),e=d.length;e--;)if(d[e]==a)return!0;return!1},d.filter=function(a){for(var b,c=[],d=this.parse(),e=0;b=a[e];e++)for(var f=0;f<d.length;++f){var g=d[f].match;g(b)&&c.push(b)}return c};var f;c.recompile=function(){var a,b=[","],d=["!"];for(a in p)" "!=a&&b[a.length>1?"unshift":"push"](c.escapeRegExp(a));for(a in r)d.push(a);f=new RegExp("[\\w\\u00a1-\\uFFFF][\\w\\u00a1-\\uFFFF-]*|[#.](?:[\\w\\u00a1-\\uFFFF-]|\\\\:|\\\\.)+|[ \\t\\r\\n\\f](?=[\\w\\u00a1-\\uFFFF*#.[:])|[ \\t\\r\\n\\f]*("+b.join("|")+")[ \\t\\r\\n\\f]*|\\[([\\w\\u00a1-\\uFFFF-]+)[ \\t\\r\\n\\f]*(?:(["+d.join("")+"]?=)[ \\t\\r\\n\\f]*(?:\"([^\"]*)\"|'([^']*)'|([^\\]]*)))?]|:([-\\w\\u00a1-\\uFFFF]+)(?:\\((?:\"([^\"]*)\"|'([^']*)'|([^)]*))\\))?|\\*|(.+)","g")};var g=function(a){return{ident:[],tags:[],properties:[],pseudos:[],combinator:a}},h=function(a){return a};d.parse=function(a){var b=a?"plain":"parsed";if(this[b])return this[b];var d=this.text,e=a?h:this.compute,i=[],j=g(null);j.first=!0;var k=function(a){i.push(e(j)),j=g(a)};f.lastIndex=0;for(var l,m;l=f.exec(d);){if(l[11]){if(c.verbose)throw SyntaxError('Syntax error, "'+m+'" unexpected at #'+f.lastIndex+' in "'+d+'"');return this[b]=[]}switch(m=l[0],m.charAt(0)){case".":j.tags.push(m.slice(1).replace(/\\/g,""));break;case"#":j.id=m.slice(1).replace(/\\/g,"");break;case"[":j.properties.push({name:l[2],operator:l[3]||null,value:l[4]||l[5]||l[6]||null});break;case":":j.pseudos.push({name:l[7],value:l[8]||l[9]||l[10]||null});break;case" ":case"	":case"\r":case"\n":case"\f":l[1]=l[1]||" ";default:var n=l[1];if(n){if(","==n){j.last=!0,k(null),j.first=!0;continue}j.first&&!j.ident.length?j.combinator=n:k(n)}else"*"!=m&&(j.nodeName=m)}j.ident.push(m)}return j.last=!0,i.push(e(j)),this[b]=i};var i=function(){return!0},j=function(a,b){return a.hasMixin(GNode.Identity)?b===a.getId():!1},k=function(a,b){return a.getNodeName().toUpperCase()==b.toUpperCase()},l=function(a){return new RegExp("(?:^|[ \\t\\r\\n\\f])"+a+"(?:$|[ \\t\\r\\n\\f])")},m=function(a,b){if(a.hasMixin(GNode.Tag)){var c=a.getTags();return c&&b.test(c)}return!1},n=function(a){if(!a.operator||!a.value)return a;var b=r[a.operator];return b&&(a.escaped=c.escapeRegExp(a.value),a.pattern=new RegExp(b(a.value,a.escaped,a))),a},o=function(a,b){var c=a.hasMixin(GNode.Properties)?a.getProperty(b.name):null;switch(b.operator){case null:return c;case"=":return c==b.value;case"!=":return c!=b.value}return!c&&b.value?!1:b.pattern.test(c)};d.compute=function(b){var d,e,f,g,h,p,r=b.nodeName,s=b.id,t=b.tags;if(s&&(p=!0,h=a(null,j,s),g=function(a){var b=a._scene.getById(s);return!b||r&&!k(b,r)?[]:[b]}),t.length>0)if(g||1!=t.length)for(d=0;e=t[d];d++)f=a(f,m,l(e));else{p=!0;var u=l(t[0]);h=a(h,m,u),g=function(a){for(var b,c=a.getNodesByName(r||"*"),d=[],e=0;b=c[e];e++)m(b,t[0])&&d.push(b);return d}}for(r?g?p||(f=a(f,k,r)):(h=a(h,k,r),g=function(a){return a.getNodesByName(r)}):g||(g=function(a){return a.getNodesByName("*")}),d=0;e=b.pseudos[d];d++)if("not"==e.name){var v=c(e.value);f=a(f,function(a,b){return!b.match(a)},1==v.parse().length?v.parsed[0]:v)}else{var w=q[e.name];w&&(f=a(f,w,e.value))}for(d=0;e=b.properties[d];d++)f=a(f,o,n(e));return(b.simple=!f)?b.matchAux=i:(b.matchAux=f,h=a(h,f)),b.match=h||i,b.combine=c.combinators[b.combinator||" "],b.search=g,b};var p=c.combinators={" ":function(a,b,d,e,f,g){var h=d.search(b);if(g&&d.simple)return c.toArray(h);for(var i,j=0,k=d.matchAux;i=h[j];j++)f(i)&&k(i,e)&&a.push(i);return a},">":function(a,b,c,d,e){for(var f,g=c.search(b),h=0;f=g[h];h++)f.getParent()==b&&e(f)&&c.matchAux(f,d)&&a.push(f);return a},"+":function(a,b,c,d,e){for(;b=b.getNext();){e(b)&&c.match(b,d)&&a.push(b);break}return a},"~":function(a,b,c,d,e){for(;(b=b.getNext())&&e(b);)c.match(b,d)&&a.push(b);return a},"<":function(a,b,c,d,e){for(;(b=b.getParent())&&!(b instanceof GScene);)e(b)&&c.match(b,d)&&a.push(b);return a},"^":function(a,b,d,e,f){return(b=b.getFirstChild())&&(f(b)&&d.match(b,e)?a.push(b):a=c.combinators["+"](a,b,d,b,e)),a},"++":function(a,b,c,d,e){for(;b=b.getNext();)e(b)&&this.match(b,d)&&a.push(b);return a},"--":function(a,b,c,d,e){for(;b=b.getPrevious();)e(b)&&this.match(b,d)&&a.push(b);return a}},q=c.pseudos={"first-child":function(a){return q.index(a,0)},"last-child":function(a){return null==a.getNext()},"only-child":function(a){return null==a.getPrevious()&&null==a.getNext()},"nth-child":function(a,b,d){var e=c.parseNth(b||"n");if("n"!=e.special)return q[e.special](a,e.a,d);d=d||{},d.positions=d.positions||{};var f=c.getUid(a);if(!d.positions[f]){for(var g=0;a=a.getPrevious();){g++;var h=d.positions[c.getUid(a)];if(void 0!=h){g=h+g;break}}d.positions[f]=g}return d.positions[f]%e.a==e.b},empty:function(){return!1},contains:function(){return!1},index:function(a,b){for(var c=1;a=a.getPrevious();)if(++c>b)return!1;return c==b},even:function(a,b,c){return q["nth-child"](a,"2n+1",c)},odd:function(a,b,c){return q["nth-child"](a,"2n",c)},has:function(a,b){return c.querySingle(b,a)},active:function(a){return a.hasFlag(GNode.Flag.Active)},selected:function(a){return a.hasFlag(GNode.Flag.Selected)},hidden:function(a){return a instanceof GElement&&a.hasFlag(GElement.Flag.Hidden)},visible:function(a){return a instanceof GElement&&!a.hasFlag(GElement.Flag.Hidden)}};q.first=q["first-child"],q.last=q["last-child"],q.nth=q["nth-child"],q.eq=q.index;var r=c.propertyOperators={"*=":function(a,b){return b},"^=":function(a,b){return"^"+b},"$=":function(a){return a+"$"},"~=":function(a,b){return"(?:^|[ \\t\\r\\n\\f])"+b+"(?:$|[ \\t\\r\\n\\f])"},"|=":function(a,b){return"(?:^|\\|)"+b+"(?:$|\\|)"},"/=":function(a){return a}},s=Array.slice||function(a){return Array.prototype.slice.call(a)};try{s(scene.sceneElement.childNodes)}catch(t){s=function(a){if(a instanceof Array)return a;for(var b=a.length,c=new Array(b);b--;)c[b]=a[b];return c}}c.toArray=s;var u=1;c.getUid=window.ActiveXObject?function(a){return(a.__slyUid||(a.__slyUid={id:u++})).id}:function(a){return a.__slyUid||(a.__slyUid=u++)};var v={};c.parseNth=function(a){if(v[a])return v[a];var b=a.match(/^([+-]?\d*)?([a-z]+)?([+-]?\d*)?$/);if(!b)return!1;var c=parseInt(b[1],10),d=(parseInt(b[3],10)||0)-1;if(c=isNaN(c)?1:c){for(;1>d;)d+=c;for(;d>=c;)d-=c}switch(b[2]){case"n":b={a:c,b:d,special:"n"};break;case"odd":b={a:2,b:0,special:"n"};break;case"even":b={a:2,b:1,special:"n"};break;case"first":b={a:0,special:"index"};break;case"last":b={special:"last-child"};break;case"only":b={special:"only-child"};break;default:b={a:c?c-1:d,special:"index"}}return v[a]=b},c.escapeRegExp=function(a){return a.replace(/[-.*+?^${}()|[\]\/\\]/g,"\\$&")},c.generise=function(a){c[a]=function(b){var d=c(b);return d[a].apply(d,Array.prototype.slice.call(arguments,1))}};for(var w=["parse","queryAll","querySingle","match","filter"],x=0;w[x];x++)c.generise(w[x]);return c.recompile(),c}();!function(a){GEffect=function(){this._setDefaultProperties(GEffect.GeometryProperties)},GObject.inheritAndMix(GEffect,GNode,[GNode.Store,GNode.Properties]),GEffect.Type={PreEffect:0,PostEffect:1,Filter:2},GEffect.GeometryProperties={vs:!0,ly:null},GEffect.prototype.getEffectType=function(){throw new Error("Not Supported.")},GEffect.prototype.getEffectPadding=function(){return null},GEffect.prototype.render=function(){},GEffect.prototype.validateInsertion=function(a){return a instanceof GStylable.Effects},GEffect.prototype._handleChange=function(a,b){a===GNode._Change.Store?this.storeProperties(b,GEffect.GeometryProperties):a===GNode._Change.Restore&&this.restoreProperties(b,GEffect.GeometryProperties),this._handleGeometryChangeForProperties(a,b,GEffect.GeometryProperties),GNode.prototype._handleChange.call(this,a,b)},GEffect.prototype.getOwnerStylable=function(){var a=this.getParent();if(a&&a instanceof GStylable.Effects){var b=a.getParent();if(b&&b.hasMixin(GStylable))return b}return null},GEffect.prototype._handleGeometryChangeForProperties=function(a,b,c){if((a==GNode._Change.BeforePropertiesChange||a==GNode._Change.AfterPropertiesChange)&&GUtil.containsObjectKey(b.properties,c)){var d=this.getOwnerStylable();if(d)switch(a){case GNode._Change.BeforePropertiesChange:d._stylePrepareGeometryChange(!0);break;case GNode._Change.AfterPropertiesChange:d._styleFinishGeometryChange(!0)}return!0}return!1},GEffect.prototype._handleVisualChangeForProperties=function(a,b,c){if(a==GNode._Change.AfterPropertiesChange&&GUtil.containsObjectKey(b.properties,c)){var d=this.getOwnerStylable();return d&&d._styleRepaint(),!0}return!1},GEffect.prototype.toString=function(){return"[Object GEffect]"},a.GEffect=GEffect}(this),function(a){GBlurEffect=function(){GEffect.call(this),this._setDefaultProperties(GBlurEffect.GeometryProperties)},GNode.inherit("blurEffect",GBlurEffect,GEffect),GBlurEffect.equals=function(a,b){return a instanceof GBlurEffect&&b instanceof GBlurEffect?a.arePropertiesEqual(b,Object.keys(GBlurEffect.GeometryProperties)):!1},GBlurEffect.GeometryProperties={r:5},GBlurEffect.prototype.getEffectType=function(){return GEffect.Type.Filter},GBlurEffect.prototype.getEffectPadding=function(){return this.$r},GBlurEffect.prototype.render=function(a,b,c,d){this.$r&&a.getBitmap().applyFilter(GStackBlurFilter,this.$r*d)},GBlurEffect.prototype._handleChange=function(a,b){a===GNode._Change.Store?this.storeProperties(b,GBlurEffect.GeometryProperties):a===GNode._Change.Restore&&this.restoreProperties(b,GBlurEffect.GeometryProperties),this._handleGeometryChangeForProperties(a,b,GBlurEffect.GeometryProperties),GEffect.prototype._handleChange.call(this,a,b)},GBlurEffect.prototype.toString=function(){return"[Object GBlurEffect]"},a.GBlurEffect=GBlurEffect}(this),function(a){GColorGradingEffect=function(){GEffect.call(this),this._setDefaultProperties(GColorGradingEffect.VisualProperties)},GNode.inherit("clGradingEffect",GColorGradingEffect,GEffect),GColorGradingEffect.equals=function(a,b){return a instanceof GColorGradingEffect&&b instanceof GColorGradingEffect?a.arePropertiesEqual(b,Object.keys(GColorGradingEffect.VisualProperties)):!1},GColorGradingEffect.VisualProperties={cp:null},GColorGradingEffect.prototype.getEffectType=function(){return GEffect.Type.Filter},GColorGradingEffect.prototype.render=function(a){this.$cp&&a.getBitmap().applyFilter(GColorGradingFilter,this.$cp)},GColorGradingEffect.prototype._handleChange=function(a,b){a===GNode._Change.Store?this.storeProperties(b,GColorGradingEffect.VisualProperties):a===GNode._Change.Restore&&this.restoreProperties(b,GColorGradingEffect.VisualProperties),this._handleVisualChangeForProperties(a,b,GColorGradingEffect.VisualProperties),GEffect.prototype._handleChange.call(this,a,b)},GColorGradingEffect.prototype.toString=function(){return"[Object GColorGradingEffect]"},a.GColorGradingEffect=GColorGradingEffect}(this),function(a){GColorMatrixEffect=function(){GEffect.call(this),this._setDefaultProperties(GColorMatrixEffect.VisualProperties)},GNode.inherit("clMatrixEffect",GColorMatrixEffect,GEffect),GColorMatrixEffect.equals=function(a,b){return a instanceof GColorMatrixEffect&&b instanceof GColorMatrixEffect?a.arePropertiesEqual(b,Object.keys(GColorMatrixEffect.VisualProperties)):!1},GColorMatrixEffect.VisualProperties={cm:null},GColorMatrixEffect.prototype.getEffectType=function(){return GEffect.Type.Filter},GColorMatrixEffect.prototype.render=function(a){this.$cm&&a.getBitmap().applyFilter(GColorMatrixFilter,this.$cm)},GColorMatrixEffect.prototype._handleChange=function(a,b){a===GNode._Change.Store?this.storeProperties(b,GColorMatrixEffect.VisualProperties):a===GNode._Change.Restore&&this.restoreProperties(b,GColorMatrixEffect.VisualProperties),this._handleVisualChangeForProperties(a,b,GColorMatrixEffect.VisualProperties),GEffect.prototype._handleChange.call(this,a,b)},GColorMatrixEffect.prototype.toString=function(){return"[Object GColorMatrixEffect]"},a.GColorMatrixEffect=GColorMatrixEffect}(this),function(a){GColorTransformEffect=function(){GEffect.call(this),this._setDefaultProperties(GColorTransformEffect.VisualProperties)},GNode.inherit("clTransformEffect",GColorTransformEffect,GEffect),GColorTransformEffect.equals=function(a,b){return a instanceof GColorTransformEffect&&b instanceof GColorTransformEffect?a.arePropertiesEqual(b,Object.keys(GColorTransformEffect.VisualProperties)):!1},GColorTransformEffect.VisualProperties={m:null,o:null},GColorTransformEffect.prototype.getEffectType=function(){return GEffect.Type.Filter},GColorTransformEffect.prototype.render=function(a){this.$m&&this.$o&&a.getBitmap().applyFilter(GColorMatrixFilter,{multiplier:this.$m,offsets:this.$o})},GColorTransformEffect.prototype._handleChange=function(a,b){a===GNode._Change.Store?this.storeProperties(b,GColorTransformEffect.VisualProperties):a===GNode._Change.Restore&&this.restoreProperties(b,GColorTransformEffect.VisualProperties),this._handleVisualChangeForProperties(a,b,GColorTransformEffect.VisualProperties),GEffect.prototype._handleChange.call(this,a,b)},GColorTransformEffect.prototype.toString=function(){return"[Object GColorTransformEffect]"},a.GColorTransformEffect=GColorTransformEffect}(this),function(a){GDropShadowEffect=function(){GEffect.call(this),this._setDefaultProperties(GDropShadowEffect.GeometryProperties,GDropShadowEffect.VisualProperties)},GNode.inherit("dropShadowEffect",GDropShadowEffect,GEffect),GDropShadowEffect.equals=function(a,b){return a instanceof GDropShadowEffect&&b instanceof GDropShadowEffect?a.arePropertiesEqual(b,Object.keys(GDropShadowEffect.GeometryProperties).concat(Object.keys(GDropShadowEffect.VisualProperties))):!1},GDropShadowEffect.GeometryProperties={r:5,x:0,y:0},GDropShadowEffect.VisualProperties={pat:GRGBColor.BLACK,opc:.5},GDropShadowEffect.prototype.getEffectType=function(){return GEffect.Type.PreEffect},GDropShadowEffect.prototype.getEffectPadding=function(){return[this.$r-this.$x,this.$r-this.$y,this.$r+this.$x,this.$r+this.$y]},GDropShadowEffect.prototype.render=function(a,b,c,d){if(this.$pat&&this.$opc>0){var e=b.getTransform(!1).inverted().mapRect(new GRect(0,0,b.getWidth(),b.getHeight())),f=b.createPatternPaint(this.$pat,e);if(f)if(f.transform){var g=b.setTransform(b.getTransform(!0).preMultiplied(f.transform));b.fillRect(0,0,1,1,f.paint,this.$opc),b.setTransform(g)}else b.fillRect(e.getX(),e.getY(),e.getWidth(),e.getHeight(),f.paint,this.$opc);var h=this.$x*d,i=this.$y*d,j=this.$r*d;b.drawCanvas(a,h,i,1,GPaintCanvas.CompositeOperator.DestinationIn),j>0&&b.getBitmap().applyFilter(GStackBlurFilter,j)}},GDropShadowEffect.prototype._handleChange=function(a,b){a===GNode._Change.Store?(this.storeProperties(b,GDropShadowEffect.GeometryProperties),this.storeProperties(b,GDropShadowEffect.VisualProperties,function(a,b){return b&&"pat"===a?GPattern.serialize(b):b})):a===GNode._Change.Restore&&(this.restoreProperties(b,GDropShadowEffect.GeometryProperties),this.restoreProperties(b,GDropShadowEffect.VisualProperties,function(a,b){return b&&"pat"===a&&b?GPattern.deserialize(b):b})),this._handleGeometryChangeForProperties(a,b,GDropShadowEffect.GeometryProperties),this._handleVisualChangeForProperties(a,b,GDropShadowEffect.VisualProperties),GEffect.prototype._handleChange.call(this,a,b)},GDropShadowEffect.prototype.toString=function(){return"[Object GDropShadowEffect]"},a.GDropShadowEffect=GDropShadowEffect}(this),function(a){GInnerShadowEffect=function(){GEffect.call(this),this._setDefaultProperties(GInnerShadowEffect.GeometryProperties,GInnerShadowEffect.VisualProperties)},GNode.inherit("innerShadowEffect",GInnerShadowEffect,GEffect),GInnerShadowEffect.equals=function(a,b){return a instanceof GInnerShadowEffect&&b instanceof GInnerShadowEffect?a.arePropertiesEqual(b,Object.keys(GInnerShadowEffect.GeometryProperties).concat(Object.keys(GInnerShadowEffect.VisualProperties))):!1},GInnerShadowEffect.GeometryProperties={r:5,x:0,y:0},GInnerShadowEffect.VisualProperties={pat:GRGBColor.BLACK,opc:.5},GInnerShadowEffect.prototype.getEffectType=function(){return GEffect.Type.PostEffect},GInnerShadowEffect.prototype.getEffectPadding=function(){return[this.$r-this.$x,this.$r-this.$y,this.$r+this.$x,this.$r+this.$y]},GInnerShadowEffect.prototype.render=function(a,b,c,d){if(this.$pat&&this.$opc>0&&this.$r>0){var e=b.getTransform(!1).inverted().mapRect(new GRect(0,0,b.getWidth(),b.getHeight())),f=b.createPatternPaint(this.$pat,e);if(f)if(f.transform){var g=b.setTransform(b.getTransform(!0).preMultiplied(f.transform));b.fillRect(0,0,1,1,f.paint,this.$opc),b.setTransform(g)}else b.fillRect(e.getX(),e.getY(),e.getWidth(),e.getHeight(),f.paint,this.$opc);var h=this.$x*d,i=this.$y*d,j=this.$r*d;b.drawCanvas(a,h,i,1,GPaintCanvas.CompositeOperator.DestinationOut),b.getBitmap().applyFilter(GStackBlurFilter,j),b.drawCanvas(a,0,0,1,GPaintCanvas.CompositeOperator.DestinationIn)}},GInnerShadowEffect.prototype._handleChange=function(a,b){a===GNode._Change.Store?(this.storeProperties(b,GInnerShadowEffect.GeometryProperties),this.storeProperties(b,GInnerShadowEffect.VisualProperties,function(a,b){return b&&"pat"===a?GPattern.serialize(b):b})):a===GNode._Change.Restore&&(this.restoreProperties(b,GInnerShadowEffect.GeometryProperties),this.restoreProperties(b,GInnerShadowEffect.VisualProperties,function(a,b){return b&&"pat"===a?GPattern.deserialize(b):b})),this._handleGeometryChangeForProperties(a,b,GInnerShadowEffect.GeometryProperties),this._handleVisualChangeForProperties(a,b,GInnerShadowEffect.VisualProperties),GEffect.prototype._handleChange.call(this,a,b)},GInnerShadowEffect.prototype.toString=function(){return"[Object GInnerShadowEffect]"},a.GInnerShadowEffect=GInnerShadowEffect}(this),function(a){GOverlayEffect=function(){GEffect.call(this),this._setDefaultProperties(GOverlayEffect.VisualProperties)},GNode.inherit("overlayEffect",GOverlayEffect,GEffect),GOverlayEffect.equals=function(a,b){return a instanceof GOverlayEffect&&b instanceof GOverlayEffect?a.arePropertiesEqual(b,Object.keys(GOverlayEffect.VisualProperties)):!1},GOverlayEffect.VisualProperties={pat:GRGBColor.BLACK,opc:.5},GOverlayEffect.prototype.getEffectType=function(){return GEffect.Type.Filter},GOverlayEffect.prototype.render=function(a){if(this.$pat&&this.$opc>0){var b=a.getTransform(!1).inverted().mapRect(new GRect(0,0,a.getWidth(),a.getHeight())),c=a.createPatternPaint(this.$pat,b);if(c)if(c.transform){var d=a.setTransform(a.getTransform(!0).preMultiplied(c.transform));a.fillRect(0,0,1,1,c.paint,this.$opc,GPaintCanvas.CompositeOperator.SourceAtTop),a.setTransform(d)}else a.fillRect(b.getX(),b.getY(),b.getWidth(),b.getHeight(),c.paint,this.$opc,GPaintCanvas.CompositeOperator.SourceAtTop)}},GOverlayEffect.prototype._handleChange=function(a,b){a===GNode._Change.Store?this.storeProperties(b,GOverlayEffect.VisualProperties,function(a,b){return b&&"pat"===a?GPattern.serialize(b):b}):a===GNode._Change.Restore&&this.restoreProperties(b,GOverlayEffect.VisualProperties,function(a,b){return b&&"pat"===a?GPattern.deserialize(b):b}),this._handleVisualChangeForProperties(a,b,GOverlayEffect.VisualProperties),GEffect.prototype._handleChange.call(this,a,b)},GOverlayEffect.prototype.toString=function(){return"[Object GOverlayEffect]"},a.GOverlayEffect=GOverlayEffect}(this),function(a){function b(){GBlock.call(this),this._setDefaultProperties(b.GeometryProperties,b.VisualProperties)}GNode.inheritAndMix("page",b,GBlock,[GNode.Container,GNode.Reference]),b.GeometryProperties={msref:null,x:0,y:0,w:0,h:0,bl:0,ml:0,mt:0,mr:0,mb:0},b.VisualProperties={bck:null,bop:1},b.prototype.isMaster=function(){return this.isAttached()?this.getScene().hasLinks(this):!1},b.prototype.getMasterPage=function(){var a=this.$msref&&this.isAttached()?this.getScene().getReference(this.$msref):null;return a===this?null:a},b.prototype.getPageClipBBox=function(){var a=this.getGeometryBBox();if(a&&!a.isEmpty()){var b=this.$bl||0;return a.expanded(b,b,b,b)}return a},b.prototype._getBitmapPaintArea=function(){return this.getPageClipBBox()},b.prototype._paintToBitmap=function(a){return paintConfig.pagesClip=!0,GBlock.prototype._paintToBitmap(a)},b.prototype._paint=function(a){for(var b=a.canvas,c=!1,d=this.getFirstChild();null!==d;d=d.getNext())if(d instanceof GElement){c=!0;break}var e=this.getMasterPage(),f=!1,g=b.resetTransform(),h=new GRect(this.$x,this.$y,this.$w,this.$h),i=g.mapRect(h).toAlignedRect(),j=i.getX(),k=i.getY(),l=i.getWidth(),m=i.getHeight();if(!a.configuration.isOutline(a)&&this.$bck&&this.$bop>0){var n=a.canvas.createPatternPaint(this.$bck,i);if(n)if(n.transform){var o=b.setTransform(b.getTransform(!0).preMultiplied(n.transform));b.fillRect(0,0,1,1,n.paint,this.$bop),b.setTransform(o)}else b.fillRect(j,k,l,m,n.paint,this.$bop)}if(c&&e||a.configuration.isPagesClip()){var p=this.$bl||0;b.clipRect(j-p,k-p,l+2*p,m+2*p),f=!0}if(b.setTransform(g),e){var g=b.getTransform(!0),q=e.getProperty("x"),r=e.getProperty("y"),s=this.$x-q,t=this.$y-r,u=new GTransform(1,0,0,1,s,t);b.setTransform(g.preMultiplied(u)),a.dirtyMatcher.transform(new GTransform(1,0,0,1,-s,-t)),e.paint(a),a.dirtyMatcher.transform(u),b.setTransform(g)}c&&this._paintChildren(a),f&&b.resetClip()},b.prototype.validateInsertion=function(a){return a instanceof GScene},b.prototype._calculateGeometryBBox=function(){return new GRect(this.$x,this.$y,this.$w,this.$h)},b.prototype._calculatePaintBBox=function(){var a=this.getGeometryBBox();this.$bl&&this.$bl>0&&(a=a.expanded(this.$bl,this.$bl,this.$bl,this.$bl));var b=GBlock.prototype._calculatePaintBBox.call(this);return b?b.united(a):a},b.prototype._detailHitTest=function(a,b,c,d){var e=this.getGeometryBBox();return b&&(e=b.mapRect(e)),e.expanded(c,c,c,c).containsPoint(a)?new GElement.HitResultInfo(this):GBlock.prototype._detailHitTest.call(this,a,b,c,d)},b.prototype._handleChange=function(a,c){if(a===GNode._Change.Store?(this.storeProperties(c,b.GeometryProperties),this.storeProperties(c,b.VisualProperties,function(a,b){return"bck"===a&&b?GPattern.serialize(b):b}),this.hasFlag(GNode.Flag.Active)&&(c.__active=!0)):a===GNode._Change.PrepareRestore?this.__restoring=!0:a===GNode._Change.Restore&&(this.restoreProperties(c,b.GeometryProperties),this.restoreProperties(c,b.VisualProperties,function(a,b){return"bck"===a&&b?GPattern.deserialize(b):b}),c.__active&&this.setFlag(GNode.Flag.Active),delete this.__restoring),this._handleGeometryChangeForProperties(a,c,b.GeometryProperties)){if(a===GNode._Change.BeforePropertiesChange&&!this.__restoring){var d=c.properties.indexOf("x"),e=c.properties.indexOf("y");if(d>=0||e>=0){var f=d>=0?c.values[d]-this.$x:0,g=e>=0?c.values[e]-this.$y:0;if(0!==f||0!==g)for(var h=new GTransform(1,0,0,1,f,g),i=this.getFirstChild(!0);null!=i;i=i.getNext(!0))i instanceof GElement&&i.hasMixin(GElement.Transform)&&i.transform(h)}}if(c.properties.indexOf("msref")>=0){var j=this.getMasterPage();if(j)switch(a){case GNode._Change.BeforePropertiesChange:this.getScene().unlink(j,this);break;case GNode._Change.AfterPropertiesChange:this.getScene().link(j,this)}}}if(this._handleVisualChangeForProperties(a,c,b.VisualProperties),a===GElement._Change.InvalidationRequested){var k=c;if(k&&!k.isEmpty()&&this.isMaster()&&this.getScene().getProperty("singlePage")===!1){var l=this.getPageClipBBox();l&&!l.isEmpty()&&l.intersectsRect(k)&&this.getScene().visitLinks(this,function(a){if(a instanceof b&&a.isPaintable()){var c=a.getProperty("x")-this.$x,d=a.getProperty("y")-this.$y;
a._requestInvalidationArea(k.translated(c,d))}}.bind(this))}}GBlock.prototype._handleChange.call(this,a,c)},b.prototype._setScene=function(a){if(a!==this._scene)if(a){var b=a.getReference(this.$msref);b&&a.link(b,this)}else{var b=this._scene.getReference(this.$msref);b&&this._scene.unlink(b,this)}GBlock.prototype._setScene.call(this,a)},a.GPage=b}(this),function(a){function b(){GBlock.call(this),this._setDefaultProperties(b.VisualProperties,b.MetaProperties)}GNode.inheritAndMix("layer",b,GBlock,[GNode.Container,GElement.Transform,GElement.Stylable]),b.GUIDE_COLOR_DEFAULT=new GRGBColor([0,255,255]),b.Type={Output:"O",Draft:"D",Guide:"G"},b.TypeName={O:new GLocale.Key(b,"type.output"),D:new GLocale.Key(b,"type.draft"),G:new GLocale.Key(b,"type.guide")},b.MetaProperties={tp:b.Type.Output},b.VisualProperties={otl:!1,cls:new GRGBColor([0,168,255])},b.prototype.validateInsertion=function(a){return a instanceof b||a instanceof GPage},b.prototype._preparePaint=function(a){if(GBlock.prototype._preparePaint.call(this,a)){if(this.$tp===b.Type.Guide){if(!a.configuration.isGuidesVisible(a))return!1;a.configuration.paintMode===GScenePaintConfiguration.PaintMode.Outline||this.$otl||a.outlineColors.push(this.$cls)}else if(this.$tp===b.Type.Draft&&!a.configuration.isAnnotationsVisible(a))return!1;return a.configuration.paintMode!==GScenePaintConfiguration.PaintMode.Outline&&this.$otl&&a.outlineColors.push(this.$cls),!0}return!1},b.prototype._finishPaint=function(a){this.$tp!==b.Type.Guide||a.configuration.paintMode===GScenePaintConfiguration.PaintMode.Outline||this.$otl?this.$tp===b.Type.Draft:a.outlineColors.pop(),a.configuration.paintMode!==GScenePaintConfiguration.PaintMode.Outline&&this.$otl&&a.outlineColors.pop(),GBlock.prototype._finishPaint.call(this,a)},b.prototype._paintStyleContent=function(a){this._paintChildren(a)},b.prototype._detailHitTest=function(){return new GElement.HitResultInfo(this)},b.prototype._handleChange=function(a,c){if(a===GNode._Change.Store?(this.storeProperties(c,b.VisualProperties,function(a,b){return"cls"===a&&b?GPattern.serialize(b):b}),this.storeProperties(c,b.MetaProperties),this.hasFlag(GNode.Flag.Active)&&(c.__active=!0)):a===GNode._Change.Restore&&(this.restoreProperties(c,b.VisualProperties,function(a,b){return"cls"===a&&b?GPattern.deserialize(b):b}),this.restoreProperties(c,b.MetaProperties),c.__active&&this.setFlag(GNode.Flag.Active)),this._handleVisualChangeForProperties(a,c,b.VisualProperties),a==GNode._Change.AfterPropertiesChange){var d=c.properties.indexOf("tp");if(d>=0){var e=c.values[d];e===b.Type.Guide&&this.$cls===b.GUIDE_COLOR_DEFAULT?this.$cls=b.VisualProperties.cls:this.$tp===b.Type.Guide&&this.$cls===b.VisualProperties.cls&&(this.$cls=b.GUIDE_COLOR_DEFAULT),this._notifyChange(GElement._Change.InvalidationRequest)}}GBlock.prototype._handleChange.call(this,a,c)},a.GLayer=b}(this),function(a){GStyle=function(){GNode.call(this),this._setDefaultProperties(GStyle.MetaProperties),this._setStyleDefaultProperties()},GNode.inheritAndMix("style",GStyle,GNode,[GNode.Properties,GNode.Store,GNode.Reference,GStylable]),GStyle.MetaProperties={name:null,ps:[GStylable.PropertySet.Style,GStylable.PropertySet.Effects,GStylable.PropertySet.Fill,GStylable.PropertySet.Border,GStylable.PropertySet.Text,GStylable.PropertySet.Paragraph]},GStyle.prototype.assignStyleFrom=function(a){var b=this.getScene();b&&b.visitLinks(this,function(b){b!==a&&b.hasMixin(GStylable)&&b.assignStyleFrom(a,this)}.bind(this)),this._beginBlockChanges([GNode._Change.BeforePropertiesChange,GNode._Change.AfterPropertiesChange]);try{GStylable.prototype.assignStyleFrom.call(this,a)}finally{this._endBlockChanges([GNode._Change.BeforePropertiesChange,GNode._Change.AfterPropertiesChange])}},GStyle.prototype.disconnectStyle=function(){var a=this.getScene();a&&a.visitLinks(this,function(a){a.hasMixin(GElement.Stylable)&&a.setProperty("sref",null)})},GStyle.prototype.getStylePropertySets=function(){return this.$ps},GStyle.prototype.validateInsertion=function(a){return a instanceof GScene.StyleCollection},GStyle.prototype._stylePropertiesUpdated=function(){var a=this.getScene();a&&a.visitLinks(this,function(a){a.hasMixin(GStylable)&&a.assignStyleFrom(this)}.bind(this))},GStyle.prototype._handleChange=function(a,b){a===GNode._Change.Store?this.storeProperties(b,GStyle.MetaProperties):a===GNode._Change.Restore&&this.restoreProperties(b,GStyle.MetaProperties),this._handleStyleChange(a,b),GNode.prototype._handleChange.call(this,a,b)},GStyle.prototype.toString=function(){return"[Mixin GStyle]"},a.GStyle=GStyle}(this),function(a){function b(){GNode.call(this),this._setDefaultProperties(b.VisualProperties,b.MetaProperties)}GNode.inheritAndMix("swatch",b,GNode,[GNode.Store,GNode.Properties]),b.VisualProperties={pat:null},b.MetaProperties={name:null},b.prototype.validateInsertion=function(a){return a instanceof GScene.SwatchCollection},b.prototype._handleChange=function(a,c){a===GNode._Change.Store?(this.storeProperties(c,b.VisualProperties,function(a,b){return b&&"pat"===a?GPattern.serialize(b):b}),this.storeProperties(c,b.MetaProperties)):a===GNode._Change.Restore&&(this.restoreProperties(c,b.VisualProperties,function(a,b){return b&&"pat"===a?GPattern.deserialize(b):void 0}),this.restoreProperties(c,b.MetaProperties)),GNode.prototype._handleChange.call(this,a,c)},a.GSwatch=b}(this),function(a){function b(){GItem.call(this)}GNode.inheritAndMix("group",b,GItem,[GNode.Container,GElement.Transform,GElement.Stylable]),b.prototype.validateInsertion=function(a){return a instanceof GLayer||a instanceof b},b.prototype._paintStyleContent=function(a){this._paintChildren(a)},b.prototype._detailHitTest=function(){return new GElement.HitResultInfo(this)},a.GGroup=b}(this),function(a){function b(){GItem.call(this),this._setDefaultProperties(b.GeometryProperties)}GObject.inheritAndMix(b,GItem,[GNode.Container,GElement.Transform,GElement.Stylable,GVertexSource]),b.GeometryProperties={trf:null},b.HitResult=function(a,b){this.type=a,this.vertex=b},b.HitResult.Type={Stroke:0,Fill:1,Outline:2,Other:3},b.HitResult.prototype.type=null,b.HitResult.prototype.vertexHit=null,b.prototype._origGeometryBBox=null,b.prototype.assignFrom=function(a){GBlock.prototype.assignFrom.call(this,a),a instanceof b&&this.transferProperties(a,[b.GeometryProperties])},b.prototype.getStylePropertySets=function(){return GElement.Stylable.prototype.getStylePropertySets.call(this).concat(GStylable.PropertySet.Fill,GStylable.PropertySet.Border)},b.prototype.getTransform=function(){return this.$trf},b.prototype.setTransform=function(a){this.setProperty("trf",a)},b.prototype.transform=function(a){a&&!a.isIdentity()&&this.setProperty("trf",this.$trf?this.$trf.multiplied(a):a),GElement.Transform.prototype._transformChildren.call(this,a)},b.prototype.validateInsertion=function(a){return a instanceof GLayer||a instanceof GGroup||a instanceof b},b.prototype._paintStyleLayer=function(a,b){b===GStylable.StyleLayer.Fill?(this._paintFill(a),this._paintContents(a)):b===GStylable.StyleLayer.Border&&this._paintBorder(a)},b.prototype._isSeparateStylePaintLayer=function(a,b){var c=GElement.Stylable.prototype._isSeparateStylePaintLayer.call(this,a,b);if(c)return!0;if(b===GStylable.StyleLayer.Border){if(this.$_ba!==GStylable.BorderAlignment.Center)return!0;if(this.hasStyleBorder()&&!(this.$_bpt instanceof GColor))return!0}return!1},b.prototype._calculateGeometryBBox=function(){return ifVertexInfo.calculateBounds(this,!0)},b.prototype._calculatePaintBBox=function(){var a=this.getGeometryBBox();if(!a)return null;var b=this.getEffects(),c=a;if(this.hasStyleFill()){var d=b.getEffectsBBox(a,GStylable.StyleLayer.Fill);c=c.united(d)}if(this.hasStyleBorder()){var e=a,f=this.getStyleBorderPadding();f&&(this._requireMiterLimitApproximation()&&this.$_blj===GPaintCanvas.LineJoin.Miter&&this.$_bml>0&&(f*=this.$_bml),e=e.expanded(f,f,f,f));var g=b.getEffectsBBox(e,GStylable.StyleLayer.Border);c=c.united(g)}c=b.getEffectsBBox(c);for(var h=this;null!==h&&(h.hasMixin(GStylable)&&!(h.getStylePropertySets().indexOf(GStylable.PropertySet.Effects)<0));h=h.getParent())c=h.getEffects().getEffectsBBox(c);return c},b.prototype._requireMiterLimitApproximation=function(){return!1},b.prototype._isEvenOddFill=function(){return!1},b.prototype._createShapePaint=function(a,b,c){if(b instanceof GBackground){var d=a.getRootCanvas(),e=d.getOrigin(),f=d.getScale();return{paint:a.canvas.createTexture(d,GPaintCanvas.RepeatMode.None),transform:(new GTransform).translated(e.getX(),e.getY()).scaled(1/f,1/f)}}return b?a.canvas.createPatternPaint(b,c):null},b.prototype._calculateOrigGeometryBBox=function(){var a=this.getGeometryBBox();return this.$trf&&(a=this.$trf.inverted().mapRect(a)),a},b.prototype._getOrigBBox=function(){return this.isVisible()?((null==this._geometryBBbox||null==this._origGeometryBBox)&&(this._origGeometryBBox=this._calculateOrigGeometryBBox()),this._origGeometryBBox):null},b.prototype._paintFill=function(a){if(!a.configuration.isOutline(a)&&this.hasStyleFill()){var b=this._createShapePaint(a,this.$_fpt,this._getOrigBBox());if(b){var c=a.canvas;if(c.putVertices(this),b.transform){this.$trf&&(b.transform=b.transform.multiplied(this.$trf)),this.$_fpx&&!this.$_fpx.isIdentity()&&(b.transform=b.transform.preMultiplied(this.$_fpx));var d=c.setTransform(c.getTransform(!0).preMultiplied(b.transform));c.fillVertices(b.paint,this.$_fop),c.setTransform(d)}else c.fillVertices(b.paint,this.$_fop,null,this._isEvenOddFill())}}},b.prototype._paintContents=function(a){for(var b=null,c=this.getFirstChild();null!==c;c=c.getNext())c instanceof GElement&&(b||(b=a.pushCanvas(a.canvas.createCanvas(this.getGeometryBBox()))),c.paint(a));b&&(a.canvas.putVertices(this),a.canvas.fillVertices(GRGBColor.BLACK,1,GPaintCanvas.CompositeOperator.DestinationIn),b.drawCanvas(a.canvas),a.canvas.finish(),a.popCanvas())},b.prototype._paintBorder=function(a){var b=a.configuration.isOutline(a);if(!b&&this.hasStyleBorder()){var c=this._createShapePaint(a,this.$_bpt,this._getOrigBBox());if(c&&c.paint){var d=a.canvas,e=this.$_bw;if(this.$_ba!==GStylable.BorderAlignment.Center&&(e*=2),a.canvas.putVertices(this),c.transform){this.$trf&&(c.transform=c.transform.multiplied(this.$trf)),this.$_bpx&&!this.$_bpx.isIdentity()&&(c.transform=c.transform.preMultiplied(this.$_bpx));var f=d.setTransform(d.getTransform(!0).multiplied(c.transform)),g=this.getGeometryBBox(),h=this.getStyleBorderPadding();h&&(this._requireMiterLimitApproximation()&&this.$_blj===GPaintCanvas.LineJoin.Miter&&this.$_bml>0&&(h*=this.$_bml),g=g.expanded(h,h,h,h));var i=c.transform.inverted().mapRect(g);d.fillRect(i.getX(),i.getY(),i.getWidth(),i.getHeight(),c.paint,this.$_bop),d.setTransform(f),d.strokeVertices(c.paint,e,this.$_blc,this.$_blj,this.$_bml,1,GPaintCanvas.CompositeOperator.DestinationIn)}else d.strokeVertices(c.paint,e,this.$_blc,this.$_blj,this.$_bml,this.$_bop);this.$_ba===GStylable.BorderAlignment.Inside?d.fillVertices(GRGBColor.BLACK,1,GPaintCanvas.CompositeOperator.DestinationIn):this.$_ba===GStylable.BorderAlignment.Outside&&d.fillVertices(GRGBColor.BLACK,1,GPaintCanvas.CompositeOperator.DestinationOut)}}else if(b){var j=a.canvas.resetTransform(),k=new GVertexTransformer(this,j);a.canvas.putVertices(k),a.canvas.strokeVertices(a.getOutlineColor()),a.canvas.setTransform(j)}},b.prototype._handleChange=function(a,c){this._handleGeometryChangeForProperties(a,c,b.GeometryProperties),a==GElement._Change.FinishGeometryUpdate&&(this._origGeometryBBox=null),a===GNode._Change.Store?this.storeProperties(c,b.GeometryProperties,function(a,b){return"trf"===a&&b?GTransform.serialize(b):b}):a===GNode._Change.Restore&&this.restoreProperties(c,b.GeometryProperties,function(a,b){return"trf"===a&&b?GTransform.deserialize(b):b}),GItem.prototype._handleChange.call(this,a,c)},b.prototype._invalidateGeometryForChildUpdate=function(){},b.prototype._detailHitTest=function(a,c,d,e){if(this.hasStyleBorder()){var f=this.$_bw*c.getScaleFactor()+2*d,g=new GVertexInfo.HitResult;if(ifVertexInfo.hitTest(a.getX(),a.getY(),new GVertexTransformer(this,c),f,!1,g))return new GElement.HitResultInfo(this,new b.HitResult(b.HitResult.Type.Border,g))}if(this.hasStyleFill()||e){var g=new GVertexInfo.HitResult;if(ifVertexInfo.hitTest(a.getX(),a.getY(),new GVertexTransformer(this,c),d,!0,g))return new GElement.HitResultInfo(this,new b.HitResult(this.hasStyleFill()?b.HitResult.Type.Fill:b.HitResult.Type.Other,g))}if(d){var g=new GVertexInfo.HitResult;if(ifVertexInfo.hitTest(a.getX(),a.getY(),new GVertexTransformer(this,c),c.getScaleFactor()+2*d,!1,g))return new GElement.HitResultInfo(this,new b.HitResult(b.HitResult.Type.Outline,g))}return null},b.prototype.getCenter=function(a){var b=new GPoint(0,0);return a&&this.$trf&&(b=this.$trf.mapPoint(b)),b},b.prototype.getOrigHalfWidth=function(){return 1},b.prototype.getOrigHalfHeight=function(){return 1},b.prototype.toString=function(){return"[GShape]"},a.GShape=b}(this),function(a){function b(a,c){GShape.call(this),this._setDefaultProperties(b.VisualProperties),null!==a&&(this.$evenodd=a),this._anchorPoints=c?c:new b.AnchorPoints,this._anchorPoints._parent=this,this._anchorPoints._setScene(this._scene),this._anchorPoints._removalAllowed=!1,this._vertices=new GVertexContainer,this._verticesDirty=!0}GObject.inherit(b,GShape),b.CornerType={Rounded:"R",InverseRounded:"U",Bevel:"B",Inset:"I",Fancy:"F"},b.isCornerType=function(a){for(var c in b.CornerType)if(b[c]===a)return!0;return!1},b.VisualProperties={evenodd:!1},b.createPathFromVertexSource=function(a){var c=new GVertex,d=[],e=null,f=null,g=null,h=!1;for(a.rewindVertices(0);!h&&a.readVertex(c);)switch(c.command){case GVertex.Command.Move:e&&f&&f.getFirstChild()!=f.getLastChild()&&d.push(e),e=new GPath,f=e.getAnchorPoints(),g=new b.AnchorPoint,g.setProperties(["x","y"],[c.x,c.y]),f.appendChild(g);break;case GVertex.Command.Line:g=new b.AnchorPoint,g.setProperties(["x","y"],[c.x,c.y]),f.appendChild(g);break;case GVertex.Command.Curve:g=new b.AnchorPoint;var i=new GVertex;a.readVertex(i)?(g.setProperties(["x","y","hlx","hly"],[c.x,c.y,i.x,i.y]),f.appendChild(g)):(g.setProperties(["x","y"],[c.x,c.y]),f.appendChild(g),h=!0,e.setProperty("closed",!0));break;case GVertex.Command.Curve2:var i=new GVertex;a.readVertex(i)?(g&&g.setProperties(["hrx","hry"],[i.x,i.y]),a.readVertex(i)?(g=new b.AnchorPoint,g.setProperties(["x","y","hlx","hly"],[c.x,c.y,i.x,i.y]),f.appendChild(g)):(g=new b.AnchorPoint,g.setProperties(["x","y"],[c.x,c.y]),f.appendChild(g),h=!0,e.setProperty("closed",!0))):(g=new b.AnchorPoint,g.setProperties(["x","y"],[c.x,c.y]),f.appendChild(g),h=!0,e.setProperty("closed",!0));break;case GVertex.Command.Close:e.setProperty("closed",!0)}if(e&&f&&f.getFirstChild()!=f.getLastChild()&&d.push(e),1===d.length)return d[0];if(d.length>1){for(var j=new GCompoundPath,k=0;k<d.length;++k)j.getAnchorPaths().appendChild(d[k]);return j}return null},b.AnchorPoint=function(){this._setDefaultProperties(b.AnchorPoint.GeometryProperties),this._leadHr=!1},GObject.inheritAndMix(b.AnchorPoint,GNode,[GNode.Properties]),b.AnchorPoint.Type={Asymmetric:"TA",Symmetric:"TS",Mirror:"TM",Connector:"TC"},b.AnchorPoint.GeometryProperties={tp:b.AnchorPoint.Type.Asymmetric,x:0,y:0,hlx:null,hly:null,hrx:null,hry:null,ah:!1,cu:!0,cl:0,cr:0},b.AnchorPoint.BEST_CIRCLE_COEFF=.55191502,b.AnchorPoint.HANDLE_COEFF=.39026286,b.AnchorPoint.prototype.validateInsertion=function(a){return a instanceof b.AnchorPoints},b.AnchorPoint.prototype.serialize=function(){var a=[];return null!==this.$tp&&this.$tp!==b.AnchorPoint.GeometryProperties.tp&&a.push(this.$tp),this.$ah&&this.$ah!==b.AnchorPoint.GeometryProperties.ah&&a.push(this.$ah),a.push(this.$x),a.push(this.$y),this.$ah||((null!==this.$hlx||null!==this.$hly)&&(a.push("h"),a.push(this.$hlx),a.push(this.$hly)),(null!==this.$hrx||null!==this.$hry)&&(a.push("H"),a.push(this.$hrx),a.push(this.$hry))),(null!==this.$cl&&!GMath.isEqualEps(this.$cl,b.AnchorPoint.GeometryProperties.cl)||null!==this.$cr&&!GMath.isEqualEps(this.$cr,b.AnchorPoint.GeometryProperties.cr))&&(a.push("C"),a.push(this.$cl),a.push(this.$cr)),a},b.AnchorPoint.prototype.deserialize=function(a){var b=0;for(a.length>0&&"string"==typeof a[0]&&(this.$tp=a[0],b++),a.length>b&&"boolean"==typeof a[b]&&(this.$ah=a[b],b++),b+1<a.length&&(this.$x=a[b],this.$y=a[b+1],b+=2);b+2<a.length;)"h"===a[b]?(this.$hlx=a[b+1],this.$hly=a[b+2]):"H"===a[b]?(this.$hrx=a[b+1],this.$hry=a[b+2]):"C"===a[b]&&(this.$cl=a[b+1],this.$cr=a[b+2]),b+=3},b.AnchorPoint.prototype._getTransformedCopy=function(a){var c=new b.AnchorPoint,d=null!==this.$hlx?a.mapPoint(new GPoint(this.$hlx,this.$hly)):null,e=null!==this.$hrx?a.mapPoint(new GPoint(this.$hrx,this.$hry)):null,f=a.mapPoint(new GPoint(this.$x,this.$y));return c.$x=f.getX(),c.$y=f.getY(),c.$hlx=d?d.getX():null,c.$hly=d?d.getY():null,c.$hrx=e?e.getX():null,c.$hry=e?e.getY():null,c.$cl=this.$cl,c.$cr=this.$cr,c.$ah=this.$ah,c.$tp=this.$tp,c},b.AnchorPoint.prototype.getLeftShoulderPoint=function(a){if(this.getPath()&&this.$cl&&(a||this.$cr)){var b=this._parent.getPreviousPoint(this);return this._parent._getLeftShoulderPoint(this,b)}return null},b.AnchorPoint.prototype.getLeftShoulderPointTransformed=function(a,b){var c=null;if(this.getPath()&&this.$cl&&(b||this.$cr)){var d=this._parent.getPreviousPoint(this),e=this._getTransformedCopy(a),f=d._getTransformedCopy(a);c=this._parent._getLeftShoulderPoint(e,f)}return c},b.AnchorPoint.prototype.getRightShoulderPoint=function(a){if(this.getPath()&&this.$cr&&(a||this.$cl)){var b=this._parent.getNextPoint(this);return this._parent._getRightShoulderPoint(this,b)}return null},b.AnchorPoint.prototype.getRightShoulderPointTransformed=function(a,b){var c=null;if(this.getPath()&&this.$cr&&(b||this.$cl)){var d=this._parent.getNextPoint(this),e=this._getTransformedCopy(a),f=d._getTransformedCopy(a);c=this._parent._getRightShoulderPoint(e,f)}return c},b.AnchorPoint.prototype.getLeftShoulderLimitPoint=function(){var a=null;if(this.getPath()){var b=this._parent.getPreviousPoint(this);b&&(a=this._parent._getLeftShoulderPoint(this,b,!0))}return a},b.AnchorPoint.prototype.getRightShoulderLimitPoint=function(){var a=null;if(this.getPath()){var b=this._parent.getNextPoint(this);b&&(a=this._parent._getRightShoulderPoint(this,b,!0))}return a},b.AnchorPoint.prototype._handleChange=function(a,c){var d=this.getPath();if((a==GNode._Change.BeforePropertiesChange||a==GNode._Change.AfterPropertiesChange)&&GUtil.containsObjectKey(c.properties,b.AnchorPoint.GeometryProperties))if(a===GNode._Change.BeforePropertiesChange){var e=c.properties.indexOf("cu"),f=e>=0?c.values[e]:this.$cu;if(f){var g=c.properties.indexOf("cl"),h=c.properties.indexOf("cr");if(g>=0){var i=c.values[g];this.$cr!=i&&(h>=0?c.values[h]=i:(c.properties.push("cr"),c.values.push(i)))}else if(h>=0){var i=c.values[h];this.$cl!=i&&(c.properties.push("cl"),c.values.push(i))}}d&&d._notifyChange(GElement._Change.PrepareGeometryUpdate)}else if(a===GNode._Change.AfterPropertiesChange&&((this.$tp==b.AnchorPoint.Type.Symmetric&&!this.$ah&&null!=this.$hlx&&null!=this.$hrx||this.$tp==b.AnchorPoint.Type.Mirror&&!this.$ah&&(null!=this.$hlx||null!=this.$hrx))&&(this._leadHr=(c.properties.indexOf("hrx")>=0||c.properties.indexOf("hry")>=0)&&c.properties.indexOf("hlx")<0&&c.properties.indexOf("hly")<0||c.properties.indexOf("tp")>=0&&c.properties.indexOf("hlx")<0&&c.properties.indexOf("hly")<0&&null!=this.$hrx?!0:!1),(d||this.$tp==b.AnchorPoint.Type.Symmetric&&!this.$ah&&null!=this.$hlx&&null!=this.$hrx||this.$tp==b.AnchorPoint.Type.Mirror&&!this.$ah&&(null!=this.$hlx||null!=this.$hrx))&&this._invalidateCalculations(),d)){if(this._parent)if(c.properties.indexOf("x")>=0||c.properties.indexOf("y")>=0)this._parent._invalidateLeft(this._parent.getPreviousPoint(this)),this._parent._invalidateRight(this._parent.getNextPoint(this));else if(c.properties.indexOf("tp")>=0){var j=this._parent.getPreviousPoint(this);j&&(j.$ah||j.$tp==b.AnchorPoint.Type.Connector)&&j._invalidateCalculations();var k=this._parent.getNextPoint(this);k&&(k.$ah||k.$tp==b.AnchorPoint.Type.Connector)&&k._invalidateCalculations()}d._verticesDirty=!0,d._notifyChange(GElement._Change.FinishGeometryUpdate)}GNode.prototype._handleChange.call(this,a,c)},b.AnchorPoint.prototype.getPath=function(){return this._parent?this._parent._parent:null},b.AnchorPoint.prototype._invalidateCalculations=function(){var a=this._parent;a&&this.$tp==b.AnchorPoint.Type.Connector?this._calculateConnectorPoint():this.$tp!=b.AnchorPoint.Type.Symmetric||this.$ah?this.$tp!=b.AnchorPoint.Type.Mirror||this.$ah?a&&this.$ah&&this._calculateAutoHandles():this._calculateMirrorPoint():this._calculateSmoothPoint()},b.AnchorPoint.prototype._calculateConnectorPoint=function(){var a=this._parent;if(a){var c=a.getPreviousPoint(this),d=a.getNextPoint(this),e=0,f=0;d&&(f=Math.sqrt(GMath.ptSqrDist(this.$x,this.$y,d.$x,d.$y))),c&&(e=Math.sqrt(GMath.ptSqrDist(this.$x,this.$y,c.$x,c.$y)));var g,h,i;this.$ah?(!d||!c||d.$tp!=b.AnchorPoint.Type.Symmetric&&d.$tp!=b.AnchorPoint.Type.Mirror||GMath.isEqualEps(f,0)||GMath.isEqualEps(e,0)?this.setProperties(["hrx","hry"],[null,null]):(g=f*b.AnchorPoint.HANDLE_COEFF,h=this.$x+(this.$x-c.$x)/e*g,i=this.$y+(this.$y-c.$y)/e*g,this.setProperties(["hrx","hry"],[h,i])),!c||!d||c.$tp!=b.AnchorPoint.Type.Symmetric&&c.$tp!=b.AnchorPoint.Type.Mirror||GMath.isEqualEps(f,0)||GMath.isEqualEps(e,0)?this.setProperties(["hlx","hly"],[null,null]):(g=e*b.AnchorPoint.HANDLE_COEFF,h=this.$x+(this.$x-d.$x)/f*g,i=this.$y+(this.$y-d.$y)/f*g,this.setProperties(["hlx","hly"],[h,i]))):(null!=this.$hlx&&d&&!GMath.isEqualEps(f,0)&&(g=Math.sqrt(GMath.ptSqrDist(this.$x,this.$y,this.$hlx,this.$hly)),h=this.$x+(this.$x-d.$x)/f*g,i=this.$y+(this.$y-d.$y)/f*g,this.setProperties(["hlx","hly"],[h,i])),null!=this.$hrx&&c&&!GMath.isEqualEps(e,0)&&(g=Math.sqrt(GMath.ptSqrDist(this.$x,this.$y,this.$hrx,this.$hry)),h=this.$x+(this.$x-c.$x)/e*g,i=this.$y+(this.$y-c.$y)/e*g,this.setProperties(["hrx","hry"],[h,i])))}},b.AnchorPoint.prototype._calculateSmoothPoint=function(){var a,b,c,d;null!=this.$hlx&&null!=this.$hrx&&(this._leadHr?(b=Math.sqrt(GMath.ptSqrDist(this.$x,this.$y,this.$hrx,this.$hry)),GMath.isEqualEps(b,0)||(a=Math.sqrt(GMath.ptSqrDist(this.$x,this.$y,this.$hlx,this.$hly)),c=this.$x+(this.$x-this.$hrx)/b*a,d=this.$y+(this.$y-this.$hry)/b*a,this.setProperties(["hlx","hly"],[c,d]))):(b=Math.sqrt(GMath.ptSqrDist(this.$x,this.$y,this.$hlx,this.$hly)),GMath.isEqualEps(b,0)||(a=Math.sqrt(GMath.ptSqrDist(this.$x,this.$y,this.$hrx,this.$hry)),c=this.$x+(this.$x-this.$hlx)/b*a,d=this.$y+(this.$y-this.$hly)/b*a,this.setProperties(["hrx","hry"],[c,d]))))},b.AnchorPoint.prototype._calculateMirrorPoint=function(){if(this._leadHr&&null!=this.$hrx){var a=this.$x+(this.$x-this.$hrx),b=this.$y+(this.$y-this.$hry);(this.$hlx!=a||this.$hly!=b)&&this.setProperties(["hlx","hly"],[a,b])}else if(!this._leadHr&&null!=this.$hlx){var a=this.$x+(this.$x-this.$hlx),b=this.$y+(this.$y-this.$hly);(this.$hrx!=a||this.$hry!=b)&&this.setProperties(["hrx","hry"],[a,b])}},b.AnchorPoint.prototype._calculateAutoHandles=function(){var a=this._parent;if(a){var c,d,e,f,g,h,i,j,k,l=a.getPreviousPoint(this),m=a.getNextPoint(this),n=b.AnchorPoint.HANDLE_COEFF;if(this.$tp==b.AnchorPoint.Type.Symmetric||this.$tp==b.AnchorPoint.Type.Mirror){if(!m&&!l)return;m&&!l||m&&this.$x==l.$x&&this.$y==l.$y?(c=this.$x+(m.$x-this.$x)*n,d=this.$y+(m.$y-this.$y)*n,this.setProperties(["hlx","hly","hrx","hry"],[this.$x+this.$x-c,this.$y+this.$y-d,c,d])):l&&!m||l&&this.$x==m.$x&&this.$y==m.$y?(c=this.$x+(l.$x-this.$x)*n,d=this.$y+(l.$y-this.$y)*n,this.setProperties(["hlx","hly","hrx","hry"],[c,d,this.$x+this.$x-c,this.$y+this.$y-d])):l&&m&&(g=GMath.getCircumcircleCenter(l.$x,l.$y,this.$x,this.$y,m.$x,m.$y),null==g?(h=(this.$y-l.$y)*n,i=(l.$x-this.$x)*n,this.setProperties(["hlx","hly","hrx","hry"],[this.$x-h,this.$y-i,this.$x+h,this.$y+i])):(e=Math.sqrt(GMath.ptSqrDist(this.$x,this.$y,g.getX(),g.getY())),h=(this.$y-g.getY())/e,i=(g.getX()-this.$x)/e,j=(l.$x+m.$x)/2,k=(l.$y+m.$y)/2,GMath.segmentSide(this.$x,this.$y,j,k,l.$x,l.$y)!=GMath.segmentSide(this.$x,this.$y,j,k,this.$x-h,this.$y-i)&&(h=-h,i=-i),f=Math.sqrt(GMath.ptSqrDist(this.$x,this.$y,l.$x,l.$y))*n,this.setProperties(["hlx","hly"],[this.$x-h*f,this.$y-i*f]),f=Math.sqrt(GMath.ptSqrDist(this.$x,this.$y,m.$x,m.$y))*n,this.setProperties(["hrx","hry"],[this.$x+h*f,this.$y+i*f])))}else{if(l&&(l.$x!=this.$x||l.$y!=this.$y))if(l.$tp==b.AnchorPoint.Type.Symmetric||l.$tp==b.AnchorPoint.Type.Mirror){var o=a.getPreviousPoint(l);!o||l.$x==o.$x&&l.$y==o.$y?(c=this.$x+(l.$x-this.$x)*n,d=this.$y+(l.$y-this.$y)*n,this.setProperties(["hlx","hly"],[c,d])):(g=GMath.getCircumcircleCenter(this.$x,this.$y,l.$x,l.$y,o.$x,o.$y),null==g?(h=(this.$y-l.$y)*n,i=(l.$x-this.$x)*n,this.setProperties(["hlx","hly"],[this.$x-h,this.$y-i])):(e=Math.sqrt(GMath.ptSqrDist(this.$x,this.$y,g.getX(),g.getY())),h=(this.$y-g.getY())/e,i=(g.getX()-this.$x)/e,j=(l.$x+o.$x)/2,k=(l.$y+o.$y)/2,GMath.segmentSide(this.$x,this.$y,j,k,l.$x,l.$y)!=GMath.segmentSide(this.$x,this.$y,j,k,this.$x-h,this.$y-i)&&(h=-h,i=-i),f=Math.sqrt(GMath.ptSqrDist(this.$x,this.$y,l.$x,l.$y))*n,this.setProperties(["hlx","hly"],[this.$x-h*f,this.$y-i*f])))}else this.setProperties(["hlx","hly"],[null,null]);if(m&&(m.$x!=this.$x||m.$y!=this.$y))if(m.$tp==b.AnchorPoint.Type.Symmetric||m.$tp==b.AnchorPoint.Type.Mirror){var p=a.getNextPoint(m);!p||m.$x==p.$x&&m.$y==p.$y?(c=this.$x+(m.$x-this.$x)*n,d=this.$y+(m.$y-this.$y)*n,this.setProperties(["hrx","hry"],[c,d])):(g=GMath.getCircumcircleCenter(this.$x,this.$y,m.$x,m.$y,p.$x,p.$y),null==g?(h=(this.$y-m.$y)*n,i=(m.$x-this.$x)*n,this.setProperties(["hrx","hry"],[this.$x-h,this.$y-i])):(e=Math.sqrt(GMath.ptSqrDist(this.$x,this.$y,g.getX(),g.getY())),h=(this.$y-g.getY())/e,i=(g.getX()-this.$x)/e,j=(m.$x+p.$x)/2,k=(m.$y+p.$y)/2,GMath.segmentSide(this.$x,this.$y,j,k,m.$x,m.$y)!=GMath.segmentSide(this.$x,this.$y,j,k,this.$x+h,this.$y+i)&&(h=-h,i=-i),f=Math.sqrt(GMath.ptSqrDist(this.$x,this.$y,m.$x,m.$y))*n,this.setProperties(["hrx","hry"],[this.$x+h*f,this.$y+i*f])))}else this.setProperties(["hrx","hry"],[null,null])}}},b.AnchorPoint.prototype.toString=function(){return"[Object GPathBase.AnchorPoint]"},b.AnchorPoints=function(){},GObject.inheritAndMix(b.AnchorPoints,GNode,[GNode.Container]),b.AnchorPoints.prototype._dirtyPrev=null,b.AnchorPoints.prototype._dirtyNext=null,b.AnchorPoints.prototype._removalAllowed=!1,b.AnchorPoints.prototype.validateInsertion=function(a){return a instanceof b},b.AnchorPoints.prototype.validateRemoval=function(){return this._removalAllowed?this._removalAllowed:!1},b.AnchorPoints.prototype.serialize=function(){for(var a=[],b=this.getFirstChild();null!==b;b=b.getNext())a.push(b.serialize());return a},b.AnchorPoints.prototype.deserialize=function(a){for(var c=0;c<a.length;++c){var d=new b.AnchorPoint;d.deserialize(a[c]),this.appendChild(d)}},b.AnchorPoints.prototype._invalidateLeft=function(a){if(a&&((a.$ah||a.$tp==b.AnchorPoint.Type.Connector)&&a._invalidateCalculations(),a.$tp==b.AnchorPoint.Type.Symmetric||a.$tp==b.AnchorPoint.Type.Mirror)){var c=this.getPreviousPoint(a);c&&c.$ah&&c._invalidateCalculations()}},b.AnchorPoints.prototype._invalidateRight=function(a){if(a&&((a.$ah||a.$tp==b.AnchorPoint.Type.Connector)&&a._invalidateCalculations(),a.$tp==b.AnchorPoint.Type.Symmetric||a.$tp==b.AnchorPoint.Type.Mirror)){var c=this.getNextPoint(a);c&&c.$ah&&c._invalidateCalculations()}},b.AnchorPoints.prototype._generateVertices=function(a,c,d){var e,f,g,h;if(h=this.getFirstChild()){var i,j=this._parent;if(d&&h.$tp!=b.AnchorPoint.Type.Asymmetric&&h.$tp!=b.AnchorPoint.Type.Connector&&h.$tp!=b.AnchorPoint.Type.Symmetric&&h.$tp!=b.AnchorPoint.Type.Mirror&&j&&j.$closed&&h!=this.getLastChild()?(e=this._getPathStartPt(c),f=e.getX(),g=e.getY()):(i=c?h._getTransformedCopy(c):h,f=i.$x,g=i.$y),a.addVertex(GVertex.Command.Move,f,g),h!=this.getLastChild()){var k=h;h=h.getNext();var l,m,n=h,o=!1,p=this.getNextPoint(h);for(c&&(i=h._getTransformedCopy(c),l=k._getTransformedCopy(c));p&&(h!=n||!o);)o=!0,c?(m=p._getTransformedCopy(c),this._addMiddleVertices(a,i,l,m,d),l=i,i=m):this._addMiddleVertices(a,h,k,p,d),k=h,h=p,p=this.getNextPoint(p);p?a.addVertex(GVertex.Command.Close,0,0):this._addPathEndVertices(a,c)}}},b.AnchorPoints.prototype._getPathStartPt=function(a){var c=this.getFirstChild(),d=this.getPreviousPoint(c),e=this.getNextPoint(c);return a&&(c=c._getTransformedCopy(a),e=e._getTransformedCopy(a),d=d._getTransformedCopy(a)),c.$cl&&c.$cr&&c.$tp!=b.AnchorPoint.Type.Asymmetric&&c.$tp!=b.AnchorPoint.Type.Connector&&c.$tp!=b.AnchorPoint.Type.Symmetric&&c.$tp!=b.AnchorPoint.Type.Mirror&&d&&(d.$tp!=b.AnchorPoint.Type.Connector||d.$x!=c.$x||d.$y!=c.$y)?this._getRightShoulderPoint(c,e):new GPoint(c.$x,c.$y)},b.AnchorPoints.prototype._getShoulderPoint=function(a,b,c,d,e,f){var g,h,i,j=GMath.ptDist(a,b,d,e);h=null==c||0>=c?0:c,i=null==f||0>=f?0:f;var k=h+i;return 0>=k?null:(g=j>=k?h:j*h/k,GMath.getPointAtLength(a,b,d,e,g))},b.AnchorPoints.prototype._getRightShoulderPoint=function(a,b,c){var d=null,e=null;null!=a.$hrx?(d=a.$hrx,e=a.$hry):null!=b.$hlx&&(d=b.$hlx,e=b.$hly);var f;return f=null!=d?c?new GPoint(d,e):GMath.getPointAtLength(a.$x,a.$y,d,e,a.$cr):c?new GPoint(b.$x,b.$y):this._getShoulderPoint(a.$x,a.$y,a.$cr,b.$x,b.$y,b.$cl)},b.AnchorPoints.prototype._getLeftShoulderPoint=function(a,b,c){var d=null,e=null;null!=a.$hlx?(d=a.$hlx,e=a.$hly):null!=b.$hrx&&(d=b.$hrx,e=b.$hry);var f;return f=null!=d?c?new GPoint(d,e):GMath.getPointAtLength(a.$x,a.$y,d,e,a.$cl):c?new GPoint(b.$x,b.$y):this._getShoulderPoint(a.$x,a.$y,a.$cl,b.$x,b.$y,b.$cr)},b.AnchorPoints.prototype._addMiddleVertices=function(a,c,d,e,f){var g,h,i=null,j=null,k=null,l=null;null!=c.$hlx&&null!=c.$hly&&null!=d.$hrx&&null!=d.$hry?(k=d.$hrx,l=d.$hry,i=c.$hlx,j=c.$hly):null!=c.$hlx&&null!=c.$hly?(k=c.$hlx,l=c.$hly):null!=d.$hrx&&null!=d.$hry&&(k=d.$hrx,l=d.$hry),f&&c.$tp!=b.AnchorPoint.Type.Asymmetric&&c.$tp!=b.AnchorPoint.Type.Connector&&c.$tp!=b.AnchorPoint.Type.Symmetric&&c.$tp!=b.AnchorPoint.Type.Mirror&&c.$cl&&c.$cr?(null==k?(g=this._getShoulderPoint(c.$x,c.$y,c.$cl,d.$x,d.$y,d.$cr),a.addVertex(GVertex.Command.Line,g.getX(),g.getY())):null==i?(g=GMath.getPointAtLength(c.$x,c.$y,k,l,c.$cl),a.addVertex(GVertex.Command.Curve,g.getX(),g.getY()),a.addVertex(GVertex.Command.Curve,k,l)):(g=GMath.getPointAtLength(c.$x,c.$y,i,j,c.$cl),a.addVertex(GVertex.Command.Curve2,g.getX(),g.getY()),a.addVertex(GVertex.Command.Curve2,k,l),a.addVertex(GVertex.Command.Curve2,i,j)),h=this._getRightShoulderPoint(c,e),this._addCornerToVertices(a,g.getX(),g.getY(),h.getX(),h.getY(),c.$x,c.$y,c.$tp)):null==k?a.addVertex(GVertex.Command.Line,c.$x,c.$y):null==i?(a.addVertex(GVertex.Command.Curve,c.$x,c.$y),a.addVertex(GVertex.Command.Curve,k,l)):(a.addVertex(GVertex.Command.Curve2,c.$x,c.$y),a.addVertex(GVertex.Command.Curve2,k,l),a.addVertex(GVertex.Command.Curve2,i,j))},b.AnchorPoints.prototype._addCornerToVertices=function(a,c,d,e,f,g,h,i){var j,k,l,m,n,o,p,q,r,s;return c==e&&d==f?void((g!=c||h!=d)&&(a.addVertex(GVertex.Command.Line,g,h),a.addVertex(GVertex.Command.Line,e,f))):c==g&&d==h||e==g&&f==h?void a.addVertex(GVertex.Command.Line,e,f):void(i==b.CornerType.Rounded||i==b.CornerType.InverseRounded?c==e&&c==g||d==f&&d==h?(a.addVertex(GVertex.Command.Curve,e,f),a.addVertex(GVertex.Command.Curve,g,h)):(i==b.CornerType.Rounded?(r=g,s=h):(r=c+e-g,s=d+f-h),a.addVertex(GVertex.Command.Curve2,e,f),a.addVertex(GVertex.Command.Curve2,c+(r-c)*b.AnchorPoint.BEST_CIRCLE_COEFF,d+(s-d)*b.AnchorPoint.BEST_CIRCLE_COEFF),a.addVertex(GVertex.Command.Curve2,e+(r-e)*b.AnchorPoint.BEST_CIRCLE_COEFF,f+(s-f)*b.AnchorPoint.BEST_CIRCLE_COEFF)):i==b.CornerType.Fancy?(l=(e-g)/3,m=(f-h)/3,n=(g-c)/3,o=(h-d)/3,j=c+2*l,k=d+2*m,a.addVertex(GVertex.Command.Line,j,k),j+=2*n,k+=2*o,a.addVertex(GVertex.Command.Line,j,k),j-=l,k-=m,a.addVertex(GVertex.Command.Line,j,k),j-=n,k-=o,a.addVertex(GVertex.Command.Line,j,k),j+=2*l,k+=2*m,a.addVertex(GVertex.Command.Line,j,k),j+=2*n,k+=2*o,a.addVertex(GVertex.Command.Line,j,k)):i==b.CornerType.Bevel?a.addVertex(GVertex.Command.Line,e,f):i==b.CornerType.Inset?(p=c+e-g,q=d+f-h,a.addVertex(GVertex.Command.Line,p,q),a.addVertex(GVertex.Command.Line,e,f)):(a.addVertex(GVertex.Command.Line,g,h),a.addVertex(GVertex.Command.Line,e,f)))
},b.AnchorPoints.prototype._addPathEndVertices=function(a,b){var c,d,e=this.getLastChild(),f=e.getPrevious();b&&(e=e._getTransformedCopy(b),f=f._getTransformedCopy(b)),null!=e.$hlx&&null!=e.$hly&&null!=f.$hrx&&null!=f.$hry?(a.addVertex(GVertex.Command.Curve2,e.$x,e.$y),a.addVertex(GVertex.Command.Curve2,f.$hrx,f.$hry),a.addVertex(GVertex.Command.Curve2,e.$hlx,e.$hly)):null!=e.$hlx&&null!=e.$hly||null!=f.$hrx&&null!=f.$hry?(null!=e.$hlx&&null!=e.$hly?(c=e.$hlx,d=e.$hly):(c=f.$hrx,d=f.$hry),a.addVertex(GVertex.Command.Curve,e.$x,e.$y),a.addVertex(GVertex.Command.Curve,c,d)):a.addVertex(GVertex.Command.Line,e.$x,e.$y)},b.AnchorPoints.prototype._handleChange=function(a,c){var d=this._parent;if(d){var e,f,g,h,i=c;a==GNode._Change.BeforeChildInsert?this.getParent()&&this.getParent().beginUpdate():a==GNode._Change.AfterChildInsert?(e=this.getPreviousPoint(i),e&&null!=e.$hrx&&i.$tp==b.AnchorPoint.Type.Connector&&(g=i.$x+(e.$x-i.$x)*b.AnchorPoint.HANDLE_COEFF,h=i.$y+(e.$y-i.$y)*b.AnchorPoint.HANDLE_COEFF,GMath.isEqualEps(i.$x-g,0)&&GMath.isEqualEps(i.$y-h,0)||i.setProperties(["hlx","hly"],[g,h])),f=this.getNextPoint(i),f&&null!=f.$hlx&&i.$tp==b.AnchorPoint.Type.Connector&&(g=i.$x+(f.$x-i.$x)*b.AnchorPoint.HANDLE_COEFF,h=i.$y+(f.$y-i.$y)*b.AnchorPoint.HANDLE_COEFF,GMath.isEqualEps(i.$x-g,0)&&GMath.isEqualEps(i.$y-h,0)||i.setProperties(["hrx","hry"],[g,h])),(i.$ah||i.$tp==b.AnchorPoint.Type.Connector)&&i._invalidateCalculations(),this._invalidateLeft(e),this._invalidateRight(f),this.getParent()&&this.getParent().endUpdate()):a==GNode._Change.BeforeChildRemove?(this.getParent()&&this.getParent().beginUpdate(),this._dirtyPrev=this.getPreviousPoint(i),this._dirtyNext=this.getNextPoint(i)):a==GNode._Change.AfterChildRemove&&(this._dirtyPrev&&this._invalidateLeft(this._dirtyPrev),this._dirtyNext&&this._invalidateRight(this._dirtyNext),this.getParent()&&this.getParent().endUpdate())}!d||a!=GNode._Change.AfterChildInsert&&a!=GNode._Change.AfterChildRemove||(d._notifyChange(GElement._Change.PrepareGeometryUpdate),d._verticesDirty=!0,d._notifyChange(GElement._Change.FinishGeometryUpdate)),GNode.prototype._handleChange.call(this,a,c)},b.AnchorPoints.prototype.getNextPoint=function(a){var b=a?a.getNext():null;return!b&&this._parent&&this._parent.$closed&&a==this.getLastChild()&&(b=this.getFirstChild()),b},b.AnchorPoints.prototype.getPreviousPoint=function(a){var b=a?a.getPrevious():null;return!b&&this._parent&&this._parent.$closed&&a==this.getFirstChild()&&(b=this.getLastChild()),b},b.AnchorPoints.prototype.getLastRelatedPoint=function(a){var c=a,d=this.getNextPoint(a);if(d&&(c=d,d.$tp==b.AnchorPoint.Type.Symmetric||d.$tp==b.AnchorPoint.Type.Mirror)){var e=this.getNextPoint(d);e&&e.$ah&&e!=a&&(c=e)}return c},b.AnchorPoints.prototype.getFirstRelatedPoint=function(a){var c=a,d=this.getPreviousPoint(a);if(d&&(c=d,d.$tp==b.AnchorPoint.Type.Symmetric||d.$tp==b.AnchorPoint.Type.Mirror)){var e=this.getPreviousPoint(d);e&&e.$ah&&e!=a&&(c=e)}return c},b.AnchorPoints.prototype.toString=function(){return"[Object GPathBase.AnchorPoints]"},b.prototype._vertices=null,b.prototype._verticesDirty=!1,b.prototype._anchorPoints=null,b.prototype.rewindVertices=function(a){return(this._verticesDirty||null==this._vertices||0==this._vertices.getCount())&&(this._vertices.clearVertices(),this._getAnchorPoints()._generateVertices(this._vertices,this.$trf,!0),this._verticesDirty=!1),this._vertices.rewindVertices(a)},b.prototype.readVertex=function(a){return this._vertices.readVertex(a)},b.prototype.clearAnchorPoints=function(){var a=this._anchorPoints;this._anchorPoints._removalAllowed=!0;this._anchorPoints.getNext(!0);return this.removeChild(this._anchorPoints),this._anchorPoints=new b.AnchorPoints,this.appendChild(this._anchorPoints),a},b.prototype._isEvenOddFill=function(){return!!this.$evenodd},b.prototype._calculateOrigGeometryBBox=function(){var a=new GVertexContainer;return this._getAnchorPoints()._generateVertices(a,null,!1),ifVertexInfo.calculateBounds(a,!0)},b.prototype._handleChange=function(a,c){if(this._handleVisualChangeForProperties(a,c,b.VisualProperties),a===GNode._Change.Store)this.storeProperties(c,b.VisualProperties);else if(a===GNode._Change.Restore)this.restoreProperties(c,b.VisualProperties);else if(a===GNode._Change.AfterPropertiesChange)if(c.properties.indexOf("closed")>=0){var d=this._getAnchorPoints();d&&(d._invalidateRight(d.getFirstChild()),d._invalidateLeft(d.getLastChild())),this._verticesDirty=!0}else c.properties.indexOf("trf")>=0&&(this._verticesDirty=!0);else a===GNode._Change.Attached?this._anchorPoints&&this._anchorPoints._setScene(this._scene):a===GNode._Change.Detach&&this._anchorPoints&&this._anchorPoints._setScene(null);GShape.prototype._handleChange.call(this,a,c)},b.prototype._getAnchorPoints=function(){return this._anchorPoints},b.prototype.toString=function(){return"[GPathBase]"},a.GPathBase=b}(this),function(a){function b(){GShape.call(this),this._setDefaultProperties(b.VisualProperties),this._image=new Image,this._image.onload=this._updatedImage.bind(this),this._image.onerror=this._updatedImage.bind(this),this._image.onabort=this._updatedImage.bind(this),this._updateImage()}GNode.inheritAndMix("image",b,GShape),b.VisualProperties={url:null},b.ImageStatus={Loaded:0,Resolving:1,Loading:2,Delayed:3,Error:10},b.NO_IMAGE_WIDTH=100,b.NO_IMAGE_HEIGHT=100,b.NO_IMAGE_BACKGROUND=new GRGBColor([240,240,240]),b.NO_IMAGE_ERROR_STROKE=new GRGBColor([255,0,0]),b.StatusEvent=function(a,b){this.image=a,this.status=b},GObject.inherit(b.StatusEvent,GEvent),b.StatusEvent.prototype.image=null,b.StatusEvent.prototype.status=null,b.StatusEvent.prototype.toString=function(){return"[Event GImage.StatusEvent]"},b.prototype._status=null,b.prototype._image=null,b.prototype._vertexIterator=0,b.prototype.getStatus=function(){return this._status},b.prototype.getImage=function(){return this._image},b.prototype.rewindVertices=function(a){return this._vertexIterator=a,!0},b.prototype.readVertex=function(a){switch(this._vertexIterator){case 0:a.command=GVertex.Command.Move,a.x=0,a.y=0;break;case 1:a.command=GVertex.Command.Line,a.x=this._getWidth(),a.y=0;break;case 2:a.command=GVertex.Command.Line,a.x=this._getWidth(),a.y=this._getHeight();break;case 3:a.command=GVertex.Command.Line,a.x=0,a.y=this._getHeight();break;case 4:a.command=GVertex.Command.Close;break;default:return!1}return a.command!==GVertex.Command.Close&&this.$trf&&this.$trf.map(a),this._vertexIterator+=1,!0},b.prototype._detailHitTest=function(){return new GElement.HitResultInfo(this)},b.prototype._handleChange=function(a,c){a===GNode._Change.Store?this.storeProperties(c,b.VisualProperties):a===GNode._Change.Restore?(this.restoreProperties(c,b.VisualProperties),this._updateImage()):a==GNode._Change.AfterPropertiesChange?c.properties.indexOf("url")>=0&&this._updateImage():a===GNode._Change.Attached&&this._status===b.ImageStatus.Delayed&&this._updateImage(),GShape.prototype._handleChange.call(this,a,c)},b.prototype._paintFill=function(a){if(GShape.prototype._paintFill.call(this,a),!a.configuration.isOutline(a)){var c=a.canvas.getTransform(!0);if(this.$trf){var d=c.preMultiplied(this.$trf);a.canvas.setTransform(d)}switch(this._status){case b.ImageStatus.Loaded:a.canvas.drawImage(this._image,0,0,!1,1);break;default:var e=this._getWidth(),f=this._getHeight();a.canvas.fillRect(0,0,e,f,b.NO_IMAGE_BACKGROUND),this._status===b.ImageStatus.Error&&(a.canvas.strokeLine(0,0,e,f,2,b.NO_IMAGE_ERROR_STROKE),a.canvas.strokeLine(e,0,0,f,2,b.NO_IMAGE_ERROR_STROKE))}a.canvas.setTransform(c)}},b.prototype._getWidth=function(){return this._image.naturalWidth?this._image.naturalWidth:b.NO_IMAGE_WIDTH},b.prototype._getHeight=function(){return this._image.naturalHeight?this._image.naturalHeight:b.NO_IMAGE_HEIGHT},b.prototype._updateImage=function(){this.isAttached()?(this._setStatus(b.ImageStatus.Resolving),this._scene.resolveUrl(this.$url,this._resolvedImage.bind(this))):this._setStatus(b.ImageStatus.Delayed)},b.prototype._resolvedImage=function(a){this._setStatus(b.ImageStatus.Loading),this._notifyChange(GElement._Change.InvalidationRequest),this._notifyChange(GElement._Change.PrepareGeometryUpdate),this._image.src=a},b.prototype._updatedImage=function(){this._notifyChange(GElement._Change.FinishGeometryUpdate),this._setStatus(0!==this._image.naturalWidth&&0!==this._image.naturalHeight?b.ImageStatus.Loaded:b.ImageStatus.Error)},b.prototype._setStatus=function(a){a!==this._status&&(this._status=a,this._canEventBeSend(b.StatusEvent)&&this._scene.trigger(new b.StatusEvent(this,this._status)))},b.prototype.toString=function(){return"[GImage]"},a.GImage=b}(this),function(a){function b(){GPathBase.call(this),this.$closed=!0,this._setDefaultProperties(b.GeometryProperties)}GNode.inherit("polygon",b,GPathBase),b.GeometryProperties={pts:6,cx:0,cy:0,or:0,ir:0,oa:0,ia:GMath.PI2-Math.PI/3,oct:GPathBase.CornerType.Rounded,ict:GPathBase.CornerType.Rounded,ocr:0,icr:0},b.prototype.iterateSegments=function(a,b){for(var c=1e-6,d=this.$oa+GMath.PI2,e=GMath.PI2/this.$pts,f=this.$ia-this.$oa,g=b?this.$trf:null,h=this.$oa;d-c>h;h+=e){var i=new GPoint(this.$or*Math.cos(h)+this.$cx,this.$or*Math.sin(h)+this.$cy);if(g&&(i=g.mapPoint(i)),a(i,!1,h)===!0)break;if(i=new GPoint(this.$ir*Math.cos(h+f)+this.$cx,this.$ir*Math.sin(h+f)+this.$cy),g&&(i=g.mapPoint(i)),a(i,!0,h+f)===!0)break}},b.prototype._handleChange=function(a,c){a===GNode._Change.Store?this.storeProperties(c,b.GeometryProperties):a===GNode._Change.Restore&&(this.restoreProperties(c,b.GeometryProperties),this._invalidatePath()),this._handleGeometryChangeForProperties(a,c,b.GeometryProperties)&&a==GNode._Change.AfterPropertiesChange&&this._invalidatePath(),GPathBase.prototype._handleChange.call(this,a,c)},b.prototype._invalidatePath=function(){var a=this._getAnchorPoints();this.beginUpdate(),a._beginBlockCompositeEvents(!0,!0,!0);try{a.clearChildren(),this.iterateSegments(function(b,c){var d=new GPathBase.AnchorPoint;d.setProperties(["tp","x","y","cl","cr"],[c?this.$ict:this.$oct,b.getX(),b.getY(),c?this.$icr:this.$ocr,c?this.$icr:this.$ocr]),a.appendChild(d)}.bind(this))}finally{this.endUpdate(),a._endBlockCompositeEvents(!0,!0,!0)}},b.prototype.getCenter=function(a){var b=new GPoint(this.$cx,this.$cy);return a&&this.$trf&&(b=this.$trf.mapPoint(b)),b},b.prototype.getOrigHalfWidth=function(){return this.$or>=this.$ir?this.$or:this.$ir},b.prototype.getOrigHalfHeight=function(){return this.$or>=this.$ir?this.$or:this.$ir},b.prototype._requireMiterLimitApproximation=function(){return!0},b.prototype.toString=function(){return"[GPolygon]"},a.GPolygon=b}(this),function(a){function b(){GPathBase.call(this),this.$closed=!0,this._setDefaultProperties(b.GeometryProperties),this._invalidatePath()}GNode.inherit("rectangle",b,GPathBase),b.GeometryProperties={uf:!0,tl_uf:!0,tl_ct:GPathBase.CornerType.Rounded,tl_sx:0,tl_sy:0,tr_uf:!0,tr_ct:GPathBase.CornerType.Rounded,tr_sx:0,tr_sy:0,br_uf:!0,br_ct:GPathBase.CornerType.Rounded,br_sx:0,br_sy:0,bl_uf:!0,bl_ct:GPathBase.CornerType.Rounded,bl_sx:0,bl_sy:0},b.getGeometryPropertiesSidePrefix=function(a){switch(a){case GRect.Side.TOP_LEFT:return"tl";case GRect.Side.TOP_RIGHT:return"tr";case GRect.Side.BOTTOM_RIGHT:return"br";case GRect.Side.BOTTOM_LEFT:return"bl";default:throw new Error("Invalid side")}},b.SIDES=[GRect.Side.TOP_LEFT,GRect.Side.TOP_RIGHT,GRect.Side.BOTTOM_RIGHT,GRect.Side.BOTTOM_LEFT],b.prototype.iterateSegments=function(a,c){for(var d=c?this.$trf:null,e=0;e<b.SIDES.length;++e){var f=b.SIDES[e],g=b.getGeometryPropertiesSidePrefix(f),h=null;switch(f){case GRect.Side.TOP_LEFT:h=new GPoint(-1,-1);break;case GRect.Side.TOP_RIGHT:h=new GPoint(1,-1);break;case GRect.Side.BOTTOM_RIGHT:h=new GPoint(1,1);break;case GRect.Side.BOTTOM_LEFT:h=new GPoint(-1,1)}if(d&&(h=d.mapPoint(h)),a(h,f,this["$"+g+"_ct"],this["$"+g+"_sx"],this["$"+g+"_sy"],e)===!0)break}},b.prototype.getAnchorPoints=function(){return this._getAnchorPoints()},b.prototype._handleChange=function(a,c){if(a===GNode._Change.Store)if(this.$uf)c.uf=!0,c.ct=this.$tl_ct,c.sl=this.$tl_sx;else for(var d=0;d<b.SIDES.length;++d){var e=b.SIDES[d],f=b.getGeometryPropertiesSidePrefix(e);c[f+"uf"]=this["$"+f+"_uf"],c[f+"ct"]=this["$"+f+"_ct"],c[f+"sl"]=[this["$"+f+"_sx"],this["$"+f+"_sy"]]}else if(a===GNode._Change.Restore){for(var d=0;d<b.SIDES.length;++d){var e=b.SIDES[d],f=b.getGeometryPropertiesSidePrefix(e);this.$uf=c.uf,this["$"+f+"_uf"]=c.uf?c.uf:c[f+"uf"],this["$"+f+"_ct"]=c.uf?c.ct:c[f+"ct"],this["$"+f+"_sx"]=c.uf?c.sl:c[f+"sl"][0],this["$"+f+"_sy"]=c.uf?c.sl:c[f+"sl"][1]}this._invalidatePath()}if(this._handleGeometryChangeForProperties(a,c,b.GeometryProperties)&&a==GNode._Change.AfterPropertiesChange){var g=[],h=[],i=c.properties;if(this.$uf){for(var j=null,k=null,l=!1,m=!1,d=0;d<b.SIDES.length&&(!l||!m);++d){var e=b.SIDES[d],f=b.getGeometryPropertiesSidePrefix(e);if(!l){var n=f+"_sx",o=i.indexOf(n);if(o>=0)j=this["$"+n],l=!0;else{var n=f+"_sy",o=i.indexOf(n);o>=0&&(j=this["$"+n],l=!0)}}if(!m){var n=f+"_ct",o=i.indexOf(n);o>=0&&(k=this["$"+n],m=!0)}}l||(j=this.getProperty("tl_sx")),m||(k=this.getProperty("tl_ct")),g.push("tl_uf","tr_uf","br_uf","bl_uf"),h.push(!0,!0,!0,!0),g.push("tl_sx","tl_sy","tr_sx","tr_sy","br_sx","br_sy","bl_sx","bl_sy"),h.push(j,j,j,j,j,j,j,j),g.push("tl_ct","tr_ct","br_ct","bl_ct"),h.push(k,k,k,k)}else for(var d=0;d<b.SIDES.length;++d){var e=b.SIDES[d],f=b.getGeometryPropertiesSidePrefix(e),j=null,l=!1;if(this["$"+f+"_uf"]){var n=f+"_sx",o=i.indexOf(n);if(o>=0)j=this["$"+n],l=!0;else{var n=f+"_sy",o=i.indexOf(n);o>=0&&(j=this["$"+n],l=!0)}l||(j=this.getProperty(f+"_sx")),g.push(f+"_sx"),h.push(j),g.push(f+"_sy"),h.push(j)}}this.setProperties(g,h)||this._invalidatePath()}GPathBase.prototype._handleChange.call(this,a,c)},b.prototype._calculateOrigGeometryBBox=function(){return new GRect(-1,-1,2,2)},b.prototype._invalidatePath=function(){var a=this._getAnchorPoints();this.beginUpdate(),a._beginBlockCompositeEvents(!0,!0,!0);try{a.clearChildren(),this.iterateSegments(function(b,c,d,e,f){var g=new GPathBase.AnchorPoint;g.setProperties(["tp","x","y","cl","cr","cu"],[d,b.getX(),b.getY(),e,f,!1]),a.appendChild(g)}.bind(this))}finally{this.endUpdate(),a._endBlockCompositeEvents(!0,!0,!0)}},b.prototype.toString=function(){return"[GRectangle]"},a.GRectangle=b}(this),function(a){function b(){GPathBase.call(this),this._setDefaultProperties(b.GeometryProperties),this._invalidatePath()}GNode.inherit("ellipse",b,GPathBase),b.Type={Pie:0,Chord:1,Arc:2},b.GeometryProperties={sa:Math.PI,ea:Math.PI,etp:b.Type.Pie},b.prototype._handleChange=function(a,c){a===GNode._Change.Store?this.storeProperties(c,b.GeometryProperties):a===GNode._Change.Restore&&(this.restoreProperties(c,b.GeometryProperties),this._invalidatePath()),this._handleGeometryChangeForProperties(a,c,b.GeometryProperties)&&a==GNode._Change.AfterPropertiesChange&&this._invalidatePath(),GPathBase.prototype._handleChange.call(this,a,c)},b.prototype._calculateOrigGeometryBBox=function(){return GMath.isEqualEps(this.$sa,this.$ea)?new GRect(-1,-1,2,2):GPathBase.prototype._calculateOrigGeometryBBox.call(this)},b.prototype._invalidatePath=function(){var a=this._getAnchorPoints();this.beginUpdate(),a._beginBlockCompositeEvents(!0,!0,!0);try{a.clearChildren();var c;for(c=Math.PI/2;c<=this.$sa||GMath.isEqualEps(c,this.$sa);c+=Math.PI/2);var d=new GPathBase.AnchorPoint;d.setProperties(["x","y","tp","ah"],[Math.cos(this.$sa),Math.sin(this.$sa),GPathBase.AnchorPoint.Type.Symmetric,!0]),a.appendChild(d);var e=GMath.isEqualEps(this.$sa,this.$ea)?this.$sa+GMath.PI2:this.$ea;for(e<this.$sa&&(e+=GMath.PI2),c;e>c&&!GMath.isEqualEps(c,e);c+=Math.PI/2)d=new GPathBase.AnchorPoint,d.setProperties(["x","y","tp","ah"],[Math.cos(c),Math.sin(c),GPathBase.AnchorPoint.Type.Symmetric,!0]),a.appendChild(d);GMath.isEqualEps(this.$sa+GMath.PI2,e)||(d=new GPathBase.AnchorPoint,d.setProperties(["x","y","tp","ah"],[Math.cos(e),Math.sin(e),GPathBase.AnchorPoint.Type.Symmetric,!0]),a.appendChild(d));var f=null;a.getFirstChild().getNext()==a.getLastChild()&&(d=new GPathBase.AnchorPoint,GMath.isEqualEps(c,e)&&(c+=Math.PI/2),d.setProperties(["x","y","tp","ah"],[Math.cos(c),Math.sin(c),GPathBase.AnchorPoint.Type.Symmetric,!0]),a.appendChild(d),f=d),this.setProperty("closed",!0);for(var g=a.getFirstChild();null!=g;g=g.getNext())g.setProperty("ah",!1);f&&a.removeChild(f),GMath.isEqualEps(this.$sa+GMath.PI2,e)||(a.getFirstChild().setProperties(["tp","hlx","hly"],[GPathBase.AnchorPoint.Type.Asymmetric,null,null]),a.getLastChild().setProperties(["tp","hrx","hry"],[GPathBase.AnchorPoint.Type.Asymmetric,null,null]),this.$etp==b.Type.Pie?(d=new GPathBase.AnchorPoint,a.appendChild(d)):this.$etp==b.Type.Arc&&this.setProperty("closed",!1))}finally{this.endUpdate(),a._endBlockCompositeEvents(!0,!0,!0)}},b.prototype.toString=function(){return"[GEllipse]"},a.GEllipse=b}(this),function(a){function b(a,c,d){GPathBase.call(this,c,d),this._setDefaultProperties(b.GeometryProperties),a&&this.setProperty("closed",a)}GNode.inherit("path",b,GPathBase),b.GeometryProperties={closed:!1},b.prototype.getAnchorPoints=function(){return this._getAnchorPoints()},b.prototype.clone=function(){for(var a=GPathBase.prototype.clone.call(this),b=this.getAnchorPoints().queryAll(":selected"),c=0;c<b.length;++c){var d=this.getAnchorPoints().getIndexOfChild(b[c]),e=a.getAnchorPoints().getChildByIndex(d);e&&e.setFlag(GNode.Flag.Selected)}return a},b.prototype.validateInsertion=function(a){return a instanceof GLayer||a instanceof GGroup||a instanceof GShape||a instanceof GCompoundPath.AnchorPaths},b.prototype.pathHitTest=function(a,b,c,d){d=d||0;var e=a,f=1;if(b){var g=b.inverted();e=g.mapPoint(a),f*=g.getScaleFactor()}var h=null;if(this.$trf){h=this.$trf,this.$trf=null;var g=h.inverted();e=g.mapPoint(e),f*=g.getScaleFactor()}var i=new GVertexContainer;this._getAnchorPoints()._generateVertices(i,this.$trf,!1);var j=new GVertexInfo.HitResult,k=null,l=f*d*2;return ifVertexInfo.hitTest(e.getX(),e.getY(),i,l,this.$closed?c:!1,j)&&(k=new GElement.HitResultInfo(this,j)),h&&(this.$trf=h),k},b.prototype.insertHitPoint=function(a){if(!a||!a.slope||GMath.isEqualEps(a.slope,0)||GMath.isEqualEps(a.slope,1))return null;for(var c=a.slope,d=1,e=this.getAnchorPoints().getFirstChild();null!=e&&d<a.segment;)e=e.getNext(),d++;var f=e,g=f?this.getAnchorPoints().getNextPoint(f):null;if(f&&g){this.beginUpdate(),f.setProperty("ah",!1),g.setProperty("ah",!1);var h,i=f.getProperty("tp"),j=g.getProperty("tp");h=i==GPathBase.AnchorPoint.Type.Connector||i==GPathBase.AnchorPoint.Type.Symmetric||i==GPathBase.AnchorPoint.Type.Mirror||j==GPathBase.AnchorPoint.Type.Connector||j==GPathBase.AnchorPoint.Type.Symmetric||j==GPathBase.AnchorPoint.Type.Mirror||i==GPathBase.AnchorPoint.Type.Asymmetric&&j==GPathBase.AnchorPoint.Type.Asymmetric?GPathBase.AnchorPoint.Type.Asymmetric:i!=GPathBase.AnchorPoint.Type.Symmetric&&i!=GPathBase.AnchorPoint.Type.Mirror&&i!=GPathBase.AnchorPoint.Type.Connector&&i!=GPathBase.AnchorPoint.Type.Asymmetric?i:j;var k,l,m,n,o,p,q,r,s=null;k=f.getProperty("x"),o=f.getProperty("y"),l=f.getProperty("hrx"),p=f.getProperty("hry"),n=g.getProperty("x"),r=g.getProperty("y"),m=g.getProperty("hlx"),q=g.getProperty("hly");var t=null==l||null==p||GMath.isEqualEps(l,k)&&GMath.isEqualEps(p,o),u=null==m||null==q||GMath.isEqualEps(m,n)&&GMath.isEqualEps(q,r);if(t&&u)s=new b.AnchorPoint,s.setProperties(["x","y","tp"],[k+c*(n-k),o+c*(r-o),h]),this.getAnchorPoints().insertChild(s,g);else if(t||u){var v=t?m:l,w=t?q:p,x=new Float64Array(3),y=new Float64Array(3),z=new Float64Array(3),A=new Float64Array(3);GMath.divideQuadraticCurve(k,v,n,c,x,z),GMath.divideQuadraticCurve(o,w,r,c,y,A),s=new b.AnchorPoint,s.setProperties(["x","y","tp"],[x[2],y[2],h]),this.getAnchorPoints().insertChild(s,g),t?(GMath.isEqualEps(x[1],x[2])&&GMath.isEqualEps(y[1],y[2])?s.setProperties(["hlx","hly"],[null,null]):s.setProperties(["hlx","hly"],[x[1],y[1]]),l=z[0]+2/3*(z[1]-z[0]),p=A[0]+2/3*(A[1]-A[0]),m=z[2]+2/3*(z[1]-z[2]),q=A[2]+2/3*(A[1]-A[2]),GMath.isEqualEps(l,z[0])&&GMath.isEqualEps(p,A[0])?s.setProperties(["hrx","hry"],[null,null]):s.setProperties(["hrx","hry"],[l,p]),GMath.isEqualEps(m,z[2])&&GMath.isEqualEps(q,A[2])?g.setProperties(["hlx","hly"],[null,null]):g.setProperties(["hlx","hly"],[m,q])):(GMath.isEqualEps(z[0],z[1])&&GMath.isEqualEps(A[0],A[1])?s.setProperties(["hrx","hry"],[null,null]):s.setProperties(["hrx","hry"],[z[1],A[1]]),l=x[0]+2/3*(x[1]-x[0]),p=y[0]+2/3*(y[1]-y[0]),m=x[2]+2/3*(x[1]-x[2]),q=y[2]+2/3*(y[1]-y[2]),GMath.isEqualEps(m,x[2])&&GMath.isEqualEps(q,y[2])?s.setProperties(["hlx","hly"],[null,null]):s.setProperties(["hlx","hly"],[m,q]),GMath.isEqualEps(l,x[0])&&GMath.isEqualEps(p,y[0])?f.setProperties(["hrx","hry"],[null,null]):f.setProperties(["hrx","hry"],[l,p]))}else{var x=new Float64Array(4),y=new Float64Array(4),z=new Float64Array(4),A=new Float64Array(4);GMath.getCtrlPtsCasteljau(k,l,m,n,c,1,x),GMath.getCtrlPtsCasteljau(o,p,q,r,c,1,y),GMath.getCtrlPtsCasteljau(k,l,m,n,c,2,z),GMath.getCtrlPtsCasteljau(o,p,q,r,c,2,A),GMath.isEqualEps(x[1],k)&&GMath.isEqualEps(y[1],o)?f.setProperties(["hrx","hry"],[null,null]):f.setProperties(["hrx","hry"],[x[1],y[1]]),s=new b.AnchorPoint,s.setProperties(["x","y","tp"],[x[3],y[3],h]),this.getAnchorPoints().insertChild(s,g),GMath.isEqualEps(x[2],x[3])&&GMath.isEqualEps(y[2],y[3])?s.setProperties(["hlx","hly"],[null,null]):s.setProperties(["hlx","hly"],[x[2],y[2]]),GMath.isEqualEps(z[0],z[1])&&GMath.isEqualEps(A[0],A[1])?s.setProperties(["hrx","hry"],[null,null]):s.setProperties(["hrx","hry"],[z[1],A[1]]),GMath.isEqualEps(z[2],z[3])&&GMath.isEqualEps(A[2],A[3])?g.setProperties(["hlx","hly"],[null,null]):g.setProperties(["hlx","hly"],[z[2],A[2]])}return this.endUpdate(),s}return null},b.prototype._handleChange=function(a,c){a===GNode._Change.Store?(this.storeProperties(c,b.GeometryProperties),c.pts=this.getAnchorPoints().serialize()):a===GNode._Change.Restore&&(this.restoreProperties(c,b.GeometryProperties),c.hasOwnProperty("pts")&&this.getAnchorPoints().deserialize(c.pts)),GPathBase.prototype._handleChange.call(this,a,c),this._handleGeometryChangeForProperties(a,c,b.GeometryProperties),this._handleGeometryChangeForProperties(a,c,GPathBase.GeometryProperties)},b.prototype._requireMiterLimitApproximation=function(){return!0},b.prototype.toString=function(){return"[GPath]"},a.GPath=b}(this),function(a){function b(){GShape.call(this),this._setDefaultProperties(b.GeometryProperties),this._runs=[],this._runsDirty=!1,this._tl=new GPoint(0,0),this._tr=new GPoint(1,0),this._br=new GPoint(1,1),this._bl=new GPoint(0,1)}GNode.inherit("text",b,GShape),b.VerticalAlign={Top:"t",Middle:"m",Bottom:"b"},b.GeometryProperties={aw:!0,ah:!0,va:b.VerticalAlign.Top,ttrf:null},b.Chunk=function(a){GNode.call(this),this._content=a},GNode.inheritAndMix("txChk",b.Chunk,GNode,[GNode.Store]),b.Chunk.prototype._content=null,b.Chunk.prototype.getContent=function(){return this._content},b.Chunk.prototype.validateInsertion=function(a){return a instanceof b.Block},b.Chunk.prototype._handleChange=function(a,b){a===GNode._Change.Store?b.cnt=this._content:a===GNode._Change.Restore&&(this._content=b.cnt),GNode.prototype._handleChange.call(this,a,b)},b.Break=function(){GNode.call(this)},GNode.inheritAndMix("txBrk",b.Break,GNode,[GNode.Store]),b.Break.prototype.validateInsertion=function(a){return a instanceof b.Block},b.Block=function(){this._setStyleDefaultProperties()},GObject.inheritAndMix(b.Block,GNode,[GNode.Properties,GNode.Store,GStylable]),b.Block.prototype.getStylePropertySets=function(){return[GStylable.PropertySet.Text]},b.Block.propertyToCss=function(a,b,c){if("_tff"===a)c["font-family"]=null!==b?b:"";else if("_tfi"===a)c["font-size"]=null!==b?b+"px":"";else if("_tfw"===a)c["font-weight"]=null!==b?b.toString():"";else if("_tfs"===a)if(null===b)c["font-style"]="";else switch(b){case GFont.Style.Normal:c["font-style"]="normal";break;case GFont.Style.Italic:c["font-style"]="italic"}else if("fc"===a)c.color=null!==b?b.toScreenCSS():"";else if("_tcs"===a)c["letter-spacing"]=null!==b?b+"px":"";else{if("_tws"!==a)throw new Error("Unimplemented property (propertyToCss): "+a);c["word-spacing"]=null!==b?b+"px":""}},b.Block.cssToProperty=function(a,b){if("_tff"===a){if(b["font-family"]){var c=b["font-family"];if(c.length>0)return c.indexOf(",")>=0&&(c=c.substr(0,c.indexOf(",")).trim()),('"'===c.charAt(0)||"'"===c.charAt(0))&&(c=c.substr(1)),('"'===c.charAt(c.length-1)||"'"===c.charAt(c.length-1))&&(c=c.substr(0,c.length-1)),c}}else if("_tfi"===a){var d=parseFloat(b["font-size"]);if(!isNaN(d))return d}else if("_tfw"===a){var d=parseInt(b["font-weight"]);if(!isNaN(d))return d;if(d=b["font-weight"],"normal"===d)return GFont.Weight.Regular;if("bold"===d)return GFont.Weight.Bold}else if("_tfs"===a){if("normal"===b["font-style"])return GFont.Style.Normal;if("italic"===b["font-style"])return GFont.Style.Italic}else if("fc"===a){var d=GRGBColor.fromCSSColor(b.color);if(d)return d}else if("_tcs"===a){var d=parseFloat(b["letter-spacing"]);if(!isNaN(d))return d}else{if("_tws"!==a)throw new Error("Unimplemented property (cssToProperty): "+a);var d=parseFloat(b["word-spacing"]);if(!isNaN(d))return d}return null},b.Block.prototype.getText=function(){for(var a=this.getParent();null!==a;a=a.getParent())if(a instanceof b)return a;return null},b.Block.prototype.validateInsertion=function(a){return a instanceof b.Block},b.Block.prototype._handleChange=function(a,b){this._handleStyleChange(a,b);var c=this.getText();c&&(a==GNode._Change.BeforeChildInsert||a==GNode._Change.BeforeChildRemove?c.beginUpdate():(a==GNode._Change.AfterChildInsert||a==GNode._Change.AfterChildRemove)&&(c._runsDirty=!0,c.endUpdate())),GNode.prototype._handleChange.call(this,a,b)},b.Block.prototype._stylePrepareGeometryChange=function(){var a=this.getText();a&&(a._runsDirty=!0)},b.Block.prototype.propertiesToCss=function(a){return this._propertiesToCss(a,GStylable.PropertySetInfo[GStylable.PropertySet.Text].geometryProperties,b.Block.propertyToCss)},b.Block.prototype.cssToProperties=function(a){this._cssToProperties(a,GStylable.PropertySetInfo[GStylable.PropertySet.Text].geometryProperties,b.Block.cssToProperty)},b.Block.prototype._propertiesToCss=function(a,b,c){for(var d in b){var e=this.getProperty(d);null!==e&&c(d,e,a)}return a},b.Block.prototype._cssToProperties=function(a,b,c){var d=[],e=[];for(var f in b){var g=c(f,a);d.push(f),e.push(g)}d.length>0&&this.setProperties(d,e)},b.Span=function(){b.Block.call(this)},GNode.inheritAndMix("txSpan",b.Span,b.Block,[GNode.Container]),b.Span.prototype.validateInsertion=function(a){return a instanceof b.Paragraph||a instanceof b.Span},b.Paragraph=function(){b.Block.call(this)},GNode.inheritAndMix("txPara",b.Paragraph,b.Block,[GNode.Container]),b.Paragraph.prototype.getStylePropertySets=function(){return[GStylable.PropertySet.Text,GStylable.PropertySet.Paragraph]},b.Paragraph.propertyToCss=function(a,b,c){if("_pcc"===a)b=null!==b?b:"",c["column-count"]=b,c["-webkit-column-count"]=b,c["-moz-column-count"]=b;else if("_pcg"===a)b=null!==b?b:"",c["column-gap"]=b,c["-webkit-column-gap"]=b,c["-moz-column-gap"]=b;else if("_pwm"===a)if(null===b)c["white-space"]="",c["word-break"]="";else switch(b){case GStylable.ParagraphWrapMode.None:c["white-space"]="nowrap";break;case GStylable.ParagraphWrapMode.Words:c["white-space"]="pre-wrap";break;case GStylable.ParagraphWrapMode.All:c["white-space"]="pre-wrap",c["word-break"]="break-all"}else if("_pal"===a)if(null===b)c["text-align"]="";else switch(b){case GStylable.ParagraphAlignment.Left:c["text-align"]="left";break;case GStylable.ParagraphAlignment.Center:c["text-align"]="center";break;case GStylable.ParagraphAlignment.Right:c["text-align"]="right";break;case GStylable.ParagraphAlignment.Justify:c["text-align"]="justify"}else if("_pin"===a)c["text-indent"]=null!==b?b+"px":"";else{if("_plh"!==a)throw new Error("Unimplemented property (propertyToCss): "+a);c["line-height"]=null!==b?b:""}},b.Paragraph.cssToProperty=function(a,b){if("_pcc"===a){var c=b["column-count"]||b["-webkit-column-count"]||b["-moz-column-count"],d=parseInt(c);if(!isNaN(d))return d}else if("_pcg"===a){var c=b["column-gap"]||b["-webkit-column-gap"]||b["-moz-column-gap"],d=parseFloat(c);if(!isNaN(d))return d}else if("_pwm"===a){var e=b["white-space"],f=b["word-break"];if("pre-wrap"===e)return"break-all"===f?GStylable.ParagraphWrapMode.All:GStylable.ParagraphWrapMode.Words;if("nowrap"===e)return GStylable.ParagraphWrapMode.None}else if("_pal"===a){var d=b["text-align"];if("left"===d)return GStylable.ParagraphAlignment.Left;if("center"===d)return GStylable.ParagraphAlignment.Center;if("right"===d)return GStylable.ParagraphAlignment.Right;if("justify"===d)return GStylable.ParagraphAlignment.Justify}else if("_pin"===a){var d=parseFloat(b["text-indent"]);if(!isNaN(d))return d}else{if("_plh"!==a)throw new Error("Unimplemented property (cssToProperty): "+a);var g=parseFloat(b["line-height"]);if(!isNaN(g))return g}return null},b.Paragraph.prototype.validateInsertion=function(a){return a instanceof b.Content},b.Paragraph.prototype.propertiesToCss=function(a){return this._propertiesToCss(a,GStylable.PropertySetInfo[GStylable.PropertySet.Paragraph].geometryProperties,b.Paragraph.propertyToCss),b.Block.prototype.propertiesToCss.call(this,a)},b.Paragraph.prototype.cssToProperties=function(a){this._cssToProperties(a,GStylable.PropertySetInfo[GStylable.PropertySet.Paragraph].geometryProperties,b.Paragraph.cssToProperty),b.Block.prototype.cssToProperties.call(this,a)},b.Content=function(){GNode.call(this)},GNode.inheritAndMix("txContent",b.Content,GNode,[GNode.Properties,GNode.Store,GNode.Container]),b.Content.prototype.validateInsertion=function(a){return a instanceof b},b.Content.prototype.propertiesToCss=function(a){a.color="black";var c=this._parent;if(c){var d=c.getProperty("_fpt");d&&d instanceof GColor&&(a.color=GColor.rgbToHtmlHex(d.toScreen())),b.Block.prototype._propertiesToCss.call(c,a,GStylable.PropertySetInfo[GStylable.PropertySet.Text].geometryProperties,b.Block.propertyToCss),b.Block.prototype._propertiesToCss.call(c,a,GStylable.PropertySetInfo[GStylable.PropertySet.Paragraph].geometryProperties,b.Paragraph.propertyToCss)}return a},b.prototype._content=null,b.prototype._tl=null,b.prototype._tr=null,b.prototype._bl=null,b.prototype._br=null,b.prototype._verticalShift=0,b.prototype._runs=null,b.prototype._runsDirty=!1,b.prototype._runItIndex=null,b.prototype._runItOutline=null,b.prototype.getContent=function(){return this._content||(this._content=new b.Content,this._content._parent=this,this._content._setScene(this._scene)),this._content},b.prototype.getContentBBox=function(){return this._sizeBox?this._sizeBox:null},b.prototype.asHtml=function(a){var b=$("<div></div>");return this._asHtml(b,this.getContent(),a),b.html()},b.prototype.fromHtml=function(a){this.beginUpdate();try{var b=this.getContent();if(b.clearChildren(!0),a&&""!==a){var c=document.createElement("div");c.innerHTML=a;for(var d=c.firstChild;null!==d;d=d.nextSibling)this._fromHtml(d,b)}}finally{this.endUpdate()}},b.prototype.transform=function(a){a&&!a.isIdentity()&&this.setProperties(["trf","ttrf"],[this.$trf?this.$trf.multiplied(a):a,this.$ttrf?this.$ttrf.multiplied(a):a]),GElement.Transform.prototype._transformChildren.call(this,a)},b.prototype.getStylePropertySets=function(){return GShape.prototype.getStylePropertySets.call(this).concat(GStylable.PropertySet.Text,GStylable.PropertySet.Paragraph)},b.prototype.rewindVertices=function(){if(this._runsDirty||null==this._runs){this._runs=[];var a=this._tl,c=this._tr,d=this._bl,e=this._br;this.$trf&&(a=this.$trf.mapPoint(a),c=this.$trf.mapPoint(c),d=this.$trf.mapPoint(d),e=this.$trf.mapPoint(e)),this._textBox=new GRect.fromPoints(a,c,e,d);var f=this._textBox;if(this.$ttrf){var g=this.$ttrf.inverted();a=g.mapPoint(a),c=g.mapPoint(c),d=g.mapPoint(d),e=g.mapPoint(e);var h=null,i=null,j=null,k=null;a.getX()<e.getX()&&a.getX()<c.getX()&&d.getX()<e.getX()&&d.getX()<c.getX()?(h=a.getX()>=d.getX()?a.getX():d.getX(),i=e.getX()<=c.getX()?e.getX():c.getX()):a.getX()>e.getX()&&a.getX()>c.getX()&&d.getX()>e.getX()&&d.getX()>c.getX()&&(i=a.getX()<=d.getX()?a.getX():d.getX(),h=e.getX()>=c.getX()?e.getX():c.getX()),a.getY()<d.getY()&&a.getY()<e.getY()&&c.getY()<d.getY()&&c.getY()<e.getY()?(j=a.getY()>=c.getY()?a.getY():c.getY(),k=d.getY()<=e.getY()?d.getY():e.getY()):a.getY()>d.getY()&&a.getY()>e.getY()&&c.getY()>d.getY()&&c.getY()>e.getY()&&(k=a.getY()<=c.getY()?a.getY():c.getY(),j=d.getY()>=e.getY()?d.getY():e.getY()),f=null!==h&&null!==i&&null!==j&&null!==k?new GRect.fromPoints(new GPoint(h,j),new GPoint(i,k)):null
}if(f){var l=$("<div></div>").addClass("contenteditable").css(this.getContent().propertiesToCss({})).css({position:"absolute",top:"0px",left:"0px",visibility:"hidden",width:f.getWidth()>1&&!this.$aw?f.getWidth()+"px":"",height:f.getHeight()>1&&!this.$ah?f.getHeight()+"px":""}).html(this.asHtml(!0)).appendTo($("body")),m=null;l.find("span:not(:has(span))").each(function(a,c){var d=$(c),e=c.getBoundingClientRect(),g=d.text();if(0!==g.length){var h=g[0];if(!(e.height<=0||e.width<=0||h>="\x00"&&"">=h)){var i={"font-family":d.css("font-family"),"font-size":d.css("font-size"),"font-style":d.css("font-style"),"font-weight":d.css("font-weight")},j=b.Block.cssToProperty("_tff",i),k=b.Block.cssToProperty("_tfi",i),l=b.Block.cssToProperty("_tfs",i),n=b.Block.cssToProperty("_tfw",i),o=ifFont.getVariant(j,l,n),p=ifFont.getGlyphBaseline(j,o,k);" "!==h&&this._runs.push({x:f.getX()+e.left,y:f.getY()+e.top+p,"char":h,family:j,variant:o,size:k});var q=ifFont.getGlyphCharSzRect(j,o,k,h),r=new GRect(e.left+q.getX(),e.top,q.getWidth(),e.height);m=m?m.united(r):r}}}.bind(this));var n=0;if(m){if(this._sizeBox=new GRect(m.getX()+f.getX(),m.getY()+f.getY(),m.getWidth(),m.getHeight()),this.$ttrf&&(this._sizeBox=this.$ttrf.mapRect(this._sizeBox)),this._sizeBox&&this._sizeBox.getHeight()<this._textBox.getHeight())switch(this.$va){case b.VerticalAlign.Top:n=this._textBox.getY()-this._sizeBox.getY();break;case b.VerticalAlign.Middle:n=this._textBox.getY()-this._sizeBox.getY()+(this._textBox.getHeight()-this._sizeBox.getHeight())/2;break;case b.VerticalAlign.Bottom:n=this._textBox.getY()-this._sizeBox.getY()+this._textBox.getHeight()-this._sizeBox.getHeight()}else this._sizeBox&&(n=this._textBox.getY()-this._sizeBox.getY());this._sizeBox=this._sizeBox.translated(0,n)}else this._sizeBox=null;if(this._verticalShift=n,l.remove(),this._runsDirty=!1,this._sizeBox&&(this.$ah||this.$aw||this._sizeBox.getWidth()>this._textBox.getWidth()||this._sizeBox.getHeight()>this._textBox.getHeight())){var o=this.$aw?this._sizeBox.getX():this._textBox.getX(),p=this.$aw||this._sizeBox.getWidth()>this._textBox.getWidth()?this._sizeBox.getWidth():this._textBox.getWidth(),q=this.$ah?this._sizeBox.getY():this._textBox.getY(),r=this.$ah||this._sizeBox.getHeight()>this._textBox.getHeight()?this._sizeBox.getHeight():this._textBox.getHeight();this._textBox=new GRect(o,q,p,r)}}}return this._runs&&this._runs.length>0?(this._runItIndex=0,this._runItOutline=null,!0):!1},b.prototype.readVertex=function(a){if(this._runItOutline){if(this._runItOutline.readVertex(a))return!0;if(this._runItOutline=null,++this._runItIndex>=this._runs.length)return!1}if(!this._runItOutline){var b=this._runs[this._runItIndex];if(!b)return!1;this._runItOutline=ifFont.getGlyphOutline(b.family,b.variant,b.size,b.x,b.y,b.char);var c=this.$ttrf&&!this.$ttrf.isIdentity()?this.$ttrf:null;if(this._verticalShift){var d=new GTransform(1,0,0,1,0,this._verticalShift);c=c?c.multiplied(d):d}if(c&&(this._runItOutline=new GVertexTransformer(this._runItOutline,c)),!this._runItOutline.rewindVertices(0))throw new Error("Unexpected end of outline");return this._runItOutline.readVertex(a)}},b.prototype.textBoxTransform=function(a){if(a&&!a.isIdentity()){var b=a,c=this._textBox,d=a.mapRect(c),e=this._tl,f=this._tr,g=this._bl,h=this._br;this.$trf&&(e=this.$trf.mapPoint(e),f=this.$trf.mapPoint(f),g=this.$trf.mapPoint(g),h=this.$trf.mapPoint(h));var i=new GRect.fromPoints(e,f,h,g);b=(new GTransform).translated(-i.getX(),-i.getY()).scaled(d.getWidth()/i.getWidth(),d.getHeight()/i.getHeight()).translated(d.getX(),d.getY()),this.setProperties(["ah","aw","trf"],[!1,!1,this.$trf?this.$trf.multiplied(b):b])}},b.prototype.useTextBoxAsBase=function(){var a=null;if(this._textBox&&!this._runsDirty)a=this._textBox;else{var b=this._tl,c=this._tr,d=this._bl,e=this._br;this.$trf&&(b=this.$trf.mapPoint(b),c=this.$trf.mapPoint(c),d=this.$trf.mapPoint(d),e=this.$trf.mapPoint(e)),a=new GRect.fromPoints(b,c,e,d)}this._tl=a.getSide(GRect.Side.TOP_LEFT),this._tr=a.getSide(GRect.Side.TOP_RIGHT),this._br=a.getSide(GRect.Side.BOTTOM_RIGHT),this._bl=a.getSide(GRect.Side.BOTTOM_LEFT),this.setProperty("trf",null)},b.prototype._calculateGeometryBBox=function(){this.rewindVertices(0);var a=this._textBox;return this._sizeBox&&(a=a.united(this._sizeBox)),a},b.prototype._preparePaint=function(a){if(GShape.prototype._preparePaint.call(this,a)){var b=this._getClipBox(a);return b&&a.canvas.clipRect(b.getX(),b.getY(),b.getWidth(),b.getHeight()),!0}return!1},b.prototype._finishPaint=function(a){null!==this._getClipBox(a)&&a.canvas.resetClip(),GShape.prototype._finishPaint.call(this,a)},b.prototype._detailHitTest=function(){return new GElement.HitResultInfo(this)},b.prototype._stylePrepareGeometryChange=function(){GShape.prototype._stylePrepareGeometryChange.call(this),this._runsDirty=!0},b.prototype._handleChange=function(a,c){if(a===GNode._Change.Store?(this.storeProperties(c,b.GeometryProperties,function(a,b){return"ttrf"===a&&b?GTransform.serialize(b):b}),this._content&&(c.ct=GNode.store(this._content)),c.tlx=this._tl.getX(),c.tly=this._tl.getY(),c.trx=this._tr.getX(),c.try=this._tr.getY(),c.blx=this._bl.getX(),c.bly=this._bl.getY(),c.brx=this._br.getX(),c.bry=this._br.getY()):a===GNode._Change.Restore?(this.restoreProperties(c,b.GeometryProperties,function(a,b){return"ttrf"===a&&b?GTransform.deserialize(b):b}),c.ct&&(this._content=GNode.restore(c.ct),this._content._parent=this,this._content._scene=this._scene),this._tl=new GPoint(c.tlx,c.tly),this._tr=new GPoint(c.trx,c.try),this._br=new GPoint(c.brx,c.bry),this._bl=new GPoint(c.blx,c.bly),this._runsDirty=!0):a===GNode._Change.Attached?this._content&&this._content._setScene(this._scene):a===GNode._Change.Detach&&this._content&&this._content._setScene(null),GShape.prototype._handleChange.call(this,a,c),(this._handleGeometryChangeForProperties(a,c,b.GeometryProperties)||this._handleGeometryChangeForProperties(a,c,GStylable.AllGeometryProperties))&&a==GNode._Change.BeforePropertiesChange){var d=c.properties.indexOf("ah");if(d>=0&&c.values[d]===!0&&!this.$ah&&this._textBox&&!this._runsDirty&&(this._tl=this._textBox.getSide(GRect.Side.TOP_LEFT),this._tr=this._textBox.getSide(GRect.Side.TOP_RIGHT),this._br=this._textBox.getSide(GRect.Side.BOTTOM_RIGHT),this._bl=this._textBox.getSide(GRect.Side.BOTTOM_LEFT),this.$trf)){var e=this.$trf.inverted();this._tl=e.mapPoint(this._tl),this._tr=e.mapPoint(this._tr),this._bl=e.mapPoint(this._bl),this._br=e.mapPoint(this._br)}this._runsDirty=!0}if(a===GNode._Change.BeforePropertiesChange){var f=c.properties.indexOf("trf");f>=0&&(this._runsDirty=!0)}},b.prototype._getClipBox=function(){return null},b.prototype._asHtml=function(a,c,d){if(c instanceof b.Break)$("<br>").appendTo(a);else if(c instanceof b.Chunk){var e=c.getContent();if(e&&""!==e)if(d)for(var f=0;f<e.length;++f)$("<span></span>").text(e[f]).appendTo(a);else a.append(document.createTextNode(e))}else c instanceof b.Content||(c instanceof b.Paragraph?a=$("<p></p>").css("margin","0px").css(c.propertiesToCss({})).appendTo(a):c instanceof b.Span&&(a=$("<span></span>").css(c.propertiesToCss({})).appendTo(a)));if(c.hasMixin(GNode.Container))for(var g=c.getFirstChild();null!==g;g=g.getNext())this._asHtml(a,g,d)},b.prototype._fromHtml=function(a,c){if(1===a.nodeType){var d=a.nodeName.toLowerCase();if("p"===d||"div"===d){var e=new b.Paragraph;e.cssToProperties(a.style),c.appendChild(e),c=e}else{if("span"!==d&&"b"!==d&&"strong"!==d&&"i"!==d)return"br"===d?void c.appendChild(new b.Break):void 0;var f=new b.Span;f.cssToProperties(a.style),c.appendChild(f),c=f,"b"===d||"strong"===d?f.setProperty("_tfw",GFont.Weight.Bold):"i"===d&&f.setProperty("_tfs",GFont.Style.Italic)}for(var g=a.firstChild;null!==g;g=g.nextSibling)this._fromHtml(g,c)}else 3===a.nodeType&&""!==a.textContent&&c.appendChild(new b.Chunk(a.textContent))},b.prototype._requireMiterLimitApproximation=function(){return!0},b.prototype.toString=function(){return"[GText]"},a.GText=b}(this),function(a){function b(){GShape.call(this),this._anchorPaths=new b.AnchorPaths,this.appendChild(this._anchorPaths),this._anchorPaths._setScene(this._scene),this._anchorPaths._removalAllowed=!1}GNode.inherit("compoundpath",b,GShape),b.AnchorPaths=function(){},GObject.inheritAndMix(b.AnchorPaths,GNode,[GNode.Container]),b.AnchorPaths.prototype._removalAllowed=!1,b.AnchorPaths.prototype.validateInsertion=function(a){return a instanceof b},b.AnchorPaths.prototype.validateRemoval=function(){return this._removalAllowed?this._removalAllowed:!1},b.AnchorPaths.prototype.serialize=function(){for(var a=[],b=this.getFirstChild();null!==b;b=b.getNext())a.push(GNode.serialize(b));return a},b.AnchorPaths.prototype.deserialize=function(a){for(var b=0;b<a.length;++b){var c=GNode.deserialize(a[b]);this.appendChild(c)}},b.AnchorPaths.prototype._handleChange=function(a,b){var c=this._parent;c&&a==GElement._Change.ChildGeometryUpdate&&(c._notifyChange(GElement._Change.PrepareGeometryUpdate),c.rewindVertices(0),c._notifyChange(GElement._Change.FinishGeometryUpdate)),GNode.prototype._handleChange.call(this,a,b)},b.AnchorPaths.prototype.toString=function(){return"[Object GCompoundPath.AnchorPaths]"},b.prototype._anchorPaths=null,b.prototype._currentPath=null,b.prototype.rewindVertices=function(a){if(this._currentPath=this._anchorPaths.getFirstChild(),0===a&&this._currentPath){for(var b=this._currentPath;null!=b;b=b.getNext())b.rewindVertices(0);return!0}return!1},b.prototype.readVertex=function(a){return this._currentPath?this._currentPath.readVertex(a)?!0:(this._currentPath=this._currentPath.getNext(),this._currentPath&&this._currentPath.readVertex(a)):!1},b.prototype.getAnchorPaths=function(){return this._anchorPaths},b.prototype._handleChange=function(a,b){if(a==GNode._Change.AfterFlagChange){var c=b;if(this._currentPath=this._anchorPaths.getFirstChild(),1==c.set)for(var d=this._currentPath;null!=d;d=d.getNext())d.setFlag(c.flag);else for(var d=this._currentPath;null!=d;d=d.getNext())d.removeFlag(c.flag)}a===GNode._Change.Store?b.paths=this._anchorPaths.serialize():a===GNode._Change.Restore&&b.hasOwnProperty("paths")&&this._anchorPaths.deserialize(b.paths),GShape.prototype._handleChange.call(this,a,b)},b.prototype.setTransform=function(a){this.setProperty("trf",a);for(var b=this._anchorPaths.getFirstChild();null!=b;b=b.getNext())b.setTransform(a)},b.prototype.transform=function(a){if(a&&!a.isIdentity()){this.setProperty("trf",this.$trf?this.$trf.multiplied(a):a);for(var b=this._anchorPaths.getFirstChild();null!=b;b=b.getNext())b.transform(a)}},b.prototype.toString=function(){return"[GCompoundPath]"},a.GCompoundPath=b}(this),function(a){function b(){GItem.call(this),this._setDefaultProperties(b.VisualProperties,b.GeometryProperties,b.MetaProperties)}GNode.inheritAndMix("slice",b,GItem,[GElement.Transform]),b.MetaProperties={trm:!0},b.GeometryProperties={trf:null},b.VisualProperties={cls:new GRGBColor([0,116,217])},b.prototype.getTransform=function(){return this.$trf},b.prototype.setTransform=function(a){this.setProperty("trf",a)},b.prototype.transform=function(a){a&&!a.isIdentity()&&this.setProperty("trf",this.$trf?this.$trf.multiplied(a):a),GElement.Transform.prototype._transformChildren.call(this,a)},b.prototype.validateInsertion=function(a){return a instanceof GLayer},GPage.prototype._paintToBitmap=function(a){this.getScene().paint(a);var b=a.canvas.getBitmap();return this.getProperty("trm")&&b.trim(),b},b.prototype._paint=function(a){if(a.configuration.isSlicesVisible(a)){var b=new GRect(-1,-1,2,2);if(b=this.$trf?this.$trf.mapRect(b):b,a.configuration.isOutline(a)){var c=a.canvas.resetTransform(),d=c?c.mapRect(b):b;a.canvas.strokeRect(d.getX(),d.getY(),d.getWidth(),d.getHeight(),1,a.getOutlineColor()),a.canvas.setTransform(c)}else{var d=b;a.canvas.fillRect(d.getX(),d.getY(),d.getWidth(),d.getHeight(),this.$cls,.5)}}},b.prototype._calculateGeometryBBox=function(){var a=new GRect(-1,-1,2,2);return this.$trf?this.$trf.mapRect(a):a},b.prototype._calculatePaintBBox=function(){return this.getGeometryBBox()},b.prototype._handleChange=function(a,c){a===GNode._Change.Store?(this.storeProperties(c,b.VisualProperties,function(a,b){return"cls"===a&&b?GPattern.serialize(b):b}),this.storeProperties(c,b.GeometryProperties,function(a,b){return"trf"===a&&b?GTransform.serialize(b):b}),this.storeProperties(c,b.MetaProperties)):a===GNode._Change.Restore&&(this.restoreProperties(c,b.VisualProperties,function(a,b){return"cls"===a&&b?GPattern.deserialize(b):b}),this.restoreProperties(c,b.GeometryProperties,function(a,b){return"trf"===a&&b?GTransform.deserialize(b):b}),this.restoreProperties(c,b.MetaProperties)),this._handleGeometryChangeForProperties(a,c,b.GeometryProperties),this._handleVisualChangeForProperties(a,c,b.VisualProperties),GItem.prototype._handleChange.call(this,a,c)},b.prototype._detailHitTest=function(){return new GElement.HitResultInfo(this)},a.GSlice=b}(this),function(a){var b={Default:null,Select:"select",SelectInverse:"select-inverse",SelectDot:"select-dot",SelectDotInverse:"select-dot-inverse",SelectArrowOnly:"select-arrow-only",SelectCross:"select-cross",SelectResizeVert:"select-resize-vert",SelectResizeHoriz:"select-resize-horiz",SelectResizeUpLeftDownRight:"select-upleft-downright",SelectResizeUpRightDownLeft:"select-upright-downleft",SelectSkewVert:"select-skew-vert",SelectSkewHoriz:"select-skew-horiz",SelectRotate:["select-rot-tl","select-rot-tc","select-rot-tr","select-rot-rc","select-rot-br","select-rot-bc","select-rot-bl","select-rot-lc"],ZoomPlus:"zoom-plus",ZoomMinus:"zoom-minus",ZoomNone:"zoom-none",HandOpen:"hand-open",HandClosed:"hand-closed",Cross:"cross",Pen:"pen",PenStart:"pen-start",PenEnd:"pen-end",PenPlus:"pen-plus",PenMinus:"pen-minus",PenModify:"pen-modify",PenDrag:"pen-drag",Lasso:"lasso",Pipette:"pipette",Text:"text"};a.GCursor=b}(this),function(a){function b(){}GObject.inherit(b,GEvent),b.prototype.toString=function(){return"[Object GInputEvent("+this._paramsToString()+")]"},b.prototype._paramsToString=function(){return""},a.GInputEvent=b}(this),function(a){function b(){}GObject.inherit(b,GInputEvent),b.prototype.key=null,b.prototype.toString=function(){return"[Object GKeyEvent("+this._paramsToString()+")]"},b.prototype.GKeyEvent=function(){return"key="+this.key},a.GKeyEvent=b,b.Down=function(){},GObject.inherit(b.Down,b),b.Down.prototype.toString=function(){return"[Object GKeyEvent.Down("+this._paramsToString()+")]"},b.Release=function(){},GObject.inherit(b.Release,b),b.Release.prototype.toString=function(){return"[Object GKeyEvent.Release("+this._paramsToString()+")]"},b.Press=function(){},GObject.inherit(b.Press,b),b.Press.prototype.toString=function(){return"[Object GKeyEvent.Press("+this._paramsToString()+")]"}}(this),function(a){function b(){}GObject.inherit(b,GInputEvent),b.BUTTON_LEFT=0,b.BUTTON_MIDDLE=1,b.BUTTON_RIGHT=2,b.isDragEvent=function(a){return a instanceof b&&(a instanceof b.DragStart||a instanceof b.Drag||a instanceof b.DragEnd)||a==b.DragStart||a==b.Drag||a==b.DragEnd},b.prototype.client=0,b.prototype.button=0,b.prototype.toString=function(){return"[Object GMouseEvent("+this._paramsToString()+")]"},b.prototype._paramsToString=function(){return"client="+this.client.toString()+", "+GInputEvent.prototype._paramsToString.call(this)},a.GMouseEvent=b,b.Move=function(){},GObject.inherit(b.Move,b),b.Move.prototype.toString=function(){return"[Object GMouseEvent.Move("+this._paramsToString()+")]"},b.Enter=function(){},GObject.inherit(b.Enter,b),b.Enter.prototype.toString=function(){return"[Object GMouseEvent.Enter("+this._paramsToString()+")]"},b.Leave=function(){},GObject.inherit(b.Leave,b),b.Leave.prototype.toString=function(){return"[Object GMouseEvent.Leave("+this._paramsToString()+")]"},b.Down=function(){},GObject.inherit(b.Down,b),b.Down.prototype.toString=function(){return"[Object GMouseEvent.Down("+this._paramsToString()+")]"},b.Release=function(){},GObject.inherit(b.Release,b),b.Release.prototype.toString=function(){return"[Object GMouseEvent.Release("+this._paramsToString()+")]"},b.Click=function(){},GObject.inherit(b.Click,b),b.Click.prototype.toString=function(){return"[Object GMouseEvent.Click("+this._paramsToString()+")]"},b.DblClick=function(){},GObject.inherit(b.DblClick,b),b.DblClick.prototype.toString=function(){return"[Object GMouseEvent.DblClick("+this._paramsToString()+")]"},b.DragStart=function(){},GObject.inherit(b.DragStart,b),b.DragStart.prototype.toString=function(){return"[Object GMouseEvent.DragStart("+this._paramsToString()+")]"},b.Drag=function(){},GObject.inherit(b.Drag,b),b.prototype.clientStart=0,b.prototype.clientDelta=0,b.Drag.prototype.toString=function(){return"[Object GMouseEvent.Drag("+this._paramsToString()+")]"},b.DragEnd=function(){},GObject.inherit(b.DragEnd,b.Drag),b.DragEnd.prototype.toString=function(){return"[Object GMouseEvent.DragEnd("+this._paramsToString()+")]"}}(this),function(a){function b(a){this._view=a,this._canvas=new GPaintCanvas,this._paintContext=new GPaintContext,this._paintContext.configuration=a.getViewConfiguration()?a.getViewConfiguration():new GPaintConfiguration,this._paintContext.canvas=this._canvas,this._dirtyList=new GDirtyList}b.prototype._view=null,b.prototype._canvas=null,b.prototype._paintContext=null,b.prototype._dirtyList=null,b.prototype._repaintRequestFrameId=null,b.prototype.show=function(){this._canvas._canvasContext.canvas.style.visibility=""},b.prototype.hide=function(){this._canvas._canvasContext.canvas.style.visibility="hidden"},b.prototype.release=function(){},b.prototype.invalidate=function(a){return(!a||a.isEmpty())&&(this._dirtyList.reset(),a=this._dirtyList.getArea()),a&&this._dirtyList.dirty(a.getX(),a.getY(),a.getWidth(),a.getHeight())?(null==this._repaintRequestFrameId&&(this._repaintRequestFrameId=ifPlatform.scheduleFrame(this._repaint.bind(this))),!0):!1},b.prototype.paint=function(){},b.prototype.resize=function(a,b){this._canvas.resize(a,b),this.updateViewArea()},b.prototype.updateViewArea=function(){var a=new GRect(0,0,this._view.getWidth(),this._view.getHeight());GRect.equals(this._dirtyList.getArea(),a)||(this._dirtyList.setArea(a),this.invalidate())},b.prototype._repaint=function(){var a=this._dirtyList.flush();null!=a&&(this._canvas.prepare(a.getDirtyRectangles()),this._paintContext.dirtyMatcher=a,this.paint&&this.paint.call(this,this._paintContext),this._canvas.finish()),this._repaintRequestFrameId=null},b.prototype.toString=function(){return"[Object GStage]"},a.GStage=b}(this),function(a){function b(a){GStage.call(this,a),a.getScene().addEventListener(GScene.InvalidationRequestEvent,this._sceneInvalidationRequest,this)}GObject.inherit(b,GStage),b.prototype._pixelContentCanvas=null,b.prototype.release=function(){this._view.getScene().removeEventListener(GScene.InvalidationRequestEvent,this._sceneInvalidationRequest,this)},b.prototype.resize=function(a,b){GStage.prototype.resize.call(this,a,b),this._pixelContentCanvas&&this._pixelContentCanvas.resize(a,b)},b.prototype.paint=function(a){if(a.dirtyMatcher&&a.dirtyMatcher.transform(this._view.getViewTransform()),this._view.getViewConfiguration().pixelMode&&!GMath.isEqualEps(this._view.getZoom(),1)){this._pixelContentCanvas||(this._pixelContentCanvas=new GPaintCanvas,this._pixelContentCanvas.resize(a.canvas.getWidth(),a.canvas.getHeight()));var b=this._view.getScene().getChildrenPaintBBox();this._pixelContentCanvas.prepare([b]);var c=b.getSide(GRect.Side.TOP_LEFT),d=b.getWidth(),e=b.getHeight();this._pixelContentCanvas.setTransform(new GTransform(1,0,0,1,-c.getX(),-c.getY())),this._pixelContentCanvas.resize(d,e);var f=a.pushCanvas(this._pixelContentCanvas);this._view.getScene().paint(a),f.setTransform(this._view.getWorldTransform()),f.drawImage(this._pixelContentCanvas,c.getX(),c.getY(),!0),this._pixelContentCanvas.finish(),a.popCanvas()}else this._pixelContentCanvas=null,a.canvas.setOrigin(new GPoint(this._view._scrollX,this._view._scrollY)),a.canvas.setScale(this._view._zoom),this._view.getScene().paint(a)},b.prototype._sceneInvalidationRequest=function(a){var b=a.area;b&&(b=this._view.getWorldTransform().mapRect(b)),this.invalidate(b)},b.prototype.toString=function(){return"[Object GSceneStage]"},a.GSceneStage=b}(this),function(a){function b(a){this._htmlElement=this._createHTMLElement(),null!=a&&(this._htmlElement.style.position="relative",a.appendChild(this._htmlElement))}GObject.inheritAndMix(b,GObject,[GEventTarget]),b.convertClientPositionFromMousePosition=function(a,b){var c=null,d=null;if(b.target==a&&("absolute"===a.style.position?b.hasOwnProperty("offsetX")&&(c=b.offsetX,d=b.offsetY):(c=b.clientX,d=b.clientY)),null==c||null==d){var e=a.getBoundingClientRect();c=b.pageX-(e.left+window.pageXOffset-document.documentElement.clientLeft),d=b.pageY-(e.top+window.pageYOffset-document.documentElement.clientTop)}return new GPoint(c,d)},b.prototype._htmlElement=null,b.prototype._inputEventCache=null,b.prototype._dragEventCounter=0,b.prototype._id=null,b.prototype._parent=null,b.prototype._x=0,b.prototype._y=0,b.prototype._width=0,b.prototype._height=0,b.prototype._cursor=null,b.prototype.getX=function(){return this._x},b.prototype.getY=function(){return this._y},b.prototype.getWidth=function(){return this._htmlElement.offsetWidth?this._htmlElement.offsetWidth:this._width},b.prototype.getHeight=function(){return this._htmlElement.offsetHeight?this._htmlElement.offsetHeight:this._height},b.prototype.move=function(a,b){this._htmlElement.style.left="number"==typeof a?a.toString()+"px":"",this._htmlElement.style.top="number"==typeof b?b.toString()+"px":"",this._htmlElement.style.position="number"==typeof a||"number"==typeof b?"absolute":"",this._x=a,this._y=b},b.prototype.resize=function(a,b){this._htmlElement.style.width=a?a.toString()+"px":"",this._htmlElement.style.height=b?b.toString()+"px":"",this._htmlElement.style.overflowX=a?"hidden":"",this._htmlElement.style.overflowY=b?"hidden":"",this._width=a,this._height=b},b.prototype.getCursor=function(){return this._cursor},b.prototype.setCursor=function(a){this._cursor!=a&&(this._cursor&&this._removeCSSClass("g-cursor-"+this._cursor,!0),this._cursor=a,this._cursor&&this._addCSSClass("g-cursor-"+this._cursor,!0))},b.prototype.isEnabled=function(){return null==this._htmlElement.className||this._htmlElement.className.indexOf("g-disabled")<0},b.prototype.setEnabled=function(a){a!=this.isEnabled()&&(a?this._removeCSSClass("g-disabled",!0):this._addCSSClass("g-disabled",!0))},b.prototype.isDisplayed=function(){return"none"!=this._htmlElement.style.display},b.prototype.setDisplayed=function(a){this._htmlElement.style.display=a?"":"none"},b.prototype.trigger=function(a){this._dragEventCounter>0&&a instanceof GMouseEvent.Release&&this._dragMouseRelease(a),GEventTarget.prototype.trigger.call(this,a),this._dragEventCounter>0&&(a instanceof GMouseEvent.Down?this._dragMouseDown(a):a instanceof GMouseEvent.Move&&this._dragStartPosition&&this._dragMouseMove(a))},b.prototype.addEventListener=function(a,b,c,d){GEventTarget.prototype.addEventListener.call(this,a,b,c,d),GInputEvent.prototype.isPrototypeOf(a.prototype)&&(this._registerInputEventListener(a),GMouseEvent.isDragEvent(a)&&(0==this._dragEventCounter&&(this._registerInputEventListener(GMouseEvent.Down),this._registerInputEventListener(GMouseEvent.Move),this._registerInputEventListener(GMouseEvent.Release)),this._dragEventCounter++))},b.prototype.removeEventListener=function(a,b){GEventTarget.prototype.removeEventListener.call(this,a,b),GInputEvent.prototype.isPrototypeOf(a.prototype)&&(this._unregisterInputEventListener(a),GMouseEvent.isDragEvent(a)&&0==--this._dragEventCounter&&(this._unregisterInputEventListener(GMouseEvent.Down),this._unregisterInputEventListener(GMouseEvent.Move),this._unregisterInputEventListener(GMouseEvent.Release)))},b.prototype.focus=function(){if(this.isDisplayed())try{return this._htmlElement.focus(),!0}catch(a){return!1}return!1},b.prototype._registerInputEventListener=function(a){var b=GMouseEvent.isDragEvent(a),c=GObject.getTypeId(a);this._inputEventCache&&c in this._inputEventCache?this._inputEventCache&&c in this._inputEventCache&&this._inputEventCache[c].counter++:(this._inputEventCache||(this._inputEventCache={}),this._inputEventCache[c]={counter:0,event:new a},b||this._startListeningInputEvent(a))},b.prototype._unregisterInputEventListener=function(a){var b=GMouseEvent.isDragEvent(a),c=GObject.getTypeId(a);this._inputEventCache&&c in this._inputEventCache&&0==--this._inputEventCache[c].counter&&(b||this._stopListeningInputEvent(a),delete this._inputEventCache[c],0==Object.keys(this._inputEventCache).length&&(this._inputEventCache=null))},b.prototype._startListeningInputEvent=function(a){var b=GObject.getTypeId(a),c=function(b){this._updateAndTriggerInputEvent(b,a)}.bind(this);if(c){this._inputEventCache[b].domListener=c;var d=this._getDomEventNameForEventClass(a);this._htmlElement.addEventListener(d,c)}},b.prototype._stopListeningInputEvent=function(a){var b=GObject.getTypeId(a),c=this._getDomEventNameForEventClass(a);this._htmlElement.removeEventListener(c,this._inputEventCache[b].domListener),delete this._inputEventCache[b].domListener},b.prototype._dragMouseDown=function(a){a.button==GMouseEvent.BUTTON_LEFT&&(this._dragStartPosition=a.client,this._dragIsDragging=!1)},b.prototype._dragMouseMove=function(a){if(this._dragStartPosition&&!this._dragIsDragging){var b=this._dragStartPosition;if((Math.abs(b.getX()-a.client.getX())>=1||Math.abs(b.getY()-a.client.getY())>=1)&&(this._dragIsDragging=!0,this._dragPreviousPosition=this._dragStartPosition,this.hasEventListeners(GMouseEvent.DragStart))){var c=this._inputEventCache[GObject.getTypeId(GMouseEvent.DragStart)].event;this._dragAssignMouseEvent(a,c),c.client=this._dragStartPosition,this.trigger(c)}}if(this._dragIsDragging&&this.hasEventListeners(GMouseEvent.Drag)){var c=this._inputEventCache[GObject.getTypeId(GMouseEvent.Drag)].event;this._dragAssignMouseEvent(a,c),this._dragAssignDragEvent(c,a),this.trigger(c),this._dragPreviousPosition=a.client}},b.prototype._dragMouseRelease=function(a){if(a.button==GMouseEvent.BUTTON_LEFT){if(this._dragIsDragging){var b=this._inputEventCache[GObject.getTypeId(GMouseEvent.DragEnd)].event;this._dragAssignMouseEvent(a,b),this._dragAssignDragEvent(b,a),this.trigger(b)}delete this._dragStartPosition,delete this._dragPreviousPosition,delete this._dragIsDragging}},b.prototype._dragAssignMouseEvent=function(a,b){b.client=a.client,b.button=a.button},b.prototype._dragAssignDragEvent=function(a,b){a.clientStart=this._dragStartPosition,a.clientDelta=b.client.subtract(this._dragPreviousPosition)},b.prototype._setParent=function(a){this._parent=a},b.prototype._updateLocale=function(){var a=null;this._hint&&(a=this._hint.asHtml()),a&&0!=a.length?this._htmlElement.setAttribute("data-qhint",qUtil.escape(a)):this._htmlElement.removeAttribute("data-qhint")},b.prototype._triggerWidgetEventFromDom=function(a,b){b instanceof GMouseEvent.Down&&b.button===GMouseEvent.BUTTON_LEFT?this._setCapture():b instanceof GMouseEvent.Release&&this._releaseCapture(),this.trigger(b)},b.prototype._updateAndTriggerInputEvent=function(a,b){if(this.isEnabled()){if("keydown"===a.type){var c=GKey.translateKey(a.which||a.keyCode);switch(c){case GKey.Constant.TAB:a.preventDefault()}}else"mousedown"===a.type&&a.preventDefault();GMouseEvent.prototype.isPrototypeOf(b.prototype)?this._updateAndTriggerMouseEvent(a,GObject.getTypeId(b)):GKeyEvent.prototype.isPrototypeOf(b.prototype)&&this._updateAndTriggerKeyEvent(a,GObject.getTypeId(b))}},b.prototype._updateAndTriggerMouseEvent=function(a,c){var d=this._inputEventCache[c].event;d.client=b.convertClientPositionFromMousePosition(this._htmlElement,a),d.button=a.button,this._triggerWidgetEventFromDom(a,d)},b.prototype._updateAndTriggerKeyEvent=function(a,b){var c=this._inputEventCache[b].event;c.key=GKey.translateKey(a.which||a.keyCode),this._triggerWidgetEventFromDom(a,c)},b.prototype._getDomEventNameForEventClass=function(a){switch(a){case GMouseEvent.Move:return"mousemove";case GMouseEvent.Enter:return"mouseover";case GMouseEvent.Leave:return"mouseout";case GMouseEvent.Down:return"mousedown";case GMouseEvent.Release:return"mouseup";case GMouseEvent.Click:return"click";case GMouseEvent.DblClick:return"dblclick";case GKeyEvent.Down:return"keydown";case GKeyEvent.Release:return"keyup";case GKeyEvent.Press:return"keypress"}throw new Error("Unknown DOMEvent name")};var c=[GMouseEvent.Move,GMouseEvent.Release,GKeyEvent.Down,GKeyEvent.Release,GKeyEvent.Press];b.prototype._setCapture=function(){function a(a){var c=b._getDomEventNameForEventClass(a);b._savedDocumentListeners||(b._savedDocumentListeners={}),b._savedDocumentListeners[c]=function(c){c.target!=this._htmlElement&&(b._updateAndTriggerInputEvent(c,a),c.stopImmediatePropagation())}.bind(b),document.addEventListener(c,b._savedDocumentListeners[c],!0)}for(var b=this,d=0;d<c.length;++d){var e=c[d];this._inputEventCache[GObject.getTypeId(e)]&&a(e)}},b.prototype._releaseCapture=function(){if(this._savedDocumentListeners){for(var a in this._savedDocumentListeners)document.removeEventListener(a,this._savedDocumentListeners[a],!0);delete this._savedDocumentListeners}},b.prototype._addCSSClass=function(a,b){!b&&this._BASE_CSS_CLASS&&(a=this._BASE_CSS_CLASS+"-"+a);var c=this._htmlElement.className;if(c&&0!=c.trim().length){for(var d=!0,e=c.trim().split(" "),f=0;f<e.length;++f){var g=e[f].trim();if(g==a){d=!1;break}}d&&(c+=" "+a)}else c=a;this._htmlElement.className=c},b.prototype._removeCSSClass=function(a,b){!b&&this._BASE_CSS_CLASS&&(a=this._BASE_CSS_CLASS+"-"+a);var c=this._htmlElement.className;if(c&&c.indexOf(a)>=0){for(var d="",e=c.trim().split(" "),f=0;f<e.length;++f){var g=e[f].trim();g!=a&&(d.length>0&&(d+=" "),d+=g)}this._htmlElement.className=d}},b.prototype._createHTMLElement=function(){var a=document.createElement("div");return a.setAttribute("tabindex","0"),a},b.prototype.toString=function(){return"[Object GWidget]"},a.GWidget=b}(this),function(a){function b(a){this._updateViewTransforms(!0),GWidget.apply(this,arguments.length>1?Array.prototype.slice.call(arguments,1):null),this._scene=a,this._viewOffset=[0,0,0,0],this._viewMargin=[0,0,0,0],this._pageConfigurations=[],this._viewConfiguration||(this._viewConfiguration=new GScenePaintConfiguration),this._initStages(),a.addEventListener(GNode.AfterFlagChangeEvent,this._afterFlagChange,this),a.addEventListener(GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),a.addEventListener(GNode.AfterRemoveEvent,this._afterRemove,this)}GObject.inherit(b,GWidget),b.options={minZoomFactor:.05,maxZoomFactor:512,defaultFitActivePage:!1},b.TransformEvent=function(){},GObject.inherit(b.TransformEvent,GEvent),b.TransformEvent.prototype.toString=function(){return"[Object GSceneWidget.TransformEvent]"},b.TRANSFORMEVENT=new b.TransformEvent,b.prototype._scene=null,b.prototype._stages=null,b.prototype._viewOffset=null,b.prototype._viewMargin=null,b.prototype._scrollX=0,b.prototype._scrollY=0,b.prototype._zoom=1,b.prototype._worldToViewTransform=null,b.prototype._viewToWorldTransform=null,b.prototype._viewConfiguration=null,b.prototype._pageConfigurations=null,b.prototype.resize=function(a,b){if(GWidget.prototype.resize.call(this,a,b),this._stages)for(var c=0;c<this._stages.length;++c)this._stages[c].resize(this.getWidth(),this.getHeight())},b.prototype.getScene=function(){return this._scene},b.prototype.getViewConfiguration=function(){return this._viewConfiguration},b.prototype.getViewOffset=function(){return this._viewOffset},b.prototype.setViewOffset=function(a){if(this._viewOffset=[0,0,0,0],a&&a.length>0){for(var b=0;b<Math.min(4,a.length);++b)this._viewOffset[b]=a[b];if(this._stages)for(var b=0;b<this._stages.length;++b)this._stages[b].updateViewArea()}},b.prototype.getViewMargin=function(){return this._viewMargin},b.prototype.setViewMargin=function(a){if(this._viewMargin=[0,0,0,0],a&&a.length>0)for(var b=0;b<Math.min(4,a.length);++b)this._viewMargin[b]=a[b],this.invalidate()},b.prototype.getScrollX=function(){return this._scrollX
},b.prototype.getScrollY=function(){return this._scrollY},b.prototype.getZoom=function(){return this._zoom},b.prototype.getWorldTransform=function(){return this._worldToViewTransform},b.prototype.getViewTransform=function(){return this._viewToWorldTransform},b.prototype.getViewBox=function(a){var b=this._viewOffset[0]+(a?0:this._viewMargin[0]),c=this._viewOffset[1]+(a?0:this._viewMargin[1]);return new GRect(b,c,this.getWidth()-(this._viewOffset[2]+(a?0:this._viewMargin[2])+b),this.getHeight()-(this._viewOffset[3]+(a?0:this._viewMargin[3])+c))},b.prototype.transform=function(a,b,c){this._scrollX=a,this._scrollY=b,this._zoom=c,this._updateViewTransforms()},b.prototype.zoomAtCenter=function(a,c){c=c||this._zoom;var d=this.getViewBox().getSide(GRect.Side.CENTER),e=this._worldToViewTransform.mapPoint(a),f=Math.min(b.options.maxZoomFactor,Math.max(c,b.options.minZoomFactor));if(f!=this._zoom||!GPoint.equals(e,d)){var g=(new GTransform).translated(-a.getX(),-a.getY()).scaled(f,f).translated(d.getX(),d.getY()),h=g.getMatrix();this._scrollX=-h[4],this._scrollY=-h[5],this._zoom=f,this._updateViewTransforms()}},b.prototype.zoomAt=function(a,b){var c=this.getViewBox().getSide(GRect.Side.CENTER),d=this._viewToWorldTransform.mapPoint(c),e=d.subtract(a),f=b/this._zoom;this.zoomAtCenter(new GPoint(a.getX()+e.getX()/f,a.getY()+e.getY()/f),b)},b.prototype.zoomAll=function(a,b){var c=a.getSide(GRect.Side.CENTER),d=a.getWidth(),e=a.getHeight(),f=this.getViewBox();if(b){var g=this._worldToViewTransform.mapRect(new GRect(c.getX()-d/2,c.getY()-e/2,d,e)),h=this._zoom*Math.min(1,Math.max(g.getWidth()/f.getWidth(),g.getHeight()/f.getHeight()));this.zoomAtCenter(c,h)}else this.zoomAtCenter(c,1/Math.max(d/f.getWidth(),e/f.getHeight()))},b.prototype.zoomActivePage=function(){var a=this._scene.getActivePage();if(a){var c=this._getOrCreatePageConfig(a,!1);if(c)this.transform(c.scrollX,c.scrollY,c.zoom);else{var d=a.getPaintBBox();d&&!d.isEmpty()&&(b.options.defaultFitActivePage?this.zoomAll(d,!1):this.zoomAtCenter(d.getSide(GRect.Side.CENTER),1))}}},b.prototype.scrollBy=function(a,b){(0!=a||0!=b)&&(this._scrollX=this._scrollX+a,this._scrollY=this._scrollY+b,this._updateViewTransforms())},b.prototype.invalidate=function(a){var b=!1;if(this._stages)for(var c=0;c<this._stages.length;++c)b=this._stages[c].invalidate(a)||b;return b},b.prototype.addStage=function(a){null==this._stages&&(this._stages=[]),this._stages.push(a);var b=a._canvas._canvasContext.canvas;return b.style.position="absolute",b.style.cursor="inherit",a.resize(this.getWidth(),this.getHeight()),this._htmlElement.appendChild(b),a},b.prototype.getStage=function(a){if(this._stages)for(var b=0;b<this._stages.length;++b)if(a.prototype.isPrototypeOf(this._stages[b]))return this._stages[b];return null},b.prototype.release=function(){if(this._scene.removeEventListener(GNode.AfterFlagChangeEvent,this._afterFlagChange,this),this._scene.removeEventListener(GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._scene.removeEventListener(GNode.AfterRemoveEvent,this._afterRemove,this),this._stages)for(var a=0;a<this._stages.length;++a)this._stages[a].release()},b.prototype._updateViewTransforms=function(a){this._scrollX=Math.round(this._scrollX),this._scrollY=Math.round(this._scrollY);var c=(new GTransform).scaled(this._zoom,this._zoom).translated(-this._scrollX,-this._scrollY);GTransform.equals(c,this._worldToViewTransform)||(this._worldToViewTransform=c,this._viewToWorldTransform=c.inverted(),this.invalidate(),!a&&this.hasEventListeners(b.TransformEvent)&&this.trigger(b.TRANSFORMEVENT))},b.prototype._initStages=function(){this.addStage(new GSceneStage(this))},b.prototype._getOrCreatePageConfig=function(a,b){for(var c=null,d=0;d<this._pageConfigurations.length;++d)if(this._pageConfigurations[d].page===a){c=this._pageConfigurations[d];break}return!c&&b&&(c={page:a},this._pageConfigurations.push(c)),c},b.prototype._afterFlagChange=function(a){if(this._scene.getProperty("singlePage")&&a.node instanceof GPage&&a.flag===GNode.Flag.Active)if(this.invalidate(),a.set)this.zoomActivePage();else{var b=this._getOrCreatePageConfig(a.node,!0);b.scrollX=this._scrollX,b.scrollY=this._scrollY,b.zoom=this._zoom}},b.prototype._afterPropertiesChange=function(a){a.node===this._scene&&a.properties.indexOf("singlePage")>=0&&(this.zoomActivePage(),this.invalidate())},b.prototype._afterRemove=function(a){if(a.node instanceof GPage)for(var b=0;b<this._pageConfigurations.length;++b)if(this._pageConfigurations[b].page===a.node){this._pageConfigurations.splice(b,1);break}},b.prototype.toString=function(){return"[Object GSceneWidget]"},a.GSceneWidget=b}(this),ifLocale.setValues(GLocale,GLocale.Language.English,["create","add","edit","remove","delete","open","save","cancel","ok","close","loading","loading_of","saving","saving_of","success","failure","waiting"],["Create","Add","Edit","Remove","Delete","Open","Save","Cancel","OK","Close","Loading","Loading of","Saving","Saving of","Success","Failure","Waiting"]),ifLocale.setValues(GKey,GLocale.Language.English,["key.1"],["Space"]),ifLocale.setValues(GKey,GLocale.Language.English,["key.2"],["Enter"]),ifLocale.setValues(GKey,GLocale.Language.English,["key.3"],["Tab"]),ifLocale.setValues(GKey,GLocale.Language.English,["key.4"],["Backspace"]),ifLocale.setValues(GKey,GLocale.Language.English,["key.5","key.5.short"],["Control","Ctrl"]),ifLocale.setValues(GKey,GLocale.Language.English,["key.6"],["Shift"]),ifLocale.setValues(GKey,GLocale.Language.English,["key.7"],["Alt"]),ifLocale.setValues(GKey,GLocale.Language.English,["key.8"],["Left"]),ifLocale.setValues(GKey,GLocale.Language.English,["key.9"],["Up"]),ifLocale.setValues(GKey,GLocale.Language.English,["key.10"],["Right"]),ifLocale.setValues(GKey,GLocale.Language.English,["key.11"],["Down"]),ifLocale.setValues(GKey,GLocale.Language.English,["key.12"],["Page Up"]),ifLocale.setValues(GKey,GLocale.Language.English,["key.13"],["Page Down"]),ifLocale.setValues(GKey,GLocale.Language.English,["key.14"],["Home"]),ifLocale.setValues(GKey,GLocale.Language.English,["key.15"],["End"]),ifLocale.setValues(GKey,GLocale.Language.English,["key.16","key.16.short"],["Insert","Ins"]),ifLocale.setValues(GKey,GLocale.Language.English,["key.17","key.17.short"],["Delete","Del"]),ifLocale.setValues(GKey,GLocale.Language.English,["key.18","key.18.short"],["Escape","Esc"]),ifLocale.setValues(GKey,GLocale.Language.English,["key.19","key.19.short"],["Command","Cmd"]),ifLocale.setValues(GKey,GLocale.Language.English,["key.30","key.31","key.32","key.33","key.34","key.35","key.36","key.37","key.38","key.39","key.40","key.41"],["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12"]),ifLocale.setValues(GFont,GLocale.Language.English,["weight.thin","weight.extra-light","weight.light","weight.regular","weight.medium","weight.semi-bold","weight.bold","weight.extra-bold","weight.heavy","category.other","category.serif","category.monospace","category.iconic"],["Thin","Extra-Light","Light","Regular","Medium","Semi-Bold","Bold","Extra-Bold","Heavy","Other","Serif","Monospace","Iconic"]),ifLocale.setValues(GEllipse,GLocale.Language.English,["name"],["Ellipse"]),ifLocale.setValues(GRectangle,GLocale.Language.English,["name"],["Rectangle"]),ifLocale.setValues(GLayer,GLocale.Language.English,["name","type.output","type.draft","type.guide"],["Layer","Output","Draft","Guide"]),ifLocale.setValues(GGroup,GLocale.Language.English,["name"],["Group"]),ifLocale.setValues(GScene,GLocale.Language.English,["name"],["Scene"]),ifLocale.setValues(GPolygon,GLocale.Language.English,["name"],["Polygon"]),ifLocale.setValues(GPage,GLocale.Language.English,["name"],["Page"]),ifLocale.setValues(GPath,GLocale.Language.English,["name"],["Path"]),ifLocale.setValues(GCompoundPath,GLocale.Language.English,["name"],["Compound Path"]),ifLocale.setValues(GText,GLocale.Language.English,["name"],["Text"]),ifLocale.setValues(GScenePaintConfiguration,GLocale.Language.English,["paint.full","paint.fast","paint.outline","paint.output"],["Full","Fast","Outline","Output"]),ifLocale.setValues(GSlice,GLocale.Language.English,["name"],["Slice"]),ifLocale.setValues(GBlurEffect,GLocale.Language.English,["name"],["Blur"]),ifLocale.setValues(GColorGradingEffect,GLocale.Language.English,["name"],["Color Grading"]),ifLocale.setValues(GColorMatrixEffect,GLocale.Language.English,["name"],["Color Matrix"]),ifLocale.setValues(GColorTransformEffect,GLocale.Language.English,["name"],["Color Transform"]),ifLocale.setValues(GDropShadowEffect,GLocale.Language.English,["name"],["Drop Shadow"]),ifLocale.setValues(GInnerShadowEffect,GLocale.Language.English,["name"],["Inner Shadow"]),ifLocale.setValues(GOverlayEffect,GLocale.Language.English,["name"],["Overlay"]),ifLocale.setValues(GStylable,GLocale.Language.English,["layer.element","layer.fill","layer.border"],["Element","Fill","Border"]);