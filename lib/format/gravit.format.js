!function(){function a(){GReader.call(this)}GObject.inherit(a,GReader),a.prototype.getInputType=function(){return GReader.InputType.ArrayBuffer},a.prototype.getMimeType=function(){return"application/x-adobe-acv"},a.prototype.getFileExtensions=function(){return["acv"]},a.prototype.readInput=function(a,b){var c=new jDataView(a),d={rgb:[],r:[],g:[],b:[]};c.seek(4);var e=c.getUint16(),f=["r","g","b"],g=null,h=null,i=null,j=null,k=null;for(d.rgb.push([0,c.getUint16()]),c.seek(c.tell()+2),j=1;e>j;j++)i=c.getUint16(),h=c.getUint16(),d.rgb.push([h,i]);for(j=0;3>j;j++)for(e=c.getUint16(),g=d[f[j]],k=0;e>k;k++)i=c.getUint16(),h=c.getUint16(),g.push([h,i]);b(d)},GIO.registerReader(new a)}(this),function(){function a(){GReader.call(this)}var b=1,c=49153,d=49154,e=1,f=2,g=1,h=2,i=3,j=4,k=5,l=6,m={CMYK:4,RGB:3,LAB:3,GRAY:1},n={0:"global",1:"spot",2:"normal"};GObject.inherit(a,GReader),a.prototype.getInputType=function(){return GReader.InputType.ArrayBuffer},a.prototype.getMimeType=function(){return"application/x-adobe-ase"},a.prototype.getFileExtensions=function(){return["ase"]},a.prototype.readInput=function(a,o){function p(){switch(x.getUint16(H)){case b:A.push(C=E={}),G=e;break;case c:z.push(C=D={colors:[]}),G=f;break;case d:D=null;break;default:throw new Error("Unexpected block type at byte #"+H)}D&&C===E&&D.colors.push(E),H+=2,F=h}function q(){B=x.getUint32(H),H+=4,F=B?i:g}function r(){for(var a=x.getUint16(H),b="";--a;)b+=w(H+=2);H+=4,C.name=b,F=G===f?g:j}function s(){C.model=(v(H++)+v(H++)+v(H++)+v(H++)).trim(),F=k}function t(){for(var a=C.model.toUpperCase(),b=m[a],c=[];b--;)c.push(x.getFloat32(H)),H+=4;C.color=c,F=l}function u(){C.type=n[x.getUint16(H)],H+=2,F=g}function v(a){return String.fromCharCode(x.getUint8(a))}function w(a){return String.fromCharCode(x.getUint16(a))}var x=new jDataView(a,void 0,void 0,!1),y={},z=y.groups=[],A=y.colors=[];if("A"!==v(0)||"S"!==v(1)||"E"!==v(2)||"F"!==v(3))return void o(null);y.version=[x.getUint16(4),x.getUint16(6)].join(".");var B,C,D,E,F=(x.getUint32(8),g),G=e,H=12;a:for(;H<x.byteLength;){switch(F){case g:p();continue a;case h:q();continue a;case i:r();continue a;case j:s();continue a;case k:t();continue a;case l:u();continue a}throw new Error("Unexpected")}o(y)},GIO.registerReader(new a)}(this),function(){function a(){GReader.call(this)}function b(a){var b={opts:a};b.MAX_VIRTUAL_PIXELS=3e4,b.log=function(){},1==b.opts.log&&"undefined"!=typeof console&&(b.log=function(a){console.log(a)}),b.init=function(){var a=0;b.UniqueId=function(){return a++,"canvg"+a},b.Definitions={},b.Styles={},b.Images=[],b.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(a,b){this.viewPorts.push({width:a,height:b})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(a){return null!=a&&"number"==typeof a?a:"x"==a?this.width():"y"==a?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},b.init(),b.ImagesLoaded=function(){for(var a=0;a<b.Images.length;a++)if(!b.Images[a].loaded)return!1;return!0},b.trim=function(a){return a.replace(/^\s+|\s+$/g,"")},b.compressSpaces=function(a){return a.replace(/[\s\r\t\n]+/gm," ")},b.ajax=function(a){var b;return b=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),b?(b.open("GET",a,!1),b.send(null),b.responseText):null},b.parseXml=function(a){if("undefined"!=typeof Windows&&"undefined"!=typeof Windows.Data&&"undefined"!=typeof Windows.Data.Xml){var b=new Windows.Data.Xml.Dom.XmlDocument,c=new Windows.Data.Xml.Dom.XmlLoadSettings;return c.prohibitDtd=!1,b.loadXml(a,c),b}if(window.DOMParser){var d=new DOMParser;return d.parseFromString(a,"text/xml")}a=a.replace(/<!DOCTYPE svg[^>]*>/,"");var b=new ActiveXObject("Microsoft.XMLDOM");return b.async="false",b.loadXML(a),b},b.Property=function(a,b){this.name=a,this.value=b},b.Property.prototype.getValue=function(){return this.value},b.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},b.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var a=parseFloat(this.value);return(this.value+"").match(/%$/)&&(a/=100),a},b.Property.prototype.valueOrDefault=function(a){return this.hasValue()?this.value:a},b.Property.prototype.numValueOrDefault=function(a){return this.hasValue()?this.numValue():a},b.Property.prototype.addOpacity=function(a){var c=this.value;if(null!=a.value&&""!=a.value&&"string"==typeof this.value){var d=this.value?GRGBColor.parseCSSColor(this.value):null;d&&(c="rgba("+d[0]+", "+d[1]+", "+d[2]+", "+a.numValue()+")")}return new b.Property(this.name,c)},b.Property.prototype.getDefinition=function(){var a=this.value.match(/#([^\)'"]+)/);return a&&(a=a[1]),a||(a=this.value),b.Definitions[a]},b.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},b.Property.prototype.getFillStyleDefinition=function(a,c){var d=this.getDefinition();if(null!=d&&d.createGradient)return d.createGradient(b.ctx,a,c);if(null!=d&&d.createPattern){if(d.getHrefAttribute().hasValue()){var e=d.attribute("patternTransform");d=d.getHrefAttribute().getDefinition(),e.hasValue()&&(d.attribute("patternTransform",!0).value=e.value)}return d.createPattern(b.ctx,a)}return null},b.Property.prototype.getDPI=function(){return 96},b.Property.prototype.getEM=function(a){var c=12,d=new b.Property("fontSize",b.Font.Parse(b.ctx.font).fontSize);return d.hasValue()&&(c=d.toPixels(a)),c},b.Property.prototype.getUnits=function(){var a=this.value+"";return a.replace(/[0-9\.\-]/g,"")},b.Property.prototype.toPixels=function(a,c){if(!this.hasValue())return 0;var d=this.value+"";if(d.match(/em$/))return this.numValue()*this.getEM(a);if(d.match(/ex$/))return this.numValue()*this.getEM(a)/2;if(d.match(/px$/))return this.numValue();if(d.match(/pt$/))return this.numValue()*this.getDPI(a)*(1/72);if(d.match(/pc$/))return 15*this.numValue();if(d.match(/cm$/))return this.numValue()*this.getDPI(a)/2.54;if(d.match(/mm$/))return this.numValue()*this.getDPI(a)/25.4;if(d.match(/in$/))return this.numValue()*this.getDPI(a);if(d.match(/%$/))return this.numValue()*b.ViewPort.ComputeSize(a);var e=this.numValue();return c&&1>e?e*b.ViewPort.ComputeSize(a):e},b.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var a=this.value+"";return a.match(/s$/)?1e3*this.numValue():(a.match(/ms$/),this.numValue())},b.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var a=this.value+"";return a.match(/deg$/)?this.numValue()*(Math.PI/180):a.match(/grad$/)?this.numValue()*(Math.PI/200):a.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)};var c={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};return b.Property.prototype.toTextBaseline=function(){return this.hasValue()?c[this.value]:null},b.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(a,c,d,e,f,g){var h=null!=g?this.Parse(g):this.CreateFont("","","","","",b.ctx.font);return{fontFamily:f||h.fontFamily,fontSize:e||h.fontSize,fontStyle:a||h.fontStyle,fontWeight:d||h.fontWeight,fontVariant:c||h.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var a=this;this.Parse=function(c){for(var d={},e=b.trim(b.compressSpaces(c||"")).split(" "),f={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},g="",h=0;h<e.length;h++)f.fontStyle||-1==a.Styles.indexOf(e[h])?f.fontVariant||-1==a.Variants.indexOf(e[h])?f.fontWeight||-1==a.Weights.indexOf(e[h])?f.fontSize?"inherit"!=e[h]&&(g+=e[h]):("inherit"!=e[h]&&(d.fontSize=e[h].split("/")[0]),f.fontStyle=f.fontVariant=f.fontWeight=f.fontSize=!0):("inherit"!=e[h]&&(d.fontWeight=e[h]),f.fontStyle=f.fontVariant=f.fontWeight=!0):("inherit"!=e[h]&&(d.fontVariant=e[h]),f.fontStyle=f.fontVariant=!0):("inherit"!=e[h]&&(d.fontStyle=e[h]),f.fontStyle=!0);return""!=g&&(d.fontFamily=g),d}},b.ToNumberArray=function(a){for(var c=b.trim(b.compressSpaces((a||"").replace(/,/g," "))).split(" "),d=0;d<c.length;d++)c[d]=parseFloat(c[d]);return c},b.Point=function(a,b){this.x=a,this.y=b},b.Point.prototype.angleTo=function(a){return Math.atan2(a.y-this.y,a.x-this.x)},b.Point.prototype.applyTransform=function(a){var b=this.x*a[0]+this.y*a[2]+a[4],c=this.x*a[1]+this.y*a[3]+a[5];this.x=b,this.y=c},b.CreatePoint=function(a){var c=b.ToNumberArray(a);return new b.Point(c[0],c[1])},b.CreatePath=function(a){for(var c=b.ToNumberArray(a),d=[],e=0;e<c.length;e+=2)d.push(new b.Point(c[e],c[e+1]));return d},b.Transform=function(a){var c=this;this.Type={},this.Type.translate=function(a){this.p=b.CreatePoint(a),this.apply=function(a){a.transform=a.transform.translated(this.p.x||0,this.p.y||0)},this.unapply=function(a){a.transform=a.transform.translated(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(a){a.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(a){var c=b.ToNumberArray(a);this.angle=new b.Property("angle",c[0]),this.cx=c[1]||0,this.cy=c[2]||0,this.apply=function(a){a.transform=a.transform.translated(this.cx,this.cy),a.rotate(this.angle.toRadians()),a.transform=a.transform.translated(-this.cx,-this.cy)},this.unapply=function(a){a.transform=a.transform.translated(this.cx,this.cy),a.rotate(-1*this.angle.toRadians()),a.transform=a.transform.translated(-this.cx,-this.cy)},this.applyToPoint=function(a){var b=this.angle.toRadians();a.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),a.applyTransform([Math.cos(b),Math.sin(b),-Math.sin(b),Math.cos(b),0,0]),a.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(a){this.p=b.CreatePoint(a),this.apply=function(a){a.transform=a.transform.scaled(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(a){a.transform=a.transform.scaled(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(a){a.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(a){this.m=b.ToNumberArray(a),this.apply=function(a){a.transform=a.transform.multiplied(new GTransform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5]))},this.unapply=function(a){var b=this.m[0],c=this.m[2],d=this.m[4],e=this.m[1],f=this.m[3],g=this.m[5],h=0,i=0,j=1,k=1/(b*(f*j-g*i)-c*(e*j-g*h)+d*(e*i-f*h));a.transform=a.transform.multiplied(new GTransform(k*(f*j-g*i),k*(g*h-e*j),k*(d*i-c*j),k*(b*j-d*h),k*(c*g-d*f),k*(d*e-b*g)))},this.applyToPoint=function(a){a.applyTransform(this.m)}},this.Type.SkewBase=function(a){this.base=c.Type.matrix,this.base(a),this.angle=new b.Property("angle",a)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(a){this.base=c.Type.SkewBase,this.base(a),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(a){this.base=c.Type.SkewBase,this.base(a),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(a){for(var b=0;b<this.transforms.length;b++)this.transforms[b].apply(a)},this.unapply=function(a){for(var b=this.transforms.length-1;b>=0;b--)this.transforms[b].unapply(a)},this.applyToPoint=function(a){for(var b=0;b<this.transforms.length;b++)this.transforms[b].applyToPoint(a)};for(var d=b.trim(b.compressSpaces(a)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),e=0;e<d.length;e++){var f=b.trim(d[e].split("(")[0]),g=d[e].split("(")[1].replace(")",""),h=new this.Type[f](g);h.type=f,this.transforms.push(h)}},b.AspectRatio=function(a,c,d,e,f,g,h,i,j,k){c=b.compressSpaces(c),c=c.replace(/^defer\s/,"");var l=c.split(" ")[0]||"xMidYMid",m=c.split(" ")[1]||"meet",n=d/e,o=f/g,p=Math.min(n,o),q=Math.max(n,o);"meet"==m&&(e*=p,g*=p),"slice"==m&&(e*=q,g*=q),j=new b.Property("refX",j),k=new b.Property("refY",k),j.hasValue()&&k.hasValue()?a.transform=a.transform.translated(-p*j.toPixels("x"),-p*k.toPixels("y")):(l.match(/^xMid/)&&("meet"==m&&p==o||"slice"==m&&q==o)&&(a.transform=a.transform.translated(d/2-e/2,0)),l.match(/YMid$/)&&("meet"==m&&p==n||"slice"==m&&q==n)&&(a.transform=a.transform.translated(0,f/2-g/2)),l.match(/^xMax/)&&("meet"==m&&p==o||"slice"==m&&q==o)&&(a.transform=a.transform.translated(d-e,0)),l.match(/YMax$/)&&("meet"==m&&p==n||"slice"==m&&q==n)&&(a.transform=a.transform.translated(0,f-g))),"none"==l?a.transform=a.transform.scaled(n,o):"meet"==m?a.transform=a.transform.scaled(p,p):"slice"==m&&(a.transform=a.transform.scaled(q,q)),a.transform=a.transform.translated(null==h?0:-h,null==i?0:-i)},b.Element={},b.EmptyProperty=new b.Property("EMPTY",""),b.Element.ElementBase=function(a){if(this.attributes={},this.styles={},this.children=[],this.attribute=function(a,c){var d=this.attributes[a];return null!=d?d:(1==c&&(d=new b.Property(a,""),this.attributes[a]=d),d||b.EmptyProperty)},this.getHrefAttribute=function(){for(var a in this.attributes)if(a.match(/:href$/))return this.attributes[a];return b.EmptyProperty},this.style=function(a,c,d){var e=this.styles[a];if(null!=e)return e;var f=this.attribute(a);if(null!=f&&f.hasValue())return this.styles[a]=f,f;if(1!=d){var g=this.parent;if(null!=g){var h=g.style(a);if(null!=h&&h.hasValue())return h}}return 1==c&&(e=new b.Property(a,""),this.styles[a]=e),e||b.EmptyProperty},this.createSceneNode=function(){return null},this.toScene=function(a){var b=this.createSceneNode();if(b){b instanceof GBlock&&("none"==this.style("display").value||"hidden"==this.style("visibility").value)&&element.setProperty("visible",!1);var c={transform:a.length?a[a.length-1].transform:new GTransform};a.push(c),this.setSceneContext(c,b);for(var d=0;d<this.children.length;d++){var e=this.children[d].toScene(a);e&&b.appendChild(e)}this.clearSceneContext(c,b),a.pop({})}return b},this.setSceneContext=function(){},this.clearSceneContext=function(){},this.setContext=function(){},this.clearContext=function(){},this.addChild=function(a,c){var d=a;c&&(d=b.CreateElement(a)),d.parent=this,"title"!=d.type&&this.children.push(d)},null!=a&&1==a.nodeType){for(var c=0;c<a.attributes.length;c++){var d=a.attributes[c];this.attributes[d.nodeName]=new b.Property(d.nodeName,d.value)}var e=b.Styles[a.nodeName];if(null!=e)for(var f in e)this.styles[f]=e[f];if(this.attribute("class").hasValue())for(var g=b.compressSpaces(this.attribute("class").value).split(" "),h=0;h<g.length;h++){if(e=b.Styles["."+g[h]],null!=e)for(var f in e)this.styles[f]=e[f];if(e=b.Styles[a.nodeName+"."+g[h]],null!=e)for(var f in e)this.styles[f]=e[f]}if(this.attribute("id").hasValue()){var e=b.Styles["#"+this.attribute("id").value];if(null!=e)for(var f in e)this.styles[f]=e[f]}if(this.attribute("style").hasValue())for(var e=this.attribute("style").value.split(";"),c=0;c<e.length;c++)if(""!=b.trim(e[c])){var i=e[c].split(":"),f=b.trim(i[0]),j=b.trim(i[1]);this.styles[f]=new b.Property(f,j)}this.attribute("id").hasValue()&&null==b.Definitions[this.attribute("id").value]&&(b.Definitions[this.attribute("id").value]=this);for(var c=0;c<a.childNodes.length;c++){var k=a.childNodes[c];if(1==k.nodeType&&this.addChild(k,!0),this.captureTextNodes&&(3==k.nodeType||4==k.nodeType)){var l=k.nodeValue||k.text||"";""!=b.trim(b.compressSpaces(l))&&this.addChild(new b.Element.tspan(k),!1)}}}},b.Element.RenderedElementBase=function(a){this.base=b.Element.ElementBase,this.base(a),this.setSceneContext=function(a,c){if(this.attribute("transform").hasValue()){var d=new b.Transform(this.attribute("transform").value);d.apply(a)}if(c instanceof GBlock&&this.attribute("id").hasValue()&&c.setProperty("name",this.attribute("id").value),c&&c.hasMixin(GElement.Transform)&&(a.transform.isIdentity()||c.transform(a.transform)),c&&c.hasMixin(GStylable)){var e=c.getStylePropertySets(),f={};if(e.indexOf(GStylable.PropertySet.Style)>=0&&this.style("opacity").hasValue()&&(f._stop=this.style("opacity").numValue()),e.indexOf(GStylable.PropertySet.Fill)>=0){if(this.style("fill").isUrlDefinition());else if(this.style("fill").hasValue()){var g=this.style("fill");if("none"==g.value)f._fpt=null;else{"currentColor"==g.value&&(g.value=this.style("color").value);var h=GRGBColor.parseCSSColor(g.value);h&&(f._fpt=new GRGBColor(h.slice(0,3)),f._fop=h[3])}}else f._fpt=GRGBColor.BLACK,f._fop=1;if(this.style("fill-opacity").hasValue()){var i=f.hasOwnProperty("_fop")?f._fop:1;f._fop=this.style("fill-opacity").numValue()*i}}if(e.indexOf(GStylable.PropertySet.Border)>=0){if(this.style("stroke").isUrlDefinition());else if(this.style("stroke").hasValue()){var j=this.style("stroke");if("none"==j.value)f._bpt=null;else{"currentColor"==j.value&&(j.value=this.style("color").value);var h=GRGBColor.parseCSSColor(j.value);h&&(f._bpt=new GRGBColor(h.slice(0,3)),f._bop=h[3])}}else f._bpt=null;if(this.style("stroke-opacity").hasValue()){var i=f.hasOwnProperty("_bop")?f._bop:1;f._bop=this.style("stroke-opacity").numValue()*i}f._bw=this.style("stroke-width").hasValue()?this.style("stroke-width").toPixels():1;var k=a.transform.getScaleFactor();if(k>0&&1!==k&&(f._bw*=k),this.style("stroke-linecap").hasValue())switch(this.style("stroke-linecap").value){case"round":f._blc=GPaintCanvas.LineCap.Round;break;case"square":f._blc=GPaintCanvas.LineCap.Square;break;case"butt":default:f._blc=GPaintCanvas.LineCap.Butt}else f._blc=GPaintCanvas.LineCap.Butt;if(this.style("stroke-linejoin").hasValue())switch(this.style("stroke-linejoin").value){case"round":f._blj=GPaintCanvas.LineJoin.Round;break;case"bevel":f._blj=GPaintCanvas.LineJoin.Bevel;break;case"miter":default:f._blj=GPaintCanvas.LineJoin.Miter}else f._blj=GPaintCanvas.LineJoin.Miter;f._bml=this.style("stroke-miterlimit").hasValue()?this.style("stroke-miterlimit").numValue():4,this.style("stroke-dasharray").hasValue()&&"none"!=this.style("stroke-dasharray").value}e.indexOf(GStylable.PropertySet.Text)>=0;var l=[],m=[];for(var n in f)l.push(n),m.push(f[n]);l.length&&c.setProperties(l,m)}}},b.Element.RenderedElementBase.prototype=new b.Element.ElementBase,b.Element.PathElementBase=function(a){this.base=b.Element.RenderedElementBase,this.base(a),this.baseSetSceneContext=this.setSceneContext,this.setSceneContext=function(a,b){if(this.baseSetSceneContext(a,b),b instanceof GCompoundPath)for(var c=b.getAnchorPaths().getFirstChild();null!==c;c=c.getNext())this._setPathSceneContext(a,c);else this._setPathSceneContext(a,b)},this._setPathSceneContext=function(a,b){b instanceof GPathBase&&("inherit"!=this.style("fill-rule").valueOrDefault("inherit")?b.setProperty("evenodd","evenodd"===this.style("fill-rule").value):b.setProperty("evenodd",!1))},this.renderChildren=function(a){this.path(a),b.Mouse.checkPath(this,a),""!=a.fillStyle&&("inherit"!=this.style("fill-rule").valueOrDefault("inherit")?a.fill(this.style("fill-rule").value):a.fill()),""!=a.strokeStyle&&a.stroke();var c=this.getMarkers();if(null!=c){if(this.style("marker-start").isUrlDefinition()){var d=this.style("marker-start").getDefinition();d.render(a,c[0][0],c[0][1])}if(this.style("marker-mid").isUrlDefinition())for(var d=this.style("marker-mid").getDefinition(),e=1;e<c.length-1;e++)d.render(a,c[e][0],c[e][1]);if(this.style("marker-end").isUrlDefinition()){var d=this.style("marker-end").getDefinition();d.render(a,c[c.length-1][0],c[c.length-1][1])}}},this.getMarkers=function(){return null}},b.Element.PathElementBase.prototype=new b.Element.RenderedElementBase,b.Element.svg=function(a){this.base=b.Element.RenderedElementBase,this.base(a),this.createSceneNode=function(){return new GGroup},this.baseClearSceneContext=this.clearSceneContext,this.clearSceneContext=function(a){this.baseClearSceneContext(a)},this.baseSetSceneContext=this.setSceneContext,this.setSceneContext=function(a){this.baseSetSceneContext(a),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),a.transform=a.transform.translated(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var c=b.ViewPort.width(),d=b.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),"undefined"==typeof this.root){c=this.attribute("width").toPixels("x"),d=this.attribute("height").toPixels("y");var e=0,f=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(e=-this.attribute("refX").toPixels("x"),f=-this.attribute("refY").toPixels("y")),"visible"!=this.attribute("overflow").valueOrDefault("hidden")}if(b.ViewPort.SetCurrent(c,d),this.attribute("viewBox").hasValue()){var g=b.ToNumberArray(this.attribute("viewBox").value),h=g[0],i=g[1];c=g[2],d=g[3],b.AspectRatio(a,this.attribute("preserveAspectRatio").value,b.ViewPort.width(),c,b.ViewPort.height(),d,h,i,this.attribute("refX").value,this.attribute("refY").value),b.ViewPort.RemoveCurrent(),b.ViewPort.SetCurrent(g[2],g[3])}},this.baseClearContext=this.clearContext,this.clearContext=function(a){this.baseClearContext(a),b.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(a){a.strokeStyle="rgba(0,0,0,0)",a.lineCap="butt",a.lineJoin="miter",a.miterLimit=4,"undefined"!=typeof a.font&&"undefined"!=typeof window.getComputedStyle&&(a.font=window.getComputedStyle(a.canvas).getPropertyValue("font")),this.baseSetContext(a),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),a.transform=a.transform.translated(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var c=b.ViewPort.width(),d=b.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),"undefined"==typeof this.root){c=this.attribute("width").toPixels("x"),d=this.attribute("height").toPixels("y");var e=0,f=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(e=-this.attribute("refX").toPixels("x"),f=-this.attribute("refY").toPixels("y")),"visible"!=this.attribute("overflow").valueOrDefault("hidden")&&(a.beginPath(),a.moveTo(e,f),a.lineTo(c,f),a.lineTo(c,d),a.lineTo(e,d),a.closePath(),a.clip())}if(b.ViewPort.SetCurrent(c,d),this.attribute("viewBox").hasValue()){var g=b.ToNumberArray(this.attribute("viewBox").value),h=g[0],i=g[1];c=g[2],d=g[3],b.AspectRatio(a,this.attribute("preserveAspectRatio").value,b.ViewPort.width(),c,b.ViewPort.height(),d,h,i,this.attribute("refX").value,this.attribute("refY").value),b.ViewPort.RemoveCurrent(),b.ViewPort.SetCurrent(g[2],g[3])}}},b.Element.svg.prototype=new b.Element.RenderedElementBase,b.Element.rect=function(a){this.base=b.Element.RenderedElementBase,this.base(a),this.createSceneNode=function(){var a=new GRectangle,b=this.attribute("x").toPixels("x"),c=this.attribute("y").toPixels("y"),d=this.attribute("width").toPixels("x"),e=this.attribute("height").toPixels("y"),f=this.attribute("rx").toPixels("x"),g=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(g=f),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(f=g),f=Math.min(f,d/2),g=Math.min(g,e/2),a.setProperties(["trf","tl_sx","tl_sy"],[new GTransform(d/2,0,0,e/2,b+d/2,c+e/2),f,g]),a}},b.Element.rect.prototype=new b.Element.RenderedElementBase,b.Element.circle=function(a){this.base=b.Element.RenderedElementBase,this.base(a),this.createSceneNode=function(){var a=new GEllipse,b=this.attribute("cx").toPixels("x"),c=this.attribute("cy").toPixels("y"),d=this.attribute("r").toPixels(),e=b-d,f=c-d,g=2*d,h=2*d;return a.setProperty("trf",new GTransform(g/2,0,0,h/2,e+g/2,f+h/2)),a}},b.Element.circle.prototype=new b.Element.RenderedElementBase,b.Element.ellipse=function(a){this.base=b.Element.RenderedElementBase,this.base(a),this.createSceneNode=function(){var a=new GEllipse,b=this.attribute("rx").toPixels("x"),c=this.attribute("ry").toPixels("y"),d=this.attribute("cx").toPixels("x"),e=this.attribute("cy").toPixels("y"),f=d-b,g=e-c,h=2*b,i=2*c;return a.setProperty("trf",new GTransform(h/2,0,0,i/2,f+h/2,g+i/2)),a}},b.Element.ellipse.prototype=new b.Element.RenderedElementBase,b.Element.line=function(a){this.base=b.Element.PathElementBase,this.base(a),this.getPoints=function(){return[new b.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new b.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.createSceneNode=function(){for(var a=new GPath,b=a.getAnchorPoints(),c=this.getPoints(),d=0;d<c.length;++d){var e=c[d],f=new GPathBase.AnchorPoint;b.appendChild(f),f.setProperties(["x","y"],[e.x,e.y])}return a},this.getMarkers=function(){var a=this.getPoints(),b=a[0].angleTo(a[1]);return[[a[0],b],[a[1],b]]}},b.Element.line.prototype=new b.Element.PathElementBase,b.Element.polyline=function(a){this.base=b.Element.PathElementBase,this.base(a),this.points=b.CreatePath(this.attribute("points").value),this.createSceneNode=function(){for(var a=new GPath,b=a.getAnchorPoints(),c=0;c<this.points.length;++c){var d=this.points[c],e=new GPathBase.AnchorPoint;b.appendChild(e),e.setProperties(["x","y"],[d.x,d.y])}return a},this.getMarkers=function(){for(var a=[],b=0;b<this.points.length-1;b++)a.push([this.points[b],this.points[b].angleTo(this.points[b+1])]);return a.push([this.points[this.points.length-1],a[a.length-1][1]]),a}},b.Element.polyline.prototype=new b.Element.PathElementBase,b.Element.polygon=function(a){this.base=b.Element.polyline,this.base(a),this.baseCreateSceneNode=this.createSceneNode,this.createSceneNode=function(){var a=this.baseCreateSceneNode();return a.setProperty("closed",!0),a}},b.Element.polygon.prototype=new b.Element.polyline,b.Element.path=function(a){this.base=b.Element.PathElementBase,this.base(a);var c=this.attribute("d").value;c=c.replace(/,/gm," "),c=c.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),c=c.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),c=c.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2"),c=c.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),c=c.replace(/([0-9])([+\-])/gm,"$1 $2"),c=c.replace(/(\.[0-9]*)(\.)/gm,"$1 $2"),c=c.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),c=b.compressSpaces(c),c=b.trim(c),this.PathParser=new function(a){this.tokens=a.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new b.Point(0,0),this.control=new b.Point(0,0),this.current=new b.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return this.isEnd()?!0:null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var a=new b.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(a)},this.getAsControlPoint=function(){var a=this.getPoint();return this.control=a,a},this.getAsCurrentPoint=function(){var a=this.getPoint();return this.current=a,a},this.getReflectedControlPoint=function(){if("c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase())return this.current;var a=new b.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y);return a},this.makeAbsolute=function(a){return this.isRelativeCommand()&&(a.x+=this.current.x,a.y+=this.current.y),a},this.addMarker=function(a,b,c){null!=c&&this.angles.length>0&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(c)),this.addMarkerAngle(a,null==b?null:b.angleTo(a))},this.addMarkerAngle=function(a,b){this.points.push(a),this.angles.push(b)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var a=0;a<this.angles.length;a++)if(null==this.angles[a])for(var b=a+1;b<this.angles.length;b++)if(null!=this.angles[b]){this.angles[a]=this.angles[b];break}return this.angles}}(c),this.createSceneNode=function(){for(var a=new GPath,b=a.getAnchorPoints(),c=0;c<this.points.length;++c){var d=this.points[c],e=new GPathBase.AnchorPoint;b.appendChild(e),e.setProperties(["x","y"],[d.x,d.y])}return a},this.createSceneNode=function(){var a=this.PathParser;a.reset();for(var c=new GVertexContainer;!a.isEnd();)switch(a.nextCommand(),a.command){case"M":case"m":var d=a.getAsCurrentPoint();for(a.addMarker(d),c.addVertex(GVertex.Command.Move,d.x,d.y),a.start=a.current;!a.isCommandOrEnd();){var d=a.getAsCurrentPoint();a.addMarker(d,a.start),c.addVertex(GVertex.Command.Move,d.x,d.y)}break;case"L":case"l":for(;!a.isCommandOrEnd();){var e=a.current,d=a.getAsCurrentPoint();a.addMarker(d,e),c.addVertex(GVertex.Command.Line,d.x,d.y)}break;case"H":case"h":for(;!a.isCommandOrEnd();){var f=new b.Point((a.isRelativeCommand()?a.current.x:0)+a.getScalar(),a.current.y);a.addMarker(f,a.current),a.current=f,c.addVertex(GVertex.Command.Line,a.current.x,a.current.y)}break;case"V":case"v":for(;!a.isCommandOrEnd();){var f=new b.Point(a.current.x,(a.isRelativeCommand()?a.current.y:0)+a.getScalar());a.addMarker(f,a.current),a.current=f,c.addVertex(GVertex.Command.Line,a.current.x,a.current.y)}break;case"C":case"c":for(;!a.isCommandOrEnd();){var g=a.getPoint(),h=a.getAsControlPoint(),i=a.getAsCurrentPoint();a.addMarker(i,h,g),c.addVertex(GVertex.Command.Curve2,i.x,i.y),c.addVertex(GVertex.Command.Curve2,g.x,g.y),c.addVertex(GVertex.Command.Curve2,h.x,h.y)}break;case"S":case"s":for(;!a.isCommandOrEnd();){var g=a.getReflectedControlPoint(),h=a.getAsControlPoint(),i=a.getAsCurrentPoint();a.addMarker(i,h,g),c.addVertex(GVertex.Command.Curve2,i.x,i.y),c.addVertex(GVertex.Command.Curve2,g.x,g.y),c.addVertex(GVertex.Command.Curve2,h.x,h.y)}break;case"Q":case"q":for(;!a.isCommandOrEnd();){var h=a.getAsControlPoint(),i=a.getAsCurrentPoint();a.addMarker(i,h,h),c.addVertex(GVertex.Command.Curve,i.x,i.y),c.addVertex(GVertex.Command.Curve,h.x,h.y)}break;case"T":case"t":for(;!a.isCommandOrEnd();){var h=a.getReflectedControlPoint();a.control=h;var i=a.getAsCurrentPoint();a.addMarker(i,h,h),c.addVertex(GVertex.Command.Curve,i.x,i.y),c.addVertex(GVertex.Command.Curve,h.x,h.y)}break;case"A":case"a":for(;!a.isCommandOrEnd();){var j=a.current,k=a.getScalar(),l=a.getScalar(),m=a.getScalar()*(Math.PI/180),n=a.getScalar(),o=a.getScalar(),i=a.getAsCurrentPoint(),p=new b.Point(Math.cos(m)*(j.x-i.x)/2+Math.sin(m)*(j.y-i.y)/2,-Math.sin(m)*(j.x-i.x)/2+Math.cos(m)*(j.y-i.y)/2),q=Math.pow(p.x,2)/Math.pow(k,2)+Math.pow(p.y,2)/Math.pow(l,2);q>1&&(k*=Math.sqrt(q),l*=Math.sqrt(q));var r=(n==o?-1:1)*Math.sqrt((Math.pow(k,2)*Math.pow(l,2)-Math.pow(k,2)*Math.pow(p.y,2)-Math.pow(l,2)*Math.pow(p.x,2))/(Math.pow(k,2)*Math.pow(p.y,2)+Math.pow(l,2)*Math.pow(p.x,2)));isNaN(r)&&(r=0);var s=new b.Point(r*k*p.y/l,r*-l*p.x/k),t=new b.Point((j.x+i.x)/2+Math.cos(m)*s.x-Math.sin(m)*s.y,(j.y+i.y)/2+Math.sin(m)*s.x+Math.cos(m)*s.y),u=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2))},v=function(a,b){return(a[0]*b[0]+a[1]*b[1])/(u(a)*u(b))},w=function(a,b){return(a[0]*b[1]<a[1]*b[0]?-1:1)*Math.acos(v(a,b))},x=w([1,0],[(p.x-s.x)/k,(p.y-s.y)/l]),y=[(p.x-s.x)/k,(p.y-s.y)/l],z=[(-p.x-s.x)/k,(-p.y-s.y)/l],A=w(y,z);v(y,z)<=-1&&(A=Math.PI),v(y,z)>=1&&(A=0);
var B=1-o?1:-1,C=x+B*(A/2),D=new b.Point(t.x+k*Math.cos(C),t.y+l*Math.sin(C));a.addMarkerAngle(D,C-B*Math.PI/2),a.addMarkerAngle(i,C-B*Math.PI);var E=(new GTransform).scaled(k,l).rotated(m).translated(t.x,t.y),F=new GEllipse,G=x,H=1-o?x+A-2*Math.PI:x+A;F.setProperties(["sa","ea","etp","trf"],[G,H,GEllipse.Type.Arc,E]);var I=new GVertex;if(F.rewindVertices(0),F.readVertex(I))for(;F.readVertex(I);)c.addVertex(I.command,I.x,I.y)}break;case"Z":case"z":c.addVertex(GVertex.Command.Close),a.current=a.start}return GPathBase.createPathFromVertexSource(c)},this.getMarkers=function(){for(var a=this.PathParser.getMarkerPoints(),b=this.PathParser.getMarkerAngles(),c=[],d=0;d<a.length;d++)c.push([a[d],b[d]]);return c}},b.Element.path.prototype=new b.Element.PathElementBase,b.Element.pattern=function(a){this.base=b.Element.ElementBase,this.base(a),this.createPattern=function(a){var c=this.attribute("width").toPixels("x",!0),d=this.attribute("height").toPixels("y",!0),e=new b.Element.svg;e.attributes.viewBox=new b.Property("viewBox",this.attribute("viewBox").value),e.attributes.width=new b.Property("width",c+"px"),e.attributes.height=new b.Property("height",d+"px"),e.attributes.transform=new b.Property("transform",this.attribute("patternTransform").value),e.children=this.children;var f=document.createElement("canvas");f.width=c,f.height=d;var g=f.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&(g.transform=a.transform.translated(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0)));for(var h=-1;1>=h;h++)for(var i=-1;1>=i;i++)g.save(),g.transform=a.transform.translated(h*f.width,i*f.height),e.render(g),g.restore();var j=a.createPattern(f,"repeat");return j}},b.Element.pattern.prototype=new b.Element.ElementBase,b.Element.marker=function(a){this.base=b.Element.ElementBase,this.base(a),this.baseRender=this.render,this.render=function(a,c,d){a.transform=a.transform.translated(c.x,c.y),"auto"==this.attribute("orient").valueOrDefault("auto")&&a.rotate(d),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&(a.transform=a.transform.scaled(a.lineWidth,a.lineWidth)),a.save();var e=new b.Element.svg;e.attributes.viewBox=new b.Property("viewBox",this.attribute("viewBox").value),e.attributes.refX=new b.Property("refX",this.attribute("refX").value),e.attributes.refY=new b.Property("refY",this.attribute("refY").value),e.attributes.width=new b.Property("width",this.attribute("markerWidth").value),e.attributes.height=new b.Property("height",this.attribute("markerHeight").value),e.attributes.fill=new b.Property("fill",this.attribute("fill").valueOrDefault("black")),e.attributes.stroke=new b.Property("stroke",this.attribute("stroke").valueOrDefault("none")),e.children=this.children,e.render(a),a.restore(),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&(a.transform=a.transform.scaled(1/a.lineWidth,1/a.lineWidth)),"auto"==this.attribute("orient").valueOrDefault("auto")&&a.rotate(-d),a.transform=a.transform.translated(-c.x,-c.y)}},b.Element.marker.prototype=new b.Element.ElementBase,b.Element.defs=function(a){this.base=b.Element.ElementBase,this.base(a)},b.Element.defs.prototype=new b.Element.ElementBase,b.Element.GradientBase=function(a){this.base=b.Element.ElementBase,this.base(a),this.gradientUnits=this.attribute("gradientUnits").valueOrDefault("objectBoundingBox"),this.stops=[];for(var c=0;c<this.children.length;c++){var d=this.children[c];"stop"==d.type&&this.stops.push(d)}this.getGradient=function(){},this.createGradient=function(a,c,d){var e=this;this.getHrefAttribute().hasValue()&&(e=this.getHrefAttribute().getDefinition());var f=function(a){if(d.hasValue()){var c=new b.Property("color",a);return c.addOpacity(d).value}return a},g=this.getGradient(a,c);if(null==g)return f(e.stops[e.stops.length-1].color);for(var h=0;h<e.stops.length;h++)g.addColorStop(e.stops[h].offset,f(e.stops[h].color));if(this.attribute("gradientTransform").hasValue()){var i=b.ViewPort.viewPorts[0],j=new b.Element.rect;j.attributes.x=new b.Property("x",-b.MAX_VIRTUAL_PIXELS/3),j.attributes.y=new b.Property("y",-b.MAX_VIRTUAL_PIXELS/3),j.attributes.width=new b.Property("width",b.MAX_VIRTUAL_PIXELS),j.attributes.height=new b.Property("height",b.MAX_VIRTUAL_PIXELS);var k=new b.Element.g;k.attributes.transform=new b.Property("transform",this.attribute("gradientTransform").value),k.children=[j];var l=new b.Element.svg;l.attributes.x=new b.Property("x",0),l.attributes.y=new b.Property("y",0),l.attributes.width=new b.Property("width",i.width),l.attributes.height=new b.Property("height",i.height),l.children=[k];var m=document.createElement("canvas");m.width=i.width,m.height=i.height;var n=m.getContext("2d");return n.fillStyle=g,l.render(n),n.createPattern(m,"no-repeat")}return g}},b.Element.GradientBase.prototype=new b.Element.ElementBase,b.Element.linearGradient=function(a){this.base=b.Element.GradientBase,this.base(a),this.getGradient=function(a,b){var c="objectBoundingBox"==this.gradientUnits?b.getBoundingBox():null;this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var d="objectBoundingBox"==this.gradientUnits?c.x()+c.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),e="objectBoundingBox"==this.gradientUnits?c.y()+c.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),f="objectBoundingBox"==this.gradientUnits?c.x()+c.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),g="objectBoundingBox"==this.gradientUnits?c.y()+c.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return d==f&&e==g?null:a.createLinearGradient(d,e,f,g)}},b.Element.linearGradient.prototype=new b.Element.GradientBase,b.Element.radialGradient=function(a){this.base=b.Element.GradientBase,this.base(a),this.getGradient=function(a,b){var c=b.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var d="objectBoundingBox"==this.gradientUnits?c.x()+c.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),e="objectBoundingBox"==this.gradientUnits?c.y()+c.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),f=d,g=e;this.attribute("fx").hasValue()&&(f="objectBoundingBox"==this.gradientUnits?c.x()+c.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(g="objectBoundingBox"==this.gradientUnits?c.y()+c.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var h="objectBoundingBox"==this.gradientUnits?(c.width()+c.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return a.createRadialGradient(f,g,0,d,e,h)}},b.Element.radialGradient.prototype=new b.Element.GradientBase,b.Element.stop=function(a){this.base=b.Element.ElementBase,this.base(a),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),this.offset>1&&(this.offset=1);var c=this.style("stop-color");this.style("stop-opacity").hasValue()&&(c=c.addOpacity(this.style("stop-opacity"))),this.color=c.value},b.Element.stop.prototype=new b.Element.ElementBase,b.Element.font=function(a){this.base=b.Element.ElementBase,this.base(a),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var c=0;c<this.children.length;c++){var d=this.children[c];"font-face"==d.type?(this.fontFace=d,d.style("font-family").hasValue()&&(b.Definitions[d.style("font-family").value]=this)):"missing-glyph"==d.type?this.missingGlyph=d:"glyph"==d.type&&(""!=d.arabicForm?(this.isRTL=!0,this.isArabic=!0,"undefined"==typeof this.glyphs[d.unicode]&&(this.glyphs[d.unicode]=[]),this.glyphs[d.unicode][d.arabicForm]=d):this.glyphs[d.unicode]=d)}},b.Element.font.prototype=new b.Element.ElementBase,b.Element.fontface=function(a){this.base=b.Element.ElementBase,this.base(a),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},b.Element.fontface.prototype=new b.Element.ElementBase,b.Element.missingglyph=function(a){this.base=b.Element.path,this.base(a),this.horizAdvX=0},b.Element.missingglyph.prototype=new b.Element.path,b.Element.glyph=function(a){this.base=b.Element.path,this.base(a),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},b.Element.glyph.prototype=new b.Element.path,b.Element.text=function(a){this.captureTextNodes=!0,this.base=b.Element.RenderedElementBase,this.base(a),this.baseSetContext=this.setContext,this.setContext=function(a){this.baseSetContext(a);var b=this.style("dominant-baseline").toTextBaseline();null==b&&(b=this.style("alignment-baseline").toTextBaseline()),null!=b&&(a.textBaseline=b)},this.renderChildren=function(a){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.x+=this.getAnchorDelta(a,this,0);for(var b=0;b<this.children.length;b++)this.renderChild(a,this,b)},this.getAnchorDelta=function(a,b,c){var d=this.style("text-anchor").valueOrDefault("start");if("start"!=d){for(var e=0,f=c;f<b.children.length;f++){var g=b.children[f];if(f>c&&g.attribute("x").hasValue())break;e+=g.measureTextRecursive(a)}return-1*("end"==d?e:e/2)}return 0},this.renderChild=function(a,b,c){var d=b.children[c];d.attribute("x").hasValue()?(d.x=d.attribute("x").toPixels("x")+this.getAnchorDelta(a,b,c),d.attribute("dx").hasValue()&&(d.x+=d.attribute("dx").toPixels("x"))):(this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),d.attribute("dx").hasValue()&&(this.x+=d.attribute("dx").toPixels("x")),d.x=this.x),this.x=d.x+d.measureText(a),d.attribute("y").hasValue()?(d.y=d.attribute("y").toPixels("y"),d.attribute("dy").hasValue()&&(d.y+=d.attribute("dy").toPixels("y"))):(this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),d.attribute("dy").hasValue()&&(this.y+=d.attribute("dy").toPixels("y")),d.y=this.y),this.y=d.y,d.render(a);for(var c=0;c<d.children.length;c++)this.renderChild(a,d,c)}},b.Element.text.prototype=new b.Element.RenderedElementBase,b.Element.TextElementBase=function(a){this.base=b.Element.RenderedElementBase,this.base(a),this.getGlyph=function(a,b,c){var d=b[c],e=null;if(a.isArabic){var f="isolated";(0==c||" "==b[c-1])&&c<b.length-2&&" "!=b[c+1]&&(f="terminal"),c>0&&" "!=b[c-1]&&c<b.length-2&&" "!=b[c+1]&&(f="medial"),c>0&&" "!=b[c-1]&&(c==b.length-1||" "==b[c+1])&&(f="initial"),"undefined"!=typeof a.glyphs[d]&&(e=a.glyphs[d][f],null==e&&"glyph"==a.glyphs[d].type&&(e=a.glyphs[d]))}else e=a.glyphs[d];return null==e&&(e=a.missingGlyph),e},this.renderChildren=function(a){var c=this.parent.style("font-family").getDefinition();if(null==c)""!=a.fillStyle&&a.fillText(b.compressSpaces(this.getText()),this.x,this.y),""!=a.strokeStyle&&a.strokeText(b.compressSpaces(this.getText()),this.x,this.y);else{var d=this.parent.style("font-size").numValueOrDefault(b.Font.Parse(b.ctx.font).fontSize),e=this.parent.style("font-style").valueOrDefault(b.Font.Parse(b.ctx.font).fontStyle),f=this.getText();c.isRTL&&(f=f.split("").reverse().join(""));for(var g=b.ToNumberArray(this.parent.attribute("dx").value),h=0;h<f.length;h++){var i=this.getGlyph(c,f,h),j=d/c.fontFace.unitsPerEm;a.transform=a.transform.translated(this.x,this.y),a.transform=a.transform.scaled(j,-j);var k=a.lineWidth;a.lineWidth=a.lineWidth*c.fontFace.unitsPerEm/d,"italic"==e&&(a.transform=a.transform.multiplied(new GTransform(1,0,.4,1,0,0))),i.render(a),"italic"==e&&(a.transform=a.transform.multiplied(new GTransform(1,0,-.4,1,0,0))),a.lineWidth=k,a.transform=a.transform.scaled(1/j,-1/j),a.transform=a.transform.translated(-this.x,-this.y),this.x+=d*(i.horizAdvX||c.horizAdvX)/c.fontFace.unitsPerEm,"undefined"==typeof g[h]||isNaN(g[h])||(this.x+=g[h])}}},this.getText=function(){},this.measureTextRecursive=function(a){for(var b=this.measureText(a),c=0;c<this.children.length;c++)b+=this.children[c].measureTextRecursive(a);return b},this.measureText=function(a){var c=this.parent.style("font-family").getDefinition();if(null!=c){var d=this.parent.style("font-size").numValueOrDefault(b.Font.Parse(b.ctx.font).fontSize),e=0,f=this.getText();c.isRTL&&(f=f.split("").reverse().join(""));for(var g=b.ToNumberArray(this.parent.attribute("dx").value),h=0;h<f.length;h++){var i=this.getGlyph(c,f,h);e+=(i.horizAdvX||c.horizAdvX)*d/c.fontFace.unitsPerEm,"undefined"==typeof g[h]||isNaN(g[h])||(e+=g[h])}return e}var j=b.compressSpaces(this.getText());if(!a.measureText)return 10*j.length;a.save(),this.setContext(a);var k=a.measureText(j).width;return a.restore(),k}},b.Element.TextElementBase.prototype=new b.Element.RenderedElementBase,b.Element.tspan=function(a){this.captureTextNodes=!0,this.base=b.Element.TextElementBase,this.base(a),this.text=a.nodeValue||a.text||"",this.getText=function(){return this.text}},b.Element.tspan.prototype=new b.Element.TextElementBase,b.Element.tref=function(a){this.base=b.Element.TextElementBase,this.base(a),this.getText=function(){var a=this.getHrefAttribute().getDefinition();return null!=a?a.children[0].getText():void 0}},b.Element.tref.prototype=new b.Element.TextElementBase,b.Element.a=function(a){this.base=b.Element.TextElementBase,this.base(a),this.hasText=!0;for(var c=0;c<a.childNodes.length;c++)3!=a.childNodes[c].nodeType&&(this.hasText=!1);this.text=this.hasText?a.childNodes[0].nodeValue:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(a){if(this.hasText){this.baseRenderChildren(a);{new b.Property("fontSize",b.Font.Parse(b.ctx.font).fontSize)}}else{var c=new b.Element.g;c.children=this.children,c.parent=this,c.render(a)}}},b.Element.a.prototype=new b.Element.TextElementBase,b.Element.image=function(a){this.base=b.Element.RenderedElementBase,this.base(a);var c=this.getHrefAttribute().value;if(""!=c){var d=c.match(/\.svg$/);if(b.Images.push(this),this.loaded=!1,d)this.img=b.ajax(c),this.loaded=!0;else{this.img=document.createElement("img"),1==b.opts.useCORS&&(this.img.crossOrigin="Anonymous");var e=this;this.img.onload=function(){e.loaded=!0},this.img.onerror=function(){b.log('ERROR: image "'+c+'" not found'),e.loaded=!0},this.img.src=c}this.renderChildren=function(a){var c=this.attribute("x").toPixels("x"),d=this.attribute("y").toPixels("y"),e=this.attribute("width").toPixels("x"),f=this.attribute("height").toPixels("y");0!=e&&0!=f&&(a.save(),a.transform=a.transform.translated(c,d),b.AspectRatio(a,this.attribute("preserveAspectRatio").value,e,this.img.width,f,this.img.height,0,0),a.drawImage(this.img,0,0),a.restore())}}},b.Element.image.prototype=new b.Element.RenderedElementBase,b.Element.g=function(a){this.base=b.Element.RenderedElementBase,this.base(a),this.createSceneNode=function(){return new GGroup}},b.Element.g.prototype=new b.Element.RenderedElementBase,b.Element.symbol=function(a){this.base=b.Element.RenderedElementBase,this.base(a),this.render=function(){}},b.Element.symbol.prototype=new b.Element.RenderedElementBase,b.Element.style=function(a){this.base=b.Element.ElementBase,this.base(a);for(var c="",d=0;d<a.childNodes.length;d++)c+=a.childNodes[d].nodeValue;c=c.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,""),c=b.compressSpaces(c);for(var e=c.split("}"),d=0;d<e.length;d++)if(""!=b.trim(e[d]))for(var f=e[d].split("{"),g=f[0].split(","),h=f[1].split(";"),i=0;i<g.length;i++){var j=b.trim(g[i]);if(""!=j){for(var k={},l=0;l<h.length;l++){var m=h[l].indexOf(":"),n=h[l].substr(0,m),o=h[l].substr(m+1,h[l].length-m);null!=n&&null!=o&&(k[b.trim(n)]=new b.Property(b.trim(n),b.trim(o)))}if(b.Styles[j]=k,"@font-face"==j)for(var p=k["font-family"].value.replace(/"/g,""),q=k.src.value.split(","),r=0;r<q.length;r++)if(q[r].indexOf('format("svg")')>0)for(var s=q[r].indexOf("url"),t=q[r].indexOf(")",s),u=q[r].substr(s+5,t-s-6),v=b.parseXml(b.ajax(u)),w=v.getElementsByTagName("font"),x=0;x<w.length;x++){var y=b.CreateElement(w[x]);b.Definitions[p]=y}}}},b.Element.style.prototype=new b.Element.ElementBase,b.Element.use=function(a){this.base=b.Element.RenderedElementBase,this.base(a),this.baseSetContext=this.setContext,this.setContext=function(a){this.baseSetContext(a),this.attribute("x").hasValue()&&(a.transform=a.transform.translated(this.attribute("x").toPixels("x"),0)),this.attribute("y").hasValue()&&(a.transform=a.transform.translated(0,this.attribute("y").toPixels("y")))};var c=this.getHrefAttribute().getDefinition();this.createSceneNode=function(){return null!==c?c.createSceneNode():null},this.renderChildren=function(a){if(null!=c){var d=c;"symbol"==c.type&&(d=new b.Element.svg,d.type="svg",d.attributes.viewBox=new b.Property("viewBox",c.attribute("viewBox").value),d.attributes.preserveAspectRatio=new b.Property("preserveAspectRatio",c.attribute("preserveAspectRatio").value),d.attributes.overflow=new b.Property("overflow",c.attribute("overflow").value),d.children=c.children),"svg"==d.type&&(this.attribute("width").hasValue()&&(d.attributes.width=new b.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(d.attributes.height=new b.Property("height",this.attribute("height").value)));var e=d.parent;d.parent=null,d.render(a),d.parent=e}}},b.Element.use.prototype=new b.Element.RenderedElementBase,b.Element.mask=function(a){this.base=b.Element.ElementBase,this.base(a),this.apply=function(a,b){var c=this.attribute("x").toPixels("x"),d=this.attribute("y").toPixels("y"),e=this.attribute("width").toPixels("x"),f=this.attribute("height").toPixels("y"),g=b.attribute("mask").value;b.attribute("mask").value="";var h=document.createElement("canvas");h.width=c+e,h.height=d+f;var i=h.getContext("2d");this.renderChildren(i);var j=document.createElement("canvas");j.width=c+e,j.height=d+f;var k=j.getContext("2d");b.render(k),k.globalCompositeOperation="destination-in",k.fillStyle=i.createPattern(h,"no-repeat"),k.fillRect(0,0,c+e,d+f),a.fillStyle=k.createPattern(j,"no-repeat"),a.fillRect(0,0,c+e,d+f),b.attribute("mask").value=g},this.render=function(){}},b.Element.mask.prototype=new b.Element.ElementBase,b.Element.clipPath=function(a){this.base=b.Element.ElementBase,this.base(a),this.apply=function(a){var c=CanvasRenderingContext2D.prototype.beginPath;CanvasRenderingContext2D.prototype.beginPath=function(){};var d=CanvasRenderingContext2D.prototype.closePath;CanvasRenderingContext2D.prototype.closePath=function(){},c.call(a);for(var e=0;e<this.children.length;e++){var f=this.children[e];if("undefined"!=typeof f.path){var g=null;f.attribute("transform").hasValue()&&(g=new b.Transform(f.attribute("transform").value),g.apply(a)),f.path(a),CanvasRenderingContext2D.prototype.closePath=d,g&&g.unapply(a)}}d.call(a),a.clip(),CanvasRenderingContext2D.prototype.beginPath=c,CanvasRenderingContext2D.prototype.closePath=d},this.render=function(){}},b.Element.clipPath.prototype=new b.Element.ElementBase,b.Element.filter=function(a){this.base=b.Element.ElementBase,this.base(a),this.apply=function(){},this.render=function(){}},b.Element.filter.prototype=new b.Element.ElementBase,b.Element.feMorphology=function(a){this.base=b.Element.ElementBase,this.base(a),this.apply=function(){}},b.Element.feMorphology.prototype=new b.Element.ElementBase,b.Element.feComposite=function(a){this.base=b.Element.ElementBase,this.base(a),this.apply=function(){}},b.Element.feComposite.prototype=new b.Element.ElementBase,b.Element.feColorMatrix=function(a){function c(a,b,c,d,e,f){return a[c*d*4+4*b+f]}function d(a,b,c,d,e,f,g){a[c*d*4+4*b+f]=g}function e(a,b){var c=f[a];return c*(0>c?b-255:b)}this.base=b.Element.ElementBase,this.base(a);var f=b.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":var g=f[0];f=[.213+.787*g,.715-.715*g,.072-.072*g,0,0,.213-.213*g,.715+.285*g,.072-.072*g,0,0,.213-.213*g,.715-.715*g,.072+.928*g,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var h=f[0]*Math.PI/180,i=function(a,b,c){return a+Math.cos(h)*b+Math.sin(h)*c};f=[i(.213,.787,-.213),i(.715,-.715,-.715),i(.072,-.072,.928),0,0,i(.213,-.213,.143),i(.715,.285,.14),i(.072,-.072,-.283),0,0,i(.213,-.213,-.787),i(.715,-.715,.715),i(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}this.apply=function(a,b,f,g,h){for(var i=a.getImageData(0,0,g,h),f=0;h>f;f++)for(var b=0;g>b;b++){var j=c(i.data,b,f,g,h,0),k=c(i.data,b,f,g,h,1),l=c(i.data,b,f,g,h,2),m=c(i.data,b,f,g,h,3);d(i.data,b,f,g,h,0,e(0,j)+e(1,k)+e(2,l)+e(3,m)+e(4,1)),d(i.data,b,f,g,h,1,e(5,j)+e(6,k)+e(7,l)+e(8,m)+e(9,1)),d(i.data,b,f,g,h,2,e(10,j)+e(11,k)+e(12,l)+e(13,m)+e(14,1)),d(i.data,b,f,g,h,3,e(15,j)+e(16,k)+e(17,l)+e(18,m)+e(19,1))}a.clearRect(0,0,g,h),a.putImageData(i,0,0)}},b.Element.feColorMatrix.prototype=new b.Element.ElementBase,b.Element.feGaussianBlur=function(a){this.base=b.Element.ElementBase,this.base(a),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(a,c,d,e,f){return"undefined"==typeof stackBlurCanvasRGBA?void b.log("ERROR: StackBlur.js must be included for blur to work"):(a.canvas.id=b.UniqueId(),a.canvas.style.display="none",document.body.appendChild(a.canvas),stackBlurCanvasRGBA(a.canvas.id,c,d,e,f,this.blurRadius),void document.body.removeChild(a.canvas))}},b.Element.feGaussianBlur.prototype=new b.Element.ElementBase,b.Element.title=function(){},b.Element.title.prototype=new b.Element.ElementBase,b.Element.desc=function(){},b.Element.desc.prototype=new b.Element.ElementBase,b.Element.MISSING=function(a){b.log("ERROR: Element '"+a.nodeName+"' not yet implemented.")},b.Element.MISSING.prototype=new b.Element.ElementBase,b.CreateElement=function(a){var c=a.nodeName.replace(/^[^:]+:/,"");c=c.replace(/\-/g,"");var d=null;return d="undefined"!=typeof b.Element[c]?new b.Element[c](a):new b.Element.MISSING(a),d.type=a.nodeName,d},b}GObject.inherit(a,GReader),a.prototype.getInputType=function(){return GReader.InputType.ArrayBuffer},a.prototype.getMimeType=function(){return"image/svg+xml"},a.prototype.getFileExtensions=function(){return["svg","svgz"]},a.prototype.readInput=function(a,b,c){var d=new Uint8Array(a);if(31===d[0]&&139===d[1]&&8===d[2]){var e=pako.ungzip(d,{to:"string"});this._read(e,b,c)}else{var f=new FileReader;f.onload=function(a){this._read(a.target.result,b,c)}.bind(this),f.readAsText(new Blob([a]))}},a.prototype._read=function(a,c,d){var e=null;if("undefined"!=typeof Windows&&"undefined"!=typeof Windows.Data&&"undefined"!=typeof Windows.Data.Xml){var e=new Windows.Data.Xml.Dom.XmlDocument,d=new Windows.Data.Xml.Dom.XmlLoadSettings;d.prohibitDtd=!1,e.loadXml(g,d)}else if(window.DOMParser){var f=new DOMParser;e=f.parseFromString(a,"text/xml")}else{var g=a.replace(/<!DOCTYPE svg[^>]*>/,"");e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(g)}if(!e||"svg"!==e.documentElement.nodeName)throw new Error("Invalid svg doc");d=$.extend({baseWidth:400,baseHeight:400},d);var h=b({}),i=h.CreateElement(e.documentElement);if(i.root=!0,h.ViewPort.Clear(),h.ViewPort.SetCurrent(d.baseWidth,d.baseHeight),i.style("width").hasValue()&&i.style("height").hasValue()){var j=i.style("width").toPixels("x"),k=i.style("height").toPixels("y");h.ViewPort.Clear(),h.ViewPort.SetCurrent(j,k)}var l=i.toScene([]);c(l?l:null)},GIO.registerReader(new a)}(this);