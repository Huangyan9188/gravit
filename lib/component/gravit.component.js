!function(a){var b={init:function(c){return c=a.extend({selector:null},c),this.each(function(){var d=this;a(this).data("gautoedit",{options:c,input:null}).on("dblclick",function(){b.open.call(d)})})},open:function(){var c=this,d=a(this),e=d.data("gautoedit");e.input&&b.close.call(this);var f=d.find(e.options.selector);if(0===f.length){if(e.options.selector)return;f=d}var g=f.offset();e.value=f.text(),e.input=a("<input>").css({position:"absolute",left:g.left+"px",top:g.top+"px",width:f.outerWidth()+"px",height:f.outerHeight()+"px"}).val(e.value).on("blur",function(){b.submit.call(c)}).on("keyup",function(a){13===a.keyCode?b.submit.call(c):27===a.keyCode&&b.close.call(c)}).appendTo(a("body")).focus().select()},submit:function(){var c=a(this),d=c.data("gautoedit"),e=d.input?d.input.val():null;b.close.call(this),e&&d.value!==e&&c.trigger("submitvalue",e)},close:function(){var b=a(this),c=b.data("gautoedit");c.input&&(c.input.remove(),c.input=null,c.value=null)}};a.fn.gAutoEdit=function(c){return b[c]?b[c].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof c&&c?void a.error("Method "+c+" does not exist on jQuery.myPlugin"):b.init.apply(this,arguments)}}(jQuery),function(a){var b={init:function(c){return c=a.extend({title:"",content:"",controls:null},c),this.each(function(){{var d=this;a(this).empty().addClass("g-panel").data("gpanel",{options:c,expanded:!0}).append(a("<div></div>").addClass("header").append(a("<div></div>").addClass("title").append(a("<i></i>").addClass("fa fa-angle-down")).append(a("<span></span>").text(c.title)).on("click",function(){b.toggle.call(d)})).append(a("<div></div>").addClass("controls").append(c.controls))).append(a("<div></div>").addClass("content").append(c.content))}})},toggle:function(){var c=a(this),d=c.data("gpanel");b.expanded.call(this,!d.expanded)},expanded:function(b){var c=a(this),d=c.data("gpanel");return arguments.length?(b!==d.expanded&&(d.expanded=b,c.find(".content").css("display",d.expanded?"":"none"),c.find(".controls").css("visibility",d.expanded?"":"hidden"),c.find(".header i.fa").toggleClass("fa-angle-down",d.expanded).toggleClass("fa-angle-right",!d.expanded)),this):d.expanded}};a.fn.gPanel=function(c){return b[c]?b[c].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof c&&c?void a.error("Method "+c+" does not exist on jQuery.myPlugin"):b.init.apply(this,arguments)}}(jQuery),function(a){var b=20,c=a("<div></div>").css({position:"absolute",left:"0px",top:"0px",width:b+"px",height:b+"px","z-index":"-1"}).appendTo(a("body")),d={init:function(e){return e=a.extend({allowDrag:!0,allowDrop:!0},e),this.each(function(){var f=this,g=a(this);g.data("gpatterntarget",{options:e,pattern:null,types:null}),e.allowDrag&&g.attr("draggable","true").on("dragstart",function(a){var d=a.originalEvent,e=g.data("gpatterntarget").pattern;return e?(d.stopPropagation(),g.trigger("patterndrag",e),c.css("background",GPattern.asCSSBackground(e)),d.dataTransfer.effectAllowed="move",d.dataTransfer.setData(GPattern.MIME_TYPE,GPattern.serialize(e)),d.dataTransfer.setDragImage(c[0],b/2,b/2),void(d.dataTransfer.sourceElement=this)):void d.preventDefault()}).on("dragend",function(a){var b=a.originalEvent;b.stopPropagation()}),e.allowDrop&&g.on("dragover",function(a){a.stopPropagation();var b=a.originalEvent;b.preventDefault(),b.stopPropagation(),a.originalEvent.dataTransfer.dropEffect="move"}).on("drop",function(a){a.stopPropagation();var b=g.data("gpatterntarget"),c=a.originalEvent,e=c.dataTransfer.getData(GPattern.MIME_TYPE);if(e&&(e=GPattern.deserialize(e))){var h=!0;if(b.types&&b.types.length>0){h=!1;for(var i=0;i<b.types.length;++i)if(b.types[i]&&e instanceof b.types[i]){h=!0;break}}if(h){var j=g.data("gpatterntarget").pattern;GUtil.equals(e,j)||(d.value.call(f,e),g.trigger("patternchange",e)),g.trigger("patterndrop",[e,c])}}return!1})})},value:function(b){var c=a(this),d=c.data("gpatterntarget");return arguments.length?(b="string"==typeof b?GPattern.deserialize(b):b,d.pattern=b,this):d.pattern},types:function(b){var c=a(this),d=c.data("gpatterntarget");return arguments.length?(d.types=b,this):d.types}};a.fn.gPatternTarget=function(b){return d[b]?d[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):d.init.apply(this,arguments)}}(jQuery),function(a){var b=["#000000","#1F1F1F","#3D3D3D","#5C5C5C","#7A7A7A","#999999","#B8B8B8","#D6D6D6","#F5F5F5","#FFFFFF","#1abc9c","#2ecc71","#3498db","#9b59b6","#34495e","#f1c40f","#e67e22","#e74c3c","#ecf0f1","#95a5a6","#16a085","#27ae60","#2980b9","#8e44ad","#2c3e50","#f39c12","#d35400","#c0392b","#bdc3c7","#7f8c8d"],c={init:function(d){return d=a.extend({},d),this.each(function(){var e=this,f=a(this).addClass("g-pattern-editor").data("gpatterneditor",{scene:null,value:null,options:d});f.append(a("<div></div>").gColorEditor().on("colorchange",function(){c._colorChanged.call(e)})).append(a("<div></div>").addClass("palette").append(a("<div></div>").addClass("swatches").gSwatchPanel({allowSelect:!1,allowNameEdit:!1,previewWidth:20,previewHeight:20,nullSwatch:a("<span></span>").addClass("fa fa-plus").css("padding-left","4px"),nullName:"Add Swatch",nullAction:function(){a(this).gSwatchPanel("createSwatch",c.value.call(e))}}).on("swatchchange",function(a,b){var d=b.getProperty("pat");d instanceof GColor?(f.find(".g-color-editor").gColorEditor("currentColor",d),c._colorChanged.call(e)):d&&(c.value.call(e,d),c._firePatternChange.call(e))})).append(a("<div></div>").addClass("divider")).append(a("<div></div>").addClass("builtin-colors"))).append(a("<div></div>").addClass("g-list pattern-editor").append(a("<div></div>").data("pattern-class",GGradient).gGradientEditor().gGradientEditor("value",new GLinearGradient).on("gradientchange",function(){c._firePatternChange.call(e,!0)}))).append(a("<div></div>").addClass("toolbar").append(a("<div></div>").addClass("pattern-type").gPatternTypePicker().on("patterntypechange",function(a,b){c.value.call(e,GPattern.smartCreate(b,c.value.call(e))),c._firePatternChange.call(e)})).append(a("<label></label>").addClass("pattern-opacity").css("display","none").append(a("<span></span>").text(" Opacity: ")).append(a("<input>").css("width","3em").on("change",function(b){"none"!==a(b.target).closest("label").css("display")&&c._firePatternChange.call(e)})).append(a("<span>%</span>"))));for(var g=f.find(".builtin-colors"),h=0;h<b.length;++h){var i=GRGBColor.fromCSSColor(b[h]);a("<div></div>").css("background",i.toScreenCSS()).gPatternTarget({allowDrop:!1}).gPatternTarget("types",[GColor]).gPatternTarget("value",i).on("click",function(b){f.find(".g-color-editor").gColorEditor("currentColor",a(b.target).gPatternTarget("value")),c._colorChanged.call(e)}).appendTo(g)}})},scene:function(b){var c=a(this),d=c.data("gpatterneditor");if(arguments.length){if(b!==d.scene){var e=c.find(".swatches");d.scene&&e.gSwatchPanel("detach"),d.scene=b,d.scene&&e.gSwatchPanel("attach",d.scene.getSwatchCollection())}return this}return d.scene},types:function(b){var c=a(this);return arguments.length?(c.find(".pattern-type").gPatternTypePicker("types",b),c.find(".swatches").gSwatchPanel("types",b),this):c.find(".pattern-type").gPatternTypePicker("types")},value:function(b){var d=a(this),e=d.data("gpatterneditor");if(arguments.length){e.value=b;var f=d.find(".pattern-type").gPatternTypePicker("value",b?b.constructor:null).gPatternTypePicker("value"),g=!1;return d.find(".pattern-editor > div").each(function(b,c){var d=a(c),e=d.data("pattern-class")===f;d.css("display",e?"":"none"),g=g||e}),d.find(".pattern-editor").css("display",g?"":"none"),b instanceof GGradient&&d.find(".g-gradient-editor").gGradientEditor("value",b),c._updateToColor.call(this),this}return e.value},opacity:function(b){var c=a(this);if(arguments.length)return c.find(".pattern-opacity").css("display","number"==typeof b?"":"none").children("input").val("number"==typeof b?Math.round(100*b):""),this;var d=c.find(".pattern-opacity");return"none"===d.css("display")?null:parseInt(d.children("input").val())/100},_colorChanged:function(){var b=a(this),d=b.data("gpatterneditor"),e=b.find(".g-color-editor").gColorEditor("value");if(!d.value||d.value instanceof GBackground){var f=b.find(".pattern-type"),g=f.gPatternTypePicker("types"),g=c.types.call(this);(!g||!g.length||g&&g.indexOf(GColor)>=0)&&(d.value=e,f.gPatternTypePicker("value",GColor),c._firePatternChange.call(this,!1))}else d.value instanceof GColor?c._firePatternChange.call(this,!0):d.value instanceof GGradient},_updateToColor:function(){var b=a(this),c=b.data("gpatterneditor"),d=null;c.value instanceof GColor?d=c.value:c.value instanceof GGradient,d&&b.find(".g-color-editor").gColorEditor("value",d)},_generatePattern:function(){var b=a(this),c=b.find(".pattern-type").gPatternTypePicker("value");if(c){if(c===GBackground)return new GBackground;if(c===GColor)return b.find(".g-color-editor").gColorEditor("value");if(c===GGradient)return b.find(".g-gradient-editor").gGradientEditor("value");throw new Error("Unknown pattern type.")}return null},_firePatternChange:function(b){var d=a(this),e=d.data("gpatterneditor");b&&(e.value=c._generatePattern.call(this)),d.trigger("patternchange",[e.value,c.opacity.call(this)])}};a.fn.gPatternEditor=function(b){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):c.init.apply(this,arguments)}}(jQuery),function(a){var b=null;a.gPatternPicker={},a.gPatternPicker.getEditor=function(){return b||(b=a("<div></div>").css("margin","5px").gPatternEditor().gOverlay()),b},a.gPatternPicker.open=function(b){b=a.extend({target:null,scene:null,types:null,value:null,modal:!1,opacity:null,closeCallback:null,changeCallback:null},b);var c=a.gPatternPicker.getEditor();c.gOverlay("close"),c.gPatternEditor("scene",b.scene),c.gPatternEditor("types",b.types),c.gPatternEditor("value",b.value),c.gPatternEditor("opacity",b.opacity);var d=function(){c.gPatternEditor("scene",null),b.changeCallback&&c.off("patternchange",b.changeCallback),c.off("close",d),b.closeCallback&&b.closeCallback()};c.on("close",d),b.changeCallback&&c.on("patternchange",b.changeCallback),c.gOverlay("open",b.target,b.modal)},a.gPatternPicker.close=function(){a.gPatternPicker.getEditor().gOverlay("close")},a.gPatternPicker.relayout=function(){a.gPatternPicker.getEditor().gOverlay("relayout")},a.gPatternPicker.value=function(b){return arguments.length?void a.gPatternPicker.getEditor().gPatternEditor("value",b):a.gPatternPicker.getEditor().gPatternEditor("value")};var c={init:function(b){return b=a.extend({"transient":!1,autoOpen:!0,modal:!1},b),this.each(function(){var d=this,e=a(this);b.transient||e.addClass("g-input").addClass("g-cursor-pipette").css("min-width","20px"),e.data("gpatternpicker",{options:b,opened:!1,scene:null,types:null,opacity:null,manualChangeEvent:!1,closeListener:function(){e.data("gpatternpicker").opened=!1},changeListener:function(a,b,f){var g=e.data("gpatternpicker");g.manualChangeEvent=!0,c.value.call(d,b),c.opacity.call(d,f);try{e.trigger("patternchange",[b,f])}finally{g.manualChangeEvent=!1}}}).gPatternTarget(b).on("patternchange",function(a,b){var f=e.data("gpatternpicker");f.manualChangeEvent||c.value.call(d,b)}),b.autoOpen&&e.on("click",function(){c.open.call(d)})})},open:function(){var b=a(this),c=b.data("gpatternpicker");return a.gPatternPicker.open({target:this,scene:c.scene,types:c.types,modal:c.options.modal,value:b.gPatternTarget("value"),opacity:c.opacity,closeCallback:c.closeListener,changeCallback:c.changeListener}),c.opened=!0,this},close:function(){return a.gPatternPicker.close(),this},scene:function(b){var c=a(this),d=c.data("gpatternpicker");return arguments.length?(d.scene=b,this):d.scene},types:function(b){var c=a(this),d=c.data("gpatternpicker");return arguments.length?(d.types=b,this):d.types},opacity:function(b){var c=a(this),d=c.data("gpatternpicker");return arguments.length?(d.opacity=b,this):d.opacity},value:function(b){var c=a(this),d=c.data("gpatternpicker");return arguments.length?(c.gPatternTarget("value",b),d.options.transient||c.css("background",GPattern.asCSSBackground(b,"number"==typeof d.opacity?d.opacity:1)),d.opened&&!d.manualChangeEvent&&a.gPatternPicker.value(c.gPatternTarget("value")),a.gPatternPicker.relayout(),this):c.gPatternTarget("value")}};a.fn.gPatternPicker=function(b){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):c.init.apply(this,arguments)}}(jQuery),function(a){var b=[{clazz:null,name:"None",cssBackground:GPattern.asCSSBackground(null)},{clazz:GColor,name:"Color",cssBackground:"black"},{clazz:GGradient,name:"Gradient",cssBackground:(new GLinearGradient).asCSSBackground()},{clazz:GBackground,name:"Background",cssBackground:(new GBackground).asCSSBackground()}],c={init:function(d){return d=a.extend({},d),this.each(function(){var d=this,e=a(this).data("gpatterntypepicker",{types:null}).addClass("pattern-type-picker");if(c._updateTypes.call(d),e.is("select"))e.on("change",function(){e.trigger("patterntypechange",c.value.call(d))});else for(var f=0;f<b.length;++f){var g=b[f];a("<span></span>").data("patternClass",g.clazz).addClass("g-button pattern-type").attr("title",g.name).append(a("<span></span>").css({background:g.cssBackground})).on("click",function(b){var f=c.value.call(d);c.value.call(d,a(b.target).closest(".pattern-type").data("patternClass"));var g=c.value.call(d);f!==g&&e.trigger("patterntypechange",g)}).appendTo(e)}})},value:function(b){var c=a(this),d=function(a){if(a&&b){for(var c=b.prototype;c;c=Object.getPrototypeOf(c))if(a.prototype===c)return!0}else if(a===b)return!0;return!1};if(arguments.length)return c.is("select")?c.find("option").each(function(b,e){var f=a(e);return d(f.data("patternClass"))?(c.val(f.attr("value")),!1):void 0}):c.find("span").each(function(b,c){var e=a(c);e.data().hasOwnProperty("patternClass")&&e.toggleClass("g-active",d(e.data("patternClass")))}),this;if(c.is("select"))return c.find("option:selected").data("patternClass");var e=null;return c.find("span").each(function(b,c){var d=a(c);return d.data().hasOwnProperty("patternClass")&&d.hasClass("g-active")?(e=d.data("patternClass"),!1):void 0}),e},types:function(b){var d=a(this),e=d.data("gpatterntypepicker");return arguments.length?(e.types=b,c._updateTypes.call(this),this):e.types},_updateTypes:function(){var c=a(this),d=c.data("gpatterntypepicker");if(c.is("select")){c.find("option").each(function(b,c){var d=a(c);d.data().hasOwnProperty("patternClass")&&d.remove()});var e=c,f=c.find(":last");f.is("optgroup")&&(e=f);for(var g=0;g<b.length;++g){var h=b[g];(!d.types||!d.types.length||d.types.indexOf(h.clazz)>=0)&&a("<option></option>").attr("value",g.toString()).data("patternClass",h.clazz).text(h.name).appendTo(e)}}else c.find("span").each(function(b,c){var e=a(c);if(e.data().hasOwnProperty("patternClass")){var f=e.data("patternClass"),g=!d.types||!d.types.length||d.types.indexOf(f)>=0;e.css("display",g?"":"none")}})}};a.fn.gPatternTypePicker=function(b){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):c.init.apply(this,arguments)}}(jQuery),function(a){function b(b){var c=a(this),d=c.find("canvas.map"),e=a(d).offset(),f=Math.max(0,Math.min(d[0].width,Math.round(b.pageX-e.left-4))),k=Math.max(0,Math.min(d[0].height,Math.round(b.pageY-e.top-4))),c=a(this),l=i[j.colorMode.call(this)],m=j._getComponents.call(this),n=l.componentsFromMap(m.active.component,m.active.value,f/g,k/h,m.components),o=l.colorFromComponents(n);j._setCurrentColor.call(this,o),j._updateComponents.call(this,n),j._updateMapMarker.call(this),j._updateWheelColor.call(this),c.trigger("colorchange",o)}function c(b){var c=a(this),d=c.data("gcoloreditor");if(d.currentColor){var f=c.find('[data-wheel="highlight"]').val(),g=c.find('[data-wheel="mix"]').val(),h=360/e,i=h*Math.PI/180,j=GColor.rgbToHSV(d.currentColor.toScreen()),k=j[0],l=null;f&&(l=[k],"triadic"===f?(l.push(GMath.normalizeAngleDegrees(k-120)),l.push(GMath.normalizeAngleDegrees(k+120))):"tetradic"===f?(l.push(GMath.normalizeAngleDegrees(k+90)),l.push(GMath.normalizeAngleDegrees(k+180)),l.push(GMath.normalizeAngleDegrees(k+270))):"split_complements"===f?(l.push(GMath.normalizeAngleDegrees(k-150)),l.push(GMath.normalizeAngleDegrees(k+150))):"analogous"===f?(l.push(GMath.normalizeAngleDegrees(k-30)),l.push(GMath.normalizeAngleDegrees(k+30))):"complement"===f&&l.push(GMath.normalizeAngleDegrees(k+180)));for(var m=e-1;m>=0;--m){var n=GMath.normalizeAngleDegrees(j[0]+m*h),o=[n,j[1],j[2]],p=l&&l.indexOf(n)>=0,q=m*i-i/2-Math.PI/2;b(m,p,o,q,q+i,g)}}}var d=250,e=24,f=5,g=220,h=150,i={rgb:{components:[{label:"R",component:"r",min:0,max:255,unit:" ",map:!0,stops:function(a){return[GColor.rgbToHtmlHex([0,a[1],a[2]]),GColor.rgbToHtmlHex([255,a[1],a[2]])]}},{label:"G",component:"g",min:0,max:255,unit:" ",map:!0,stops:function(a){return[GColor.rgbToHtmlHex([a[0],0,a[2]]),GColor.rgbToHtmlHex([a[0],255,a[2]])]}},{label:"B",component:"b",min:0,max:255,unit:" ",map:!0,stops:function(a){return[GColor.rgbToHtmlHex([a[0],a[1],0]),GColor.rgbToHtmlHex([a[0],a[1],255])]}},{label:"#",component:"#",text:!0,unit:" ",map:!1,componentsToValue:function(a){return GColor.rgbToHtmlHex(a).substr(1)},valueToColor:function(a){return a.length>3?GRGBColor.fromCSSColor(a):null}}],componentToValue:function(a,b){return b},valueToComponent:function(a,b){return b},componentsFromColor:function(a){return a.toScreen()},colorFromComponents:function(a){return new GRGBColor(a)},componentsFromMap:function(a,b,c,d){switch(a){case"r":return[b,255*(1-d),255*c];case"g":return[255*(1-d),b,255*c];case"b":return[255*c,255*(1-d),b]}},mapFromComponents:function(a,b){switch(a){case"r":return[b[2]/255,1-b[1]/255];case"g":return[b[2]/255,1-b[0]/255];case"b":return[b[0]/255,1-b[1]/255]}}},hsv:{components:[{label:"H",component:"h",min:0,max:360,unit:"° ",map:!0,stops:function(a){for(var b=[],c=60,d=0;360>=d;d+=c){var e=[d,a[1],a[2]];b.push(GColor.rgbToHtmlHex(GColor.hsvToRGB(e)))}return b}},{label:"S",component:"s",min:0,max:100,unit:"%",map:!0,stops:function(a){return[GColor.rgbToHtmlHex(GColor.hsvToRGB([a[0],0,a[2]])),GColor.rgbToHtmlHex(GColor.hsvToRGB([a[0],1,a[2]]))]}},{label:"B",component:"v",min:0,max:100,unit:"%",map:!0,stops:function(a){return[GColor.rgbToHtmlHex(GColor.hsvToRGB([a[0],a[1],0])),GColor.rgbToHtmlHex(GColor.hsvToRGB([a[0],a[1],1]))]}},{label:"#",component:"#",text:!0,unit:" ",map:!1,componentsToValue:function(a){return GColor.rgbToHtmlHex(GColor.hsvToRGB(a)).substr(1)},valueToColor:function(a){return a.length>3?GRGBColor.fromCSSColor(a):null}}],componentToValue:function(a,b){switch(a){case"s":case"v":return b/100;default:return b}},valueToComponent:function(a,b){switch(a){case"s":case"v":return 100*b;default:return b}},componentsFromColor:function(a){return GColor.rgbToHSV(a.toScreen())},colorFromComponents:function(a){return new GRGBColor(GColor.hsvToRGB(a))},componentsFromMap:function(a,b,c,d){switch(a){case"h":return[b,c,1-d];case"s":return[360*c,b,1-d];case"v":return[360*c,1-d,b]}},mapFromComponents:function(a,b){switch(a){case"h":return[b[1],1-b[2]];case"s":return[b[0]/360,1-b[2]];case"v":return[b[0]/360,1-b[1]]}}},cmyk:{components:[{label:"C",component:"c",min:0,max:100,unit:"%",map:!0,stops:function(a){return[GColor.rgbToHtmlHex(GColor.cmykToRGB([0,a[1],a[2],a[3]])),GColor.rgbToHtmlHex(GColor.cmykToRGB([1,a[1],a[2],a[3]]))]}},{label:"M",component:"m",min:0,max:100,unit:"%",map:!0,stops:function(a){return[GColor.rgbToHtmlHex(GColor.cmykToRGB([a[0],0,a[2],a[3]])),GColor.rgbToHtmlHex(GColor.cmykToRGB([a[0],1,a[2],a[3]]))]}},{label:"Y",component:"y",min:0,max:100,unit:"%",map:!0,stops:function(a){return[GColor.rgbToHtmlHex(GColor.cmykToRGB([a[0],a[1],0,a[3]])),GColor.rgbToHtmlHex(GColor.cmykToRGB([a[0],a[1],1,a[3]]))]}},{label:"K",component:"k",min:0,max:100,unit:"%",map:!1,stops:function(a){return[GColor.rgbToHtmlHex(GColor.cmykToRGB([a[0],a[1],a[2],0])),GColor.rgbToHtmlHex(GColor.cmykToRGB([a[0],a[1],a[2],1]))]}}],componentToValue:function(a,b){return b/100},valueToComponent:function(a,b){return 100*b},componentsFromColor:function(a){return a instanceof GCMYKColor?a.getValue():GColor.rgbToCMYK(a.toScreen(!0))},colorFromComponents:function(a){return new GCMYKColor(a)},componentsFromMap:function(a,b,c,d,e){switch(a){case"c":return[b,1-d,c,e[3]];case"m":return[1-d,b,c,e[3]];case"y":return[1-d,c,b,e[3]]}},mapFromComponents:function(a,b){switch(a){case"c":return[b[2],1-b[1]];case"m":return[b[2],1-b[0]];case"y":return[b[1],1-b[0]]}}}},j={init:function(c){return c=a.extend({},c),this.each(function(){var e=this,f=b.bind(e),k=function(b,c){return a("<button></button>").attr("data-color-mode",b).text(c).on("click",function(){j.colorMode.call(e,b)})},l=function(b){return a("<div></div>").addClass("color-component color-component-"+b.toString()).append(a("<div></div>").addClass("color-check").append(a("<input>").attr("type","radio").attr("name","component-check").on("change",function(){j._updateMap.call(e)}))).append(a("<div></div>").addClass("color-label").on("click",function(){var a=m.find(".color-component-"+b.toString()+' input[type="text"]'),c=i[j.colorMode.call(e)];a.val(a.val()==c.components[b].max?c.components[b].min:c.components[b].max),a.trigger("input")})).append(a("<div></div>").addClass("color-range").append(a("<input>").attr("type","range").attr("tabIndex","-1").on("input",function(c){m.find(".color-component-"+b.toString()+' input[type="text"]').val(a(c.target).val()).trigger("input")}))).append(a("<div></div>").addClass("color-value").append(a("<input>").attr("type","text").on("input",function(c){var d=a(c.target),f=d.parents(".color-component"),g=i[j.colorMode.call(e)];if(g.components[b].text){var h=g.components[b].valueToColor(d.val());h&&(j.currentColor.call(e,h),m.trigger("colorchange",h))}else{var k=j._getComponents.call(e),h=g.colorFromComponents(k.components);j._setCurrentColor.call(e,h),j._updateComponents.call(e,k.components),j._updateMapMarker.call(e),j._updateWheelColor.call(e),m.trigger("colorchange",h),(!g.components[b].map||f.find('input[type="radio"]').is(":checked"))&&j._updateMap.call(e)}}))).append(a("<div></div>").addClass("color-unit"))},m=a(this).addClass("g-color-editor").data("gcoloreditor",{scene:null,previousColor:null,currentColor:null,options:c});m.append(a("<input>").attr("type","color").css({position:"absolute",visibility:"hidden"}).on("change",function(b){var c=GRGBColor.fromCSSColor(a(b.target).val());j.currentColor.call(e,c),m.trigger("colorchange",c)}.bind(this))).append(a("<div></div>").addClass("color-container").append(a("<div></div>").addClass("color").append(a("<div></div>").addClass("map-container").append(a("<canvas></canvas>").addClass("map").attr({width:g.toString()+"px",height:h.toString()+"px"}).on("mousedown",function(a){f(a);var b=function(a){a.stopPropagation(),document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",b,!0)};document.addEventListener("mousemove",f),document.addEventListener("mouseup",b,!0)})).append(a("<div></div>").addClass("marker"))).append(a("<div></div>").addClass("toolbar").append(k("rgb","RGB")).append(k("hsv","HSB")).append(k("cmyk","CMYK")).append(a("<button></button>").attr("title","System").append(a("<span></span>").addClass("fa fa-cog")).on("click",function(){m.find('input[type="color"]').trigger("click")})).append(a("<div></div>").addClass("color-preview").append(a("<div></div>").addClass("previous-color").gPatternTarget().gPatternTarget("types",[GColor]).on("patternchange",function(a,b){b&&j.previousColor.call(e,b)})).append(a("<div></div>").addClass("current-color").gPatternTarget().gPatternTarget("types",[GColor]).on("patternchange",function(a,b){b&&j.value.call(e,b)}).on("click",function(){m.find('input[type="color"]').trigger("click")})))).append(a("<div></div>").addClass("color-components").append(l(0)).append(l(1)).append(l(2)).append(l(3)))).append(a("<div></div>").addClass("wheel").append(a("<div></div>").addClass("toolbar").append(a("<select></select>").attr("data-wheel","mix").append(a("<option></option>").attr("value","").text("No Mixes")).append(a('<optgroup label="Mix"></optgroup>').append(a("<option></option>").attr("value","tint").text("Tints")).append(a("<option></option>").attr("value","shade").text("Shades")).append(a("<option></option>").attr("value","tone").text("Tones"))).append(a('<optgroup label="Blend Right"></optgroup>').append(a("<option></option>").attr("value","60").text("1 Quarter")).append(a("<option></option>").attr("value","120").text("2 Quarter")).append(a("<option></option>").attr("value","240").text("3 Quarter"))).append(a('<optgroup label="Blend Left"></optgroup>').append(a("<option></option>").attr("value","-60").text("1 Quarter")).append(a("<option></option>").attr("value","-120").text("2 Quarter")).append(a("<option></option>").attr("value","-240").text("3 Quarter"))).on("change",function(){j._updateWheelColor.call(e)}).val("tint")).append(a("<select></select>").attr("data-wheel","highlight").append(a("<option></option>").attr("value","start").text("Color Wheel")).append(a("<option></option>").attr("value","triadic").text("Triads")).append(a("<option></option>").attr("value","tetradic").text("Tetrads")).append(a("<option></option>").attr("value","split_complements").text("Split")).append(a("<option></option>").attr("value","complement").text("Complement")).append(a("<option></option>").attr("value","analogous").text("Analogous")).on("change",function(){j._updateWheelColor.call(e),j._updateWheelBorder.call(e)}))).append(a("<div></div>").addClass("wheel-container").append(a("<canvas></canvas>").addClass("color-wheel").attr({width:d.toString()+"px",height:d.toString()+"px"})).append(a("<canvas></canvas>").addClass("wheel-border").attr({width:d.toString()+"px",height:d.toString()+"px"}).on("mousedown",function(b){var c=m.data("gcoloreditor");if(c.wheelMap){var d=m.find("canvas.color-wheel"),f=a(d).offset(),g=Math.max(0,Math.min(d[0].width,Math.round(b.pageX-f.left))),h=Math.max(0,Math.min(d[0].height,Math.round(b.pageY-f.top))),i=4*(h*d[0].width+g),k=c.wheelMap.data;if(0!==k[i+3]){var l=new GRGBColor([k[i],k[i+1],k[i+2]]),n=j._convertColor.call(e,l);m.find(".wheel-border").gPatternTarget("value",n)}}}).gPatternTarget({allowDrop:!1}).gPatternTarget("types",[GColor]))))),j.colorMode.call(e,"hsv"),j._updateWheelBorder.call(e)})},colorMode:function(b){var c=a(this),d=c.find("[data-color-mode].g-active").attr("data-color-mode");if(arguments.length){if(b!==d){c.find("[data-color-mode]").each(function(c,d){var e=a(d);e.toggleClass("g-active",e.attr("data-color-mode")===b)});for(var e=i[b],f=0;4>f;++f){var g=c.find(".color-component-"+f.toString());if(f>=e.components.length)g.css("visibility","hidden"),g.removeAttr("data-component");else{var h=e.components[f];g.css("visibility",""),g.attr("data-component",h.component);var k=g.find('input[type="radio"]'),l=g.find('input[type="range"]'),m=g.find(".color-label"),n=g.find(".color-unit");k.prop("checked",0===f),m.text(h.label),n.text(h.unit),n.css("display",""!=h.unit?"":"none"),l.attr("min",h.min),l.attr("max",h.max),l.attr("step",h.step?h.step.toString():"")}}j._updateComponents.call(this);var o=j._getColorFromComponents.call(this);j.currentColor.call(this,o),c.trigger("colorchange",o)}return this}return d},previousColor:function(b){var c=a(this),d=c.data("gcoloreditor");return arguments.length?(GUtil.equals(d.previousColor,b)||(d.previousColor=b,c.find(".color-preview > .previous-color").css("background",GPattern.asCSSBackground(d.previousColor)).gPatternTarget("value",d.previousColor)),this):d.previousColor},currentColor:function(b){var c=a(this),d=c.data("gcoloreditor");return arguments.length?(j._setCurrentColor.call(this,b),j._updateComponents.call(this),j._updateMap.call(this),j._updateMapMarker.call(this),j._updateWheelColor.call(this),this):d.currentColor},value:function(b){var c=a(this),d=c.data("gcoloreditor");if(arguments.length){j.previousColor.call(this,b),j.currentColor.call(this,b);var e=j.colorMode.call(this);return b instanceof GCMYKColor?j.colorMode.call(this,"cmyk"):b instanceof GRGBColor&&"cmyk"===e&&j.colorMode.call(this,"hsv"),this}return d.currentColor},_setCurrentColor:function(b){var c=a(this),d=c.data("gcoloreditor");d.currentColor=b,c.find('input[type="color"]').val(GColor.rgbToHtmlHex(d.currentColor.toScreen())),c.find(".color-preview > .current-color").css("background",GPattern.asCSSBackground(d.currentColor)).gPatternTarget("value",d.currentColor)},_getComponents:function(){for(var b=a(this),c=i[j.colorMode.call(this)],d=b.find('input[name="component-check"]:checked').closest(".color-component").attr("data-component"),e={active:{component:d,value:null},components:[]},f=0;f<c.components.length;++f){var g=c.components[f],h=b.find(".color-component-"+f.toString()),k=h.find('input[type="text"]'),l=(h.find('input[type="range"]'),parseInt(k.val()));isNaN(l)||l<g.min?l=g.min:l>g.max&&(l=g.max);var m=c.componentToValue(g.component,l);e.components.push(m),g.component===d&&(e.active.value=m)}return e},_getColorFromComponents:function(){var b=(a(this),i[j.colorMode.call(this)]),c=j._getComponents.call(this);return b.colorFromComponents(c.components)},_convertColor:function(a){var b=i[j.colorMode.call(this)],c=b.componentsFromColor(a);return b.colorFromComponents(c)},_updateComponents:function(b){var c=a(this),d=c.data("gcoloreditor");if(d.currentColor){var e=i[j.colorMode.call(this)];if(b=b||e.componentsFromColor(d.currentColor))for(var f=0;f<e.components.length;++f){var g=e.components[f],h=c.find(".color-component-"+f.toString()),k=h.find('input[type="radio"]'),l=h.find('input[type="text"]'),m=h.find('input[type="range"]'),n=e.components[f].stops,o=n?n(b):null;if(o)if(1===o.length)m.css("background",o[0]);else{for(var p="",q=0;q<o.length;++q)""!==p&&(p+=","),p+=o[q];m.css("background","linear-gradient(90deg, "+p+")")}else m.css("background","");if(k.css("visibility",g.map?"":"hidden"),l.css("text-align",g.text?"left":"").parent().css("width",g.text?"100%":""),m.parent().css("display",g.text?"none":""),g.text)l.val(g.componentsToValue(b));else{var r=Math.min(g.max,Math.max(g.min,e.valueToComponent(g.component,b[f]))).toFixed(0);l.val(r),m.val(r)}}}},_updateMap:function(){for(var b=a(this),c=i[j.colorMode.call(this)],d=j._getComponents.call(this),e=b.find("canvas.map")[0].getContext("2d"),f=e.getImageData(0,0,g,h),k=0;g>k;++k)for(var l=0;h>l;++l){var m=c.componentsFromMap(d.active.component,d.active.value,k/g,l/h,d.components),n=c.colorFromComponents(m).toScreen(),o=4*(l*g+k);f.data[o]=n[0],f.data[o+1]=n[1],f.data[o+2]=n[2],f.data[o+3]=255}e.putImageData(f,0,0)},_updateMapMarker:function(){var b=a(this),c=i[j.colorMode.call(this)],d=j._getComponents.call(this),e=c.mapFromComponents(d.active.component,d.components);b.find(".map-container > .marker").css({left:Math.round(100*e[0])+"%",top:Math.round(100*e[1])+"%"})},_updateWheelColor:function(){var b=a(this),e=b.data("gcoloreditor"),g=b.find("canvas.color-wheel")[0],h=g.getContext("2d"),i=d/2,j=(d-14)/2;h.clearRect(0,0,g.width,g.height),c.call(this,function(a,b,c,d,e,g){if(h.beginPath(),h.moveTo(i,i),h.arc(i,i,j+(b?5:0),d,e),h.lineTo(i,i),h.fillStyle=GColor.rgbToHtmlHex(GColor.hsvToRGB(c)),h.fill(),g){h.globalAlpha=10/f*.1;var k=j/f;switch(g){case"tint":h.fillStyle="white";break;case"shade":h.fillStyle="black";break;case"tone":h.fillStyle="rgb(128,128,128)";break;default:var l=parseInt(g);if(!isNaN(l)){var m=GMath.normalizeAngleDegrees(c[0]+l);h.fillStyle=GColor.rgbToHtmlHex(GColor.hsvToRGB([m,c[1],c[2]]))}}for(var n=1;f>=n;++n)h.beginPath(),h.moveTo(i,i),h.arc(i,i,j-n*k,d,e),h.lineTo(i,i),h.fill();h.globalAlpha=1}}),e.wheelMap=h.getImageData(0,0,g.width,g.height)},_updateWheelBorder:function(){var b=a(this),e=b.find("canvas.wheel-border")[0],f=e.getContext("2d"),g=d/2,h=(d-14)/2;
f.clearRect(0,0,e.width,e.height),f.strokeStyle="black",f.lineWidth=.5,c.call(this,function(a,b,c,d,e){f.beginPath(),f.moveTo(g,g),f.arc(g,g,h+(b?5:0),d,e),b?(f.lineTo(g,g),f.shadowBlur=3,f.shadowColor="rgba(0, 0, 0, 0.75)",f.lineWidth=1):(f.shadowBlur=0,f.lineWidth=.5),f.stroke()}),f.shadowBlur=0,f.beginPath(),f.arc(g,g,8,8,0,2*Math.PI),f.fillStyle="white",f.fill(),f.stroke()}};a.fn.gColorEditor=function(b){return j[b]?j[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):j.init.apply(this,arguments)}}(jQuery),function(a){function b(a){for(var b=0;b<c.length;++b)if(c[b].type===a)return c[b].icon;return null}var c=[{type:GPathBase.CornerType.Rounded,icon:"gicon-corner-rounded"},{type:GPathBase.CornerType.InverseRounded,icon:"gicon-corner-inverse-rounded"},{type:GPathBase.CornerType.Bevel,icon:"gicon-corner-bevel"},{type:GPathBase.CornerType.Inset,icon:"gicon-corner-inset"},{type:GPathBase.CornerType.Fancy,icon:"gicon-corner-fancy"}],d={init:function(b){return b=a.extend({},b),this.each(function(){var b=this,e=a(this).data("gcornertype",{cornerType:null}).append("<span></span>").on("click",function(){for(var f=a("<div></div>").gOverlay({releaseOnClose:!0}),g=0;g<c.length;++g)a("<button></button>").addClass("g-flat").toggleClass("g-active",c[g].type===e.data("gcornertype").cornerType).attr("data-corner-type",c[g].type).append(a("<span></span>").addClass(c[g].icon)).on("click",function(){var c=a(this).attr("data-corner-type");d.value.call(b,c),e.trigger("cornertypechange",c),f.gOverlay("close")}).appendTo(f);f.gOverlay("open",this)})})},value:function(c){var d=a(this),e=d.data("gcornertype");return arguments.length?(e.cornerType=c,d.find("span").attr("class",b(e.cornerType)),this):e.cornerType}};a.fn.gCornerTypePicker=function(b){return d[b]?d[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):d.init.apply(this,arguments)}}(jQuery),function(a){var b=[{type:GPaintCanvas.BlendMode.Normal,name:"Normal"},{type:GPaintCanvas.BlendMode.Multiply,name:"Multiply"},{type:GPaintCanvas.BlendMode.Screen,name:"Screen"},{type:GPaintCanvas.BlendMode.Overlay,name:"Overlay"},{type:GPaintCanvas.BlendMode.Darken,name:"Darken"},{type:GPaintCanvas.BlendMode.Lighten,name:"Lighten"},{type:GPaintCanvas.BlendMode.ColorDodge,name:"Color Dodge"},{type:GPaintCanvas.BlendMode.ColorBurn,name:"Color Burn"},{type:GPaintCanvas.BlendMode.HardLight,name:"Hard Light"},{type:GPaintCanvas.BlendMode.SoftLight,name:"Soft Light"},{type:GPaintCanvas.BlendMode.Difference,name:"Difference"},{type:GPaintCanvas.BlendMode.Exclusion,name:"Exclusion"},{type:GPaintCanvas.BlendMode.Hue,name:"Hue"},{type:GPaintCanvas.BlendMode.Saturation,name:"Saturation"},{type:GPaintCanvas.BlendMode.Color,name:"Color"},{type:GPaintCanvas.BlendMode.Luminosity,name:"Luminosity"}],c={init:function(c){return c=a.extend({},c),this.each(function(){var c=a(this);if(c.is("select")){var d=c,e=c.find(":last");e.is("optgroup")&&(d=e);for(var f=0;f<b.length;++f)d.append(a("<option></option>").attr("value",b[f].type).text(b[f].name))}})}};a.fn.gBlendMode=function(b){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):c.init.apply(this,arguments)}}(jQuery),function(a){var b=[{unit:GLength.Unit.PX,name:"Pixels"},{unit:GLength.Unit.MM,name:"Millimeters"},{unit:GLength.Unit.CM,name:"Centimeters"},{unit:GLength.Unit.IN,name:"Inches"},{unit:GLength.Unit.PC,name:"Picas"},{unit:GLength.Unit.PT,name:"Points"}],c={init:function(c){return c=a.extend({},c),this.each(function(){var c=a(this);if(c.is("select"))for(var d=0;d<b.length;++d)c.append(a("<option></option>").attr("value",b[d].unit).text(b[d].name))})}};a.fn.gUnit=function(b){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):c.init.apply(this,arguments)}}(jQuery),function(a){function b(a){for(var b=0;b<p.length;++b)if(p[b].clazz===a)return p[b];return null}function c(a){var b=a.data("stop");a.css("left",Math.round(100*b.position)+"%"),a.find(".stop-value").css("background",b.color.toScreenCSS()),a.gPatternTarget("value",b.color)}function d(a){var b=a.data("stop");a.css("left",Math.round(100*b.position)+"%");var c=Math.round(255*(1-b.opacity));a.find(".stop-value").css("background",GColor.rgbToHtmlHex([c,c,c]))}function e(){var c=a(this),d=c.data("ggradienteditor"),e=c.find('[data-section="type"] > .g-button.g-active').data("gradientClass"),f=d.gradient.getStops(),g=GUtil.parseNumber(c.find('[data-property="scale"]').val()),h=c.find('[data-section="settings"]');isNaN(g)||0>=g?g=1:g/=100;var i=b(e),j=i.createGradient(f,g,"none"!==h.css("display")?h:null);q.value.call(this,j)}function f(){e.call(this),a(this).trigger("gradientchange")}function g(b){var c=a(this),d=c.data("ggradienteditor"),e=d.gradient;if(b){var f=c.find(".stops > .stop"),g=c.find(".opacities > .stop"),h=[];f.each(function(b,c){var d=a(c);d.data("stop-delete")===!1&&h.push(d.data("stop"))}),g.each(function(b,c){var d=a(c);d.data("stop-delete")===!1&&h.push(d.data("stop"))}),h.sort(function(a,b){return a.position>b.position}),e=new GGradient(h)}c.find(".gradient").css("background","linear-gradient(90deg, "+e.toScreenCSS()+"), "+GPattern.asCSSBackground(null))}function h(){g.call(this),a(this).trigger("gradientchange")}function i(){var b=a(this),c=b.data("ggradienteditor");c.gradient.getStops().sort(function(a,b){return a.position>b.position}),q.value.call(this,c.gradient),a(this).trigger("gradientchange")}function j(a,b){var c=a.width(),d=b-a.offset().left;return 0>d?0:d>c?1:d/c}function k(a){a.stopPropagation()}function l(b,d){b.stopPropagation();var e=a(b.target).closest(".stop");d&&(e.data("stop").color=d,c(e),h.call(this))}function m(b){var d=this,e=a(this),f=e.data("ggradienteditor"),h=e.find(".stops"),j=a(b.target).closest(".stop"),k=h.offset(),l=k.left,m=l+h.width(),n=k.top-5,o=k.top+h.outerHeight()+5,p=j.outerWidth(),q=j.offset().left+p-b.pageX,r=j.offset().top-b.pageY,s=h.children(".stop").length,t=a(document);j.data("stop-moved",!1);var u=function(a){var b=a.pageX+q-p/2,e=a.pageY+r;l>=b?b=l:b>=m&&(b=m),(n>e||e>o)&&s>2?j.css("display","none").data("stop-delete",!0):j.css("display","").data("stop-delete",!1);var f=b-l,h=m-l,i=0>=f?0:f>=h?1:f/h;j.data("stop").position=i,c(j),g.call(d,!0),j.data("stop-moved",!0)},v=function(){if(t.off("mousemove",u).off("mouseup",v),j.data("stop-delete")===!0){var a=f.gradient.getStops();a.splice(a.indexOf(j.data("stop")),1),i.call(d)}else j.data("stop-moved")&&e.trigger("gradientchange")};t.on("mousemove",u).on("mouseup",v)}function n(b){var c=this,e=(a(this),a(b.target).closest(".stop"));e.data("stop-moved")||a("<div></div>").addClass("opacity-editor").css({display:"inline-block",padding:"5px"}).append(a("<label></label>").text("Opacity: ").append(a("<input>").attr("type","text").css("width","40px").val(Math.round(100*e.data("stop").opacity)).on("change",function(){var b=a(this),f=parseInt(b.val());!isNaN(f)&&f>=0&&100>=f&&(b.parents(".opacity-editor").find('input[type="range"]').val(b.val()),e.data("stop").opacity=f/100,d(e),h.call(c))})).append(a("<span>%</span>"))).append(a("<input>").css({display:"block","margin-top":"5px"}).attr({type:"range",min:"0",max:"100"}).val(Math.round(100*e.data("stop").opacity)).on("input",function(){var b=a(this);b.parents(".opacity-editor").find('input:not([type="range"])').val(b.val()).trigger("change")})).gOverlay({modal:!0,releaseOnClose:!0}).gOverlay("open",e)}function o(b){var c=this,e=a(this),f=e.data("ggradienteditor"),h=e.find(".opacities"),j=a(b.target).closest(".stop"),k=h.offset(),l=k.left,m=l+h.width(),n=k.top-5,o=k.top+h.outerHeight()+5,p=j.outerWidth(),q=j.offset().left+p-b.pageX,r=j.offset().top-b.pageY,s=h.children(".stop").length,t=a(document);j.data("stop-moved",!1);var u=function(a){var b=a.pageX+q-p/2,e=a.pageY+r;l>=b?b=l:b>=m&&(b=m),(n>e||e>o)&&s>2?j.css("display","none").data("stop-delete",!0):j.css("display","").data("stop-delete",!1);var f=b-l,h=m-l,i=0>=f?0:f>=h?1:f/h;j.data("stop").position=i,j.data("stop-moved",!0),d(j),g.call(c,!0)},v=function(){if(t.off("mousemove",u).off("mouseup",v),j.data("stop-delete")===!0){var a=f.gradient.getStops();a.splice(a.indexOf(j.data("stop")),1),i.call(c)}else j.data("stop-moved")&&e.trigger("gradientchange")};t.on("mousemove",u).on("mouseup",v)}var p=[{clazz:GLinearGradient,name:"Linear Gradient",cssBackground:(new GLinearGradient).asCSSBackground(),initSettings:function(b,c){return b.append(a("<span></span>").addClass("fa fa-rotate-right").css("padding-right","3px")).append(a("<input>").attr({type:"text","data-property":"angle"}).css("width","30px").on("change",function(){c()})).append(a("<span>°</span>")),!0},updateSettings:function(a,b){var c=GMath.toDegrees(b.getAngle());a.find('[data-property="angle"]').val(GUtil.formatNumber(c,2))},createGradient:function(a,b,c){var d=0;return c&&(d=GUtil.parseNumber(c.find('[data-property="angle"]').val()),d=isNaN(d)?0:GMath.toRadians(GMath.normalizeAngleDegrees(d))),new GLinearGradient(a,b,d)}},{clazz:GRadialGradient,name:"Radial Gradient",cssBackground:(new GRadialGradient).asCSSBackground(),initSettings:function(){return!1},updateSettings:function(){},createGradient:function(a,b){return new GRadialGradient(a,b)}}],q={init:function(b){return b=a.extend({},b),this.each(function(){for(var c=this,d=a(this).addClass("g-gradient-editor").data("ggradienteditor",{options:b,gradient:null}),e=a("<div></div>").addClass("container").appendTo(d),g=a("<div></div>").attr("data-section","type"),h=0;h<p.length;++h){var k=p[h];a("<span></span>").data("gradientClass",k.clazz).addClass("g-button").attr("title",k.name).append(a("<span></span>").css({background:k.cssBackground})).on("click",function(b){var e=a(b.target).closest(".g-button").data("gradientClass");d.find('[data-section="type"] > .g-button').each(function(b,c){var d=a(c);d.toggleClass("g-active",d.data("gradientClass")===e)}),f.call(c)}).appendTo(g)}e.append(a("<div></div>").addClass("editor").gPatternTarget().gPatternTarget("types",[GColor,GGradient]).on("patternchange",function(a){a.stopPropagation()}).on("patterndrop",function(a,b,e){if(a.stopPropagation(),b&&b instanceof GColor){var f=d.find(".stops"),g=d.gGradientEditor("value").getStops();g.push({position:j(f,e.pageX),color:b}),i.call(c)}else b instanceof GGradient&&(q.value.call(c,b.clone()),d.trigger("gradientchange"))}).append(a("<div></div>").addClass("opacities").on("mousedown",function(a){a.preventDefault(),a.stopPropagation()}).on("dblclick",function(b){var e=a(b.target);if(e.hasClass("opacities")){var f=j(e,b.pageX),g=d.gGradientEditor("value").getStops();g.push({position:f,opacity:GGradient.interpolateOpacity(g,f)}),i.call(c)}})).append(a("<div></div>").addClass("gradient g-input").css("background","transparent")).append(a("<div></div>").addClass("stops").on("mousedown",function(a){a.preventDefault(),a.stopPropagation()}).on("dblclick",function(b){var e=a(b.target);if(e.hasClass("stops")){var f=j(e,b.pageX),g=d.gGradientEditor("value").getStops();g.push({position:f,color:GGradient.interpolateColor(g,f)}),i.call(c)}}))).append(a("<div></div>").addClass("toolbar").append(g).append(a("<div></div>").append(a("<span></span>").addClass("fa fa-arrows-h").css("padding-right","3px")).append(a("<input>").attr({type:"text","data-property":"scale"}).css("width","30px").on("change",function(){f.call(c)})).append(a("<span>%</span>"))).append(a("<div></div>").attr("data-section","settings")).append(a("<div></div>").append(a("<button></button>").append(a("<span></span>").addClass("fa fa-exchange")).on("click",function(){for(var a=d.gGradientEditor("value").getStops(),b=0;b<a.length;++b)a[b].position=1-a[b].position;i.call(c)}))))})},value:function(c){var d=a(this),e=d.data("ggradienteditor");if(arguments.length){var h=e.gradient?e.gradient.constructor:null;e.gradient=c;var i=b(c.constructor);d.find(".editor").gPatternTarget("value",c),d.find(".stops").empty(),d.find(".opacities").empty(),d.find('[data-section="type"] > .g-button').each(function(b,d){var e=a(d);e.toggleClass("g-active",e.data("gradientClass")===c.constructor)});var j=d.find('[data-section="settings"]');h!==e.gradient.constructor&&(j.css("display","none").empty(),i.initSettings(j,f.bind(this))&&j.css("display",""));var k=Math.round(100*e.gradient.getScale());if(d.find('[data-property="scale"]').val(k),i.updateSettings(j,e.gradient),c)for(var l=c.getStops(),m=0;m<l.length;++m)l[m].hasOwnProperty("color")?q.insertStop.call(this,l[m]):l[m].hasOwnProperty("opacity")&&q.insertOpacity.call(this,l[m]);return g.call(this),this}return e.gradient},insertOpacity:function(b){var c=a(this),e=c.find(".opacities"),f=a("<div></div>").addClass("stop").data("stop",b).data("stop-delete",!1).append(a("<div></div>").addClass("stop-value")).on("click",n.bind(this)).on("mousedown",o.bind(this)).appendTo(e);d(f)},insertStop:function(b){var d=a(this),e=d.find(".stops"),f=a("<div></div>").addClass("stop").data("stop",b).data("stop-delete",!1).gPatternTarget({allowDrag:!1}).gPatternTarget("types",[GColor]).append(a("<div></div>").addClass("stop-value")).on("patternchange",l.bind(this)).on("patterndrop",k).on("mousedown",m.bind(this)).appendTo(e);c(f)}};a.fn.gGradientEditor=function(b){return q[b]?q[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):q.init.apply(this,arguments)}}(jQuery),function(a){var b=[];document.addEventListener("keydown",function(c){b.length>0&&27===c.keyCode&&a(b[b.length-1]).gOverlay("close")}),document.addEventListener("mousedown",function(c){if(b.length>0){var d=a(b[b.length-1]),e=d.parents(".g-overlay"),f=e.outerWidth(),g=e.outerHeight(),h=d.offset(),i=c.pageX-h.left,j=c.pageY-h.top;(0>i||0>j||i>f||j>g)&&d.gOverlay("close")}});var c={init:function(b){return b=a.extend({modal:!1,releaseOnClose:!1},b),this.each(function(){var c=a(this).data("goverlay",{options:b,target:null,modal:!1});a("<div></div>").addClass("g-overlay").css("position","absolute").append(c)})},relayout:function(){var b=a(this),c=b.data("goverlay");if(c.target){var d=b.parents(".g-overlay"),e=a(window),f=e.width(),g=e.height(),h=d.outerWidth(),i=d.outerHeight(),j=a(c.target),k=j.offset(),l=k.top,m=k.left,n=k.left+j.outerWidth(),o=k.top+ +j.outerHeight(),p=m,q=o;p+h>f&&(p=n-h),p+h>f&&(p=f-h),q+i>g&&(q=l-i),q+i>g&&(q=g-i),0>q&&(q=0),0>p&&(p=0),d.css("left",p+"px").css("top",q+"px")}},open:function(d,e){var f=a(this),g=f.data("goverlay"),h=g.options;g.target=d,g.modal=e;var i=f.parents(".g-overlay"),e=e||h.modal;return e?a("<div></div>").addClass("g-overlay-modal").append(i).appendTo(a("body")):i.appendTo(a("body")),c.relayout.call(this),b.push(this[0]),this},close:function(){var c=a(this),d=c.data("goverlay");if(b.length&&b[b.length-1]===this[0]){d.modal=!1,d.target=null;var e=d.options;c.trigger("close");var f=c.parents(".g-overlay-modal");e.releaseOnClose?c.parents(".g-overlay").remove():c.parents(".g-overlay").detach(),f.length&&f.remove(),b.pop()}return this}};a.fn.gOverlay=function(b){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):c.init.apply(this,arguments)}}(jQuery),function(a){var b={init:function(){return this.each(function(){var c=this,d=a(this).data("gpivot",{value:null}).addClass("g-pivot"),e=function(e){a("<div></div>").addClass("side").attr("data-side",e).on("click",function(){b.value.call(c,e),d.trigger("pivotchange",e)}).appendTo(d)};a("<div></div>").addClass("borderline").appendTo(d);for(var f in GRect.Side)if(GRect.Side.hasOwnProperty(f)){var g=GRect.Side[f];"string"==typeof g&&e(g)}})},value:function(b){var c=a(this),d=c.data("gpivot");return arguments.length?(d.value=b,c.find("div[data-side]").each(function(c,d){var e=a(d);e.toggleClass("g-active",e.attr("data-side")===b)}),this):d.value}};a.fn.gPivot=function(c){return b[c]?b[c].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof c&&c?void a.error("Method "+c+" does not exist on jQuery.myPlugin"):b.init.apply(this,arguments)}}(jQuery),function(a){function b(b,c){var d=b.getScene(),e=d.pointToString(b.getProperty("x")),f=d.pointToString(b.getProperty("y")),g=d.pointToString(b.getProperty("r")),h=b.getProperty("pat"),i=b.getProperty("opc");return a("<div></div>").addClass("g-form").append(a("<div></div>").append(a("<div></div>").append(a("<input>").css("width","3em").val(e).on("change",function(){var b=d.stringToPoint(a(this).val());null!==b&&"number"==typeof b&&c(["x"],[b])})).append(a("<label></label>").text("X"))).append(a("<div></div>").append(a("<input>").css("width","3em").val(f).on("change",function(){var b=d.stringToPoint(a(this).val());null!==b&&"number"==typeof b&&c(["y"],[b])})).append(a("<label></label>").text("Y"))).append(a("<div></div>").append(a("<input>").css("width","3em").val(g).on("change",function(){var b=d.stringToPoint(a(this).val());null!==b&&"number"==typeof b&&b>=0&&c(["r"],[b])})).append(a("<label></label>").text("Blur"))).append(a("<div></div>").css("text-align","center").append(a("<button></button>").gPatternPicker({modal:!0}).gPatternPicker("types",[GColor,GGradient]).gPatternPicker("scene",d).gPatternPicker("value",h).gPatternPicker("opacity",i).on("patternchange",function(a,b,d){"number"==typeof d?c(["pat","opc"],[b,d]):c(["pat"],[b])})).append(a("<label></label>").text("Fill"))))}function c(a){var b=null;b=a instanceof GEffect?a.constructor:a;for(var c=0;c<o.length;++c)if(o[c].clazz===b)return o[c];throw new Error("Invalid effect/class")}function d(b){if(p){var c=a(b).data("effect");if(c&&(c!==p||ifPlatform.modifiers.shiftKey))return p.getParent()===c.getParent()}return!1}function e(){if(!t){t=new GMenu;for(var a=null,b=0;b<o.length;++b){var c=o[b];a&&c.group!==a&&(t.createAddDivider(),a=c.group),t.createAddItem(ifLocale.getValue(c.clazz,"name")).setData(c.clazz)}}return t}function f(b,c){for(var d=a(this),e=d.data("geffectpanel").elements,f=b.getParent().getIndexOfChild(b),g=0;g<e.length;++g)for(var h=e[g].getEffects(),i=h.getFirstChild();null!==i;i=i.getNext())i!==b&&(GUtil.equals(i,b)||i.constructor===b.constructor&&h.getIndexOfChild(i)===f)&&c(i)}function g(b){var c=a(this),d=c.data("geffectpanel").elements;b.node instanceof GEffect&&b.node.getOwnerStylable()===d[0]&&j.call(this,b.node)}function h(b){var c=a(this),d=c.data("geffectpanel").elements;b.node instanceof GEffect&&b.node.getOwnerStylable()===d[0]&&l.call(this,b.node)}function i(b){var c=a(this),d=c.data("geffectpanel").elements;b.node instanceof GEffect&&b.node.getOwnerStylable()===d[0]&&k.call(this,b.node)}function j(b){var e=this,g=a(this),h=g.data("geffectpanel"),i=g.find('[data-action="style-layer"]').val()||null;if("*"===i||b.getProperty("ly")===i){var j=null,l=b.getPrevious();l&&g.find(".effect-block").each(function(b,c){var d=a(c);return d.data("effect")===l?(j=d,!1):void 0});var m=c(b),n=null;m.createPreview?(n=a("<div></div>").addClass("preview"),m.createPreview(n)):n=a("<span></span>").addClass("fa fa-cog fa-fw");var o=a("<div></div>").addClass("effect-block").data("effect",b).attr("draggable","true").append(a("<div></div>").addClass("effect-settings grid-icon").attr("title","Effect Settings").css("visibility",m.createSettings||m.openSettings?"":"hidden").on("click",function(a){a.stopPropagation();var c=function(a,c){GEditor.tryRunTransaction(b,function(){f.call(e,b,function(b){b.setProperties(a,c)}),b.setProperties(a,c)},"Change Effect Properties")};if(m.openSettings)m.openSettings(b,c,a.target);else{var d=m.createSettings(b,c);d&&d.addClass("settings").css({display:"inline-block",padding:"5px"}).gOverlay({releaseOnClose:!0}).gOverlay("open",a.target)}}).append(n)).append(a("<div></div>").addClass("effect-title grid-main").text(b.getNodeNameTranslated())).append(a("<div></div>").addClass("effect-layer grid-icon").on("click",function(c){c.stopPropagation();var d=b.getProperty("ly"),g=h.elements&&h.elements.length?h.elements[0]:null,i=g?g.getStyleLayers():null;if(i&&i.length){var j=a("<div></div>").gOverlay({releaseOnClose:!0});i.unshift("");for(var k=0;k<i.length;++k){var l=i[k];a("<button></button>").addClass("g-flat").toggleClass("g-active",d===l).css("display","block").data("layer",l).text(ifLocale.get(GStylable.StyleLayerName[l?l:""])).on("click",function(c){var d=a(c.target).data("layer")||null;GEditor.tryRunTransaction(b,function(){f.call(e,b,function(a){a.setProperty("ly",d)}),b.setProperty("ly",d)},"Change Effect Layer"),j.gOverlay("close")}).appendTo(j)}j.gOverlay("open",this)}}).append(a("<span></span>").addClass("fa fa-fw"))).append(a("<div></div>").addClass("effect-visibility grid-icon").attr("title","Toggle Effect Visibility").on("click",function(a){a.stopPropagation(),GEditor.tryRunTransaction(b,function(){f.call(e,b,function(a){a.setProperty("vs",!b.getProperty("vs"))}),b.setProperty("vs",!b.getProperty("vs"))},"Toggle Effect Visibility")}).append(a("<span></span>").addClass("fa fa-fw"))).on("dragstart",function(b){var c=a(this),e=c.offset(),f=b.originalEvent;f.stopPropagation(),p=c.data("effect"),s=!1,q=f.pageX-e.left,r=f.pageY-e.top,f.dataTransfer.effectAllowed="move",f.dataTransfer.setData("text/plain","dummy_data"),g.find(".effect-block").each(function(b,c){a(c).append(a("<div></div>").addClass("grid-drag-overlay").on("dragenter",function(){d(this.parentNode)&&a(this).parent().addClass("g-drop")}).on("dragleave",function(){d(this.parentNode)&&a(this).parent().removeClass("g-drop")}).on("dragover",function(a){var b=a.originalEvent;d(this.parentNode)&&(b.preventDefault(),b.stopPropagation(),b.dataTransfer.dropEffect="move")}).on("drop",function(){var b=a(this.parentNode);b.removeClass("g-drop"),g.find(".grid-drag-overlay").remove(),s=!0;var c=b.data("effect");if(p&&p.getParent()===c.getParent()){var d=p.getParent(),e=d.getIndexOfChild(p),f=d.getIndexOfChild(c);GEditor.tryRunTransaction(d,function(){if(ifPlatform.modifiers.shiftKey){var a=p.clone();d.insertChild(a,f>e?c.getNext():c)}else d.removeChild(p),d.insertChild(p,f>e?c.getNext():c)},ifPlatform.modifiers.shiftKey?"Duplicate Effect":"Move Effect")}}))})}).on("dragend",function(a){var b=a.originalEvent;if(b.stopPropagation(),g.find(".grid-drag-overlay").remove(),!s){var c=g.offset(),d=c.left,h=c.top,i=d+g.outerWidth(),j=h+g.outerHeight(),k=b.pageX+q,l=b.pageY+r;(d>k||k>i||h>l||l>j)&&GEditor.tryRunTransaction(p,function(){f.call(e,p,function(a){a.getParent().removeChild(a)}),p.getParent().removeChild(p)},"Remove Effect")}p=null,s=!1});j&&j.length>0?o.insertBefore(j):o.appendTo(g.find(".effects")),k.call(this,b)}}function k(b){var d=a(this);d.find(".effect-block").each(function(d,e){var f=a(e);if(f.data("effect")===b){var g=c(b),h=b.getProperty("vs"),i=b.getProperty("ly");return f.toggleClass("g-selected",b.hasFlag(GNode.Flag.Selected)),g.updatePreview&&g.updatePreview(f.find(".effect-settings>:first-child"),b),f.find(".effect-visibility").toggleClass("grid-icon-default",h).find("> span").toggleClass("fa-eye",h).toggleClass("fa-eye-slash",!h),f.find(".effect-layer").toggleClass("grid-icon-default",!i).attr("title","Applies to "+ifLocale.get(GStylable.StyleLayerName[i?i:""])).find("> span").toggleClass("fa-circle",!i).toggleClass("gicon-fill",i===GStylable.StyleLayer.Fill).toggleClass("gicon-stroke",i===GStylable.StyleLayer.Border),!1}})}function l(b){var c=a(this);c.find(".effect-block").each(function(c,d){var e=a(d);return e.data("effect")===b?(e.remove(),!1):void 0})}function m(){var b=a(this),c=b.data("geffectpanel");if(b.find(".effects").empty(),c.elements)for(var d=c.elements[0].getEffects(),e=d.getFirstChild();null!==e;e=e.getNext())e instanceof GEffect&&j.call(this,e)}function n(){var b=a(this),c=b.data("geffectpanel"),d=b.find('[data-action="style-layer"]');d.empty().css("display","none").append(a("<option></option>").attr("value","*").text("All Effects")).append(a("<option></option>").attr("value","").text(ifLocale.get(GStylable.StyleLayerName[""]))),d.val("*");var e=c.elements&&c.elements.length?c.elements[0]:null,f=e?e.getStyleLayers():null;if(f){d.css("display","");for(var g=0;g<f.length;++g){var h=f[g];d.append(a("<option></option>").attr("value",h).text(ifLocale.get(GStylable.StyleLayerName[h])))}}}var o=[{clazz:GBlurEffect,group:"raster",createSettings:function(b,c){var d=b.getScene(),e=d.pointToString(b.getProperty("r"));return a("<div></div>").append(a("<input>").attr("type","range").attr("min","0").attr("max","50").attr("data-property","r").val(e).on("input",function(){var b=a(this);b.parents(".settings").find('[data-property="r"]:not([type="range"])').val(b.val()).trigger("change")})).append(a("<input>").css("width","3em").attr("data-property","r").val(e).on("change",function(){var b=d.stringToPoint(a(this).val());null!==b&&"number"==typeof b&&b>=0&&c(["r"],[b])}))}},{clazz:GDropShadowEffect,group:"raster",createSettings:b,createPreview:function(a){a.gPatternTarget({types:[GColor],allowDrop:!1})},updatePreview:function(a,b){var c=b.getProperty("pat"),d=b.getProperty("opc");a.gPatternTarget("value",c).css("background",GPattern.asCSSBackground(c,d))}},{clazz:GInnerShadowEffect,group:"raster",createSettings:b,createPreview:function(a){a.gPatternTarget({types:[GColor],allowDrop:!1})},updatePreview:function(a,b){var c=b.getProperty("pat"),d=b.getProperty("opc");a.gPatternTarget("value",c).css("background",GPattern.asCSSBackground(c,d))}},{clazz:GOverlayEffect,group:"filter",openSettings:function(b,c,d){a.gPatternPicker.open({target:d,scene:b.getScene(),types:[GColor,GGradient],value:b.getProperty("pat"),opacity:b.getProperty("opc"),changeCallback:function(a,b,d){"number"==typeof d?c(["pat","opc"],[b,d]):c(["pat"],[b])}})},createPreview:function(a){a.gPatternTarget({types:[GColor,GGradient],allowDrop:!1})},updatePreview:function(a,b){var c=b.getProperty("pat"),d=b.getProperty("opc");a.gPatternTarget("value",c).css("background",GPattern.asCSSBackground(c,d))}},{clazz:GColorGradingEffect,group:"filter",createSettings:function(b,c){return a("<div></div>").append(a("<input>").attr("type","file").attr("accept",".acv").css({position:"absolute",left:"-10000px"}).on("change",function(b){var d=a(b.target)[0].files;d&&d.length&&GIO.read("application/x-adobe-acv",d[0],function(a){c(["cp"],[a])})})).append(a("<select></select>").append(a("<option></option>").attr("value","").text("None")).append(a('<optgroup label="Instagram"></optgroup>').append(a("<option></option>").attr("value","1977").text("1977")).append(a("<option></option>").attr("value","Brannan").text("Brannan")).append(a("<option></option>").attr("value","Gotham").text("Gotham")).append(a("<option></option>").attr("value","Hefe").text("Hefe")).append(a("<option></option>").attr("value","Lord Kelvin").text("Lord Kelvin")).append(a("<option></option>").attr("value","Nashville").text("Nashville")).append(a("<option></option>").attr("value","X-PRO II").text("X-PRO II"))).on("change",function(b){var d=a(b.target),e=d.val();e?a.ajax({url:"acv/"+e+".acv",async:!1,dataType:"arraybuffer",success:function(a){GIO.read("application/x-adobe-acv",a,function(a){c(["cp"],[a])})}}):c(["cp"],[null])})).append(a("<button></button>").text("Load ACV...").on("click",function(b){a(b.target).parents(".settings").find('input[type="file"]').focus().trigger("click")}))}}],p=null,q=0,r=0,s=!1,t=null,u={init:function(b){return b=a.extend({},b),this.each(function(){var c=this,d=a(this).addClass("g-effect-panel").data("geffectpanel",{elements:null,options:b}).append(a("<div></div>").addClass("g-grid effects")).append(a("<select></select>").attr("data-action","style-layer").css({position:"absolute",left:"0px",bottom:"5px"}).on("change",function(b){var d=a(b.target).val();u.layer.call(c,d?d:null)})).append(a("<div></div>").css({position:"absolute",right:"0px",bottom:"5px"}).append(a("<button></button>").attr("data-action","create").append(a("<span></span>").addClass("fa fa-plus")).gMenuButton({menu:e(),arrow:!1}).on("menuitemactivate",function(a,b){var e=u.layer.call(c),f=b.getData(),g=d.data("geffectpanel").elements;g&&g.length&&GEditor.tryRunTransaction(g[0],function(){for(var a=0;a<g.length;++a){var b=new f;b.setProperty("ly",e),g[a].getEffects().appendChild(b)}},"Add Effect")})).append(a("<button></button>").attr("data-action","delete").attr("title","Remove hidden effects").on("click",function(){var a=d.data("geffectpanel").elements;if(a&&a.length){var b=a[0].getEffects();GEditor.tryRunTransaction(b,function(){for(var a=b.getFirstChild();null!==a;a=a.getNext())a.getProperty("vs")===!1&&(f.call(c,a,function(a){a.getParent().removeChild(a)}),a.getParent().removeChild(a))},"Remove Hidden Effects")}}).append(a("<span></span>").addClass("fa fa-trash-o"))))})},elements:function(b){var c=a(this),d=c.data("geffectpanel");if(!arguments.length||1==arguments.length&&null===arguments[0]){if(d.elements&&d.elements.length){var e=d.scene;e&&(e.removeEventListener(GNode.AfterInsertEvent,d.afterInsertHandler),e.removeEventListener(GNode.BeforeRemoveEvent,d.beforeRemoveHandler),e.removeEventListener(GNode.AfterPropertiesChangeEvent,d.afterPropertiesChangeHandler)),d.scene=null,d.afterInsertHandler=null,d.beforeRemoveHandler=null,d.afterPropertiesChangeHandler=null}return d.elements=null,n.call(this),m.call(this),d.elements}if(d.elements&&d.elements.length){var e=d.scene;e&&(e.removeEventListener(GNode.AfterInsertEvent,d.afterInsertHandler),e.removeEventListener(GNode.BeforeRemoveEvent,d.beforeRemoveHandler),e.removeEventListener(GNode.AfterPropertiesChangeEvent,d.afterPropertiesChangeHandler)),d.scene=null,d.afterInsertHandler=null,d.beforeRemoveHandler=null,d.afterPropertiesChangeHandler=null}if(d.elements=b,d.elements&&d.elements.length){var e=d.elements[0].getScene();e&&(d.scene=e,d.afterInsertHandler=g.bind(this),d.beforeRemoveHandler=h.bind(this),d.afterPropertiesChangeHandler=i.bind(this),e.addEventListener(GNode.AfterInsertEvent,d.afterInsertHandler),e.addEventListener(GNode.BeforeRemoveEvent,d.beforeRemoveHandler),e.addEventListener(GNode.AfterPropertiesChangeEvent,d.afterPropertiesChangeHandler))}return n.call(this),m.call(this),this},layer:function(b){{var c=a(this);c.data("geffectpanel")}if(!arguments.length||1==arguments.length&&null===arguments[0]){var d=c.find('[data-action="style-layer"]').val();return d&&"*"!==d?d:null}return c.find('[data-action="style-layer"]').val(b?b:""),m.call(this),this}};a.fn.gEffectPanel=function(b){return u[b]?u[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):u.init.apply(this,arguments)}}(jQuery),function(a){function b(a,b,c){var d=new GRect(0,0,b,c),e=a.getStylePropertySets(),f=null;if(e.indexOf(GStylable.PropertySet.Text)>=0||e.indexOf(GStylable.PropertySet.Paragraph)>=0)f=new GText,f.fromHtml('<p style="font-size:30">A</p>');else{f=new GRectangle;var g=d.getWidth()-d.getX(),h=d.getHeight()-d.getY();f.setProperty("trf",new GTransform(g/2,0,0,h/2,g/2,h/2))}return f.assignFrom(a),f.toBitmap(new GLength(b),new GLength(c),2).toImageDataUrl(GBitmap.ImageType.PNG)}function c(b,c){b.find(".style-block").each(function(b,d){var e=a(d);e.toggleClass("selected",e.data("style")===c)})}function d(b){var c=b.data("gstylepanel");if(c.options.placeholder){var d=b.find(".placeholder"),e=b.find("> .style-block");0===e.length?0===d.length&&(d=a("<div></div>").addClass("placeholder").text(c.options.placeholder).appendTo(b)):d.length>0&&d.remove()}}function e(b){var c=a(this),d=c.data("gstylepanel").container;b.node instanceof GStyle&&b.node.getParent()===d&&i.call(this,b.node)}function f(b){var c=a(this),d=c.data("gstylepanel").container;b.node instanceof GStyle&&b.node.getParent()===d&&k.call(this,b.node)}function g(b){var c=a(this),d=c.data("gstylepanel").container;b.node.getParent()===d&&j.call(this,b.node)
}function h(b,c){var d=b.data("gstylepanel");if(m){var e=a(c).data("style");if(e&&(e!==m||ifPlatform.modifiers.shiftKey))return m.getParent()===e.getParent()?d.options.allowReorder:d.options.allowDrop}return!1}function i(b,e){var f=a(this),g=f.data("gstylepanel"),i=null;"number"==typeof e?i=f.children(".style-block").eq(e):b.getNext()&&f.find(".style-block").each(function(c,d){var e=a(d);return e.data("style")===b.getNext()?(i=e,!1):void 0});var k=a("<div></div>").addClass("style-block").data("style",b).append(a("<div></div>").addClass("style-content").append(a("<div></div>").addClass("style-preview").append(a("<img>"))).append(a("<div></div>").addClass("style-name"))).on("mousedown",function(){f.data("gstylepanel").selected=b,c(f,b)}).on("click",function(){f.trigger("stylechange",b)});g.options.allowNameEdit&&k.gAutoEdit({selector:".style-name"}).on("submitvalue",function(a,c){c&&""!==c.trim()&&GEditor.tryRunTransaction(b,function(){b.setProperty("name",c)},"Rename Style")}),(g.options.allowDrag||g.options.allowReorder)&&k.attr("draggable","true").on("dragstart",function(c){var d=c.originalEvent;d.stopPropagation(),m=a(this).data("style"),g.options.allowDrag&&(f.trigger("styledragstart",b),d.dataTransfer.effectAllowed="move",d.dataTransfer.setData(GNode.MIME_TYPE,GNode.serialize(b)),d.dataTransfer.setDragImage(k.find(".style-preview > img")[0],g.options.previewWidth/2,g.options.previewHeight/2))}).on("dragend",function(a){var c=a.originalEvent;if(c.stopPropagation(),m=null,g.options.allowDrag){var d=f.offset(),e=f.outerWidth(),h=f.outerHeight(),i=c.pageX,j=c.pageY;i<=d.left||i>=d.left+e||j<=d.top||j>=d.top+h?f.trigger("styledragaway",b):f.trigger("styledragend",b)}}),(g.options.allowDrop||g.options.allowReorder)&&k.on("dragenter",function(){h(f,this)&&a(this).addClass("drop")}).on("dragleave",function(){h(f,this)&&a(this).removeClass("drop")}).on("dragover",function(a){var b=a.originalEvent;h(f,this)&&(b.preventDefault(),b.stopPropagation(),b.dataTransfer.dropEffect="move")}).on("drop",function(){a(this).removeClass("drop");var b=a(this).data("style");if(g.options.allowReorder&&m){if(g.container&&m.getParent()===g.container){var c=m.getParent(),d=c.getIndexOfChild(m),e=c.getIndexOfChild(b);GEditor.tryRunTransaction(c,function(){if(ifPlatform.modifiers.shiftKey){var a=m.clone();a.setProperty("name",a.getProperty("name")+"-copy"),c.insertChild(a,e>d?b.getNext():b)}else c.removeChild(m),c.insertChild(m,e>d?b.getNext():b)},ifPlatform.modifiers.shiftKey?"Duplicate Style":"Move Style")}f.trigger("stylemove",[m,b])}else g.options.allowDrop&&f.trigger("styledrop",[m,b])}),i&&i.length>0?k.insertBefore(i):k.appendTo(f),d(f),j.call(this,b)}function j(c){var d=a(this),e=d.data("gstylepanel");d.find(".style-block").each(function(d,f){var g=a(f);if(g.data("style")===c){g.find(".style-preview > img").attr("src",b(c,e.options.previewWidth,e.options.previewHeight));var h=c.getProperty("name");return g.attr("title",h),g.find(".style-name").text(h),!1}})}function k(b){var c=a(this),e=c.data("gstylepanel");c.find(".style-block").each(function(f,g){var h=a(g);return h.data("style")===b?(h.remove(),b===e.selected&&(e.selected=null,c.trigger("stylechange",null)),d(c),!1):void 0})}function l(){var b=a(this),c=[];b.find(".style-block").each(function(b,d){var e=a(d);e.hasClass("style-null")||c.push(e)});for(var e=0;e<c.length;++e)c[e].remove();d(b)}var m=null,n={init:function(b){return b=a.extend({allowDrag:!0,allowDrop:!1,allowReorder:!0,allowNameEdit:!1,placeholder:null,previewWidth:30,previewHeight:30},b),this.each(function(){var c=a(this).addClass("g-style-panel").data("gstylepanel",{selected:null,options:b});d(c)})},attach:function(b){var c=a(this),d=c.data("gstylepanel");if(n.detach.call(this),d.container=b,b){for(var h=b.getFirstChild();null!==h;h=h.getNext())h instanceof GStyle&&i.call(this,h);var j=b.getScene();j&&(d.afterInsertHandler=e.bind(this),d.beforeRemoveHandler=f.bind(this),d.afterPropertiesChangeHandler=g.bind(this),j.addEventListener(GNode.AfterInsertEvent,d.afterInsertHandler),j.addEventListener(GNode.BeforeRemoveEvent,d.beforeRemoveHandler),j.addEventListener(GNode.AfterPropertiesChangeEvent,d.afterPropertiesChangeHandler))}return this},detach:function(){var b=a(this),c=b.data("gstylepanel"),d=c.container;if(d){var e=d.getScene();e&&(e.removeEventListener(GNode.AfterInsertEvent,c.afterInsertHandler),e.removeEventListener(GNode.BeforeRemoveEvent,c.beforeRemoveHandler),e.removeEventListener(GNode.AfterPropertiesChangeEvent,c.afterPropertiesChangeHandler))}return c.container=null,c.afterInsertHandler=null,c.beforeRemoveHandler=null,c.afterPropertiesChangeHandler=null,l.call(this),this},value:function(b){var d=a(this);return arguments.length?(d.data("gstylepanel").selected=b,c(d,b),this):d.data("gstylepanel").selected}};a.fn.gStylePanel=function(b){return n[b]?n[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):n.init.apply(this,arguments)}}(jQuery),function(a){function b(b,c){b.data("gswatchpanel").options.allowSelect&&b.find(".swatch-block").each(function(b,d){var e=a(d);e.toggleClass("selected",e.data("swatch")===c)})}function c(b){var c=b.data("gswatchpanel");if(c.options.placeholder){var d=b.find(".placeholder"),e=b.find("> .swatch-block");0===e.length?0===d.length&&(d=a("<div></div>").addClass("placeholder").text(c.options.placeholder).appendTo(b)):d.length>0&&d.remove()}}function d(b){var c=a(this),d=c.data("gswatchpanel").container;b.node instanceof GSwatch&&b.node.getParent()===d&&h.call(this,b.node)}function e(b){var c=a(this),d=c.data("gswatchpanel").container;b.node instanceof GSwatch&&b.node.getParent()===d&&j.call(this,b.node)}function f(b){var c=a(this),d=c.data("gswatchpanel").container;b.node.getParent()===d&&i.call(this,b.node)}function g(b,c){var d=b.data("gswatchpanel");if(m){var e=a(c).data("swatch");if(e&&e!==m)return m.getParent()===e.getParent()?d.options.allowReorder:d.options.allowDrop}return!1}function h(d,e){var f=a(this),h=f.data("gswatchpanel"),j=d.getProperty("pat");if(j){var k=h.types;if(k&&k.length>0){for(var l=!1,n=0;n<k.length;++n)if(null!==k[n]&&j instanceof k[n]){l=!0;break}if(!l)return}var o=null;"number"==typeof e?(h.options.nullSwatch&&(e+=1),o=f.children(".swatch-block").eq(e)):d.getNext()&&f.find(".swatch-block").each(function(b,c){var e=a(c);return e.data("swatch")===d.getNext()?(o=e,!1):void 0});var p=a("<div></div>").addClass("swatch-block").data("swatch",d).append(a("<div></div>").addClass("swatch-content").append(a("<div></div>").addClass("swatch-preview").append(a("<div></div>").css({width:h.options.previewWidth+"px",height:h.options.previewHeight+"px"}))).append(a("<div></div>").addClass("swatch-name"))).on("mousedown",function(){f.data("gswatchpanel").selected=d,b(f,d)}).on("click",function(){f.trigger("swatchchange",d)});h.options.allowNameEdit&&p.gAutoEdit({selector:".swatch-name"}).on("submitvalue",function(a,b){b&&""!==b.trim()&&GEditor.tryRunTransaction(d,function(){d.setProperty("name",b)},"Rename Swatch")}),(h.options.allowDrag||h.options.allowReorder)&&p.attr("draggable","true").on("dragstart",function(b){var c=b.originalEvent;c.stopPropagation(),m=a(this).data("swatch");var d=m.getProperty("pat");return d?void(h.options.allowDrag&&(f.trigger("swatchdragstart",m),c.dataTransfer.effectAllowed="move",c.dataTransfer.setData(GPattern.MIME_TYPE,GPattern.serialize(d)),c.dataTransfer.setDragImage(p.find(".swatch-preview > div")[0],h.options.previewWidth/2,h.options.previewHeight/2))):void c.preventDefault()}).on("dragend",function(a){var b=a.originalEvent;if(b.stopPropagation(),m=null,h.options.allowDrag){var c=f.offset(),e=f.outerWidth(),g=f.outerHeight(),i=b.pageX,j=b.pageY;i<=c.left||i>=c.left+e||j<=c.top||j>=c.top+g?f.trigger("swatchdragaway",d):f.trigger("swatchdragend",d)}}),(h.options.allowDrop||h.options.allowReorder)&&p.on("dragenter",function(){g(f,this)&&a(this).addClass("drop")}).on("dragleave",function(){g(f,this)&&a(this).removeClass("drop")}).on("dragover",function(a){var b=a.originalEvent;g(f,this)&&(b.preventDefault(),b.stopPropagation(),b.dataTransfer.dropEffect="move")}).on("drop",function(){a(this).removeClass("drop");var b=a(this).data("swatch");if(m)if(h.options.allowReorder){if(h.container&&m.getParent()===h.container){var c=m.getParent(),d=c.getIndexOfChild(m),e=c.getIndexOfChild(b);GEditor.tryRunTransaction(c,function(){c.removeChild(m),c.insertChild(m,e>d?b.getNext():b)},"Move Swatch")}f.trigger("swatchmove",[m,b])}else h.options.allowDrop&&f.trigger("swatchdrop",[m,b])}),o&&o.length>0?p.insertBefore(o):p.appendTo(f),c(f),i.call(this,d)}}function i(b){var c=a(this);c.find(".swatch-block").each(function(c,d){var e=a(d);if(e.data("swatch")===b){e.find(".swatch-preview > div").css("background",GPattern.asCSSBackground(b.getProperty("pat")));var f=b.getProperty("name");return e.attr("title",f),e.find(".swatch-name").text(f),!1}})}function j(b){var d=a(this),e=d.data("gswatchpanel");d.find(".swatch-block").each(function(f,g){var h=a(g);return h.data("swatch")===b?(h.remove(),b===e.selected&&(e.selected=null,d.trigger("swatchchange",null)),c(d),!1):void 0})}function k(){var b=a(this),d=[];b.find(".swatch-block").each(function(b,c){var e=a(c);e.hasClass("swatch-null")||d.push(e)});for(var e=0;e<d.length;++e)d[e].remove();c(b)}function l(){var b=a(this),c=b.data("gswatchpanel");if(c.container)for(var d=c.container.getFirstChild();null!==d;d=d.getNext())d instanceof GSwatch&&h.call(this,d)}var m=null,n={init:function(b){return b=a.extend({allowDrag:!0,allowDrop:!1,allowReorder:!0,allowSelect:!0,allowNameEdit:!1,nullSwatch:null,nullName:null,nullAction:null,placeholder:null,previewWidth:22,previewHeight:22},b),this.each(function(){var d=this,e=a(this).addClass("g-swatch-panel").data("gswatchpanel",{types:null,selected:null,options:b}).on("dragover",function(a){var b=a.originalEvent;b.preventDefault(),b.stopPropagation(),b.dataTransfer.dropEffect="move"}).on("drop",function(a){var b=e.data("gswatchpanel"),c=a.originalEvent;if(c.stopPropagation(),m||!b.container||!b.container.getScene())return void(m=null);var f=(b.container.getScene(),c.dataTransfer.getData(GPattern.MIME_TYPE));if(f){var g=GPattern.deserialize(f);g&&n.createSwatch.call(d,g)}});b.nullSwatch&&a("<div></div>").addClass("swatch-block swatch-null").data("swatch",null).attr("title",b.nullName?b.nullName:"").append(a("<div></div>").addClass("swatch-content").append(a("<div></div>").addClass("swatch-preview").append(a("<div></div>").css({width:b.previewWidth+"px",height:b.previewHeight+"px","line-height":b.previewHeight+"px"}).append(b.nullSwatch))).append(a("<div></div>").addClass("swatch-name").text(b.nullName?b.nullName:""))).on("click",function(){b.nullAction&&b.nullAction.call(d)}).appendTo(e),c(e)})},createSwatch:function(b){var c=a(this),d=c.data("gswatchpanel"),e=d.container.getScene(),f=b instanceof GColor?b.toHumanString():"";GEditor.tryRunTransaction(e,function(){var a=new GSwatch;a.setProperties(["name","pat"],[f,b]),e.getSwatchCollection().appendChild(a)},"Add Swatch")},attach:function(b){var c=a(this),g=c.data("gswatchpanel");if(n.detach.call(this),g.container=b,b){l.call(this);var h=b.getScene();h&&(g.afterInsertHandler=d.bind(this),g.beforeRemoveHandler=e.bind(this),g.afterPropertiesChangeHandler=f.bind(this),h.addEventListener(GNode.AfterInsertEvent,g.afterInsertHandler),h.addEventListener(GNode.BeforeRemoveEvent,g.beforeRemoveHandler),h.addEventListener(GNode.AfterPropertiesChangeEvent,g.afterPropertiesChangeHandler))}return this},detach:function(){var b=a(this),c=b.data("gswatchpanel"),d=c.container;if(d){var e=d.getScene();e&&(e.removeEventListener(GNode.AfterInsertEvent,c.afterInsertHandler),e.removeEventListener(GNode.BeforeRemoveEvent,c.beforeRemoveHandler),e.removeEventListener(GNode.AfterPropertiesChangeEvent,c.afterPropertiesChangeHandler))}return c.container=null,c.afterInsertHandler=null,c.beforeRemoveHandler=null,c.afterPropertiesChangeHandler=null,k.call(this),this},types:function(b){var c=a(this),d=c.data("gswatchpanel");return arguments.length?(d.types=b,k.call(this),l.call(this),this):d.types},value:function(c){var d=a(this);return arguments.length?(d.data("gswatchpanel").selected=c,b(d,c),this):d.data("gswatchpanel").selected}};a.fn.gSwatchPanel=function(b){return n[b]?n[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):n.init.apply(this,arguments)}}(jQuery),function(a){function b(a){this._parent=a,this._htmlElement=$("<ul></ul>").addClass("g-menu"),this._htmlElement.on("mouseover",this._mouseOver.bind(this)),this._htmlElement.on("mouseout",this._mouseOut.bind(this))}GObject.inherit(b,GEventTarget),b.Position={Left_Top:0,Center:1,Right_Bottom:2},b._activeMenu=null,b._activeActivationCallback=null,b._activeMenuMouseLocations=null,b.getActiveMenu=function(){return b._activeMenu},b.triggerGlobalActivation=function(a){b._activeMenu&&b._activeActivationCallback&&b._activeActivationCallback(a)},b.setActiveMenu=function(a,c,d){b._activeMenu&&(c||b._activeMenu.close(),b._activeMenu=null,b._activeActivationCallback=null,document.removeEventListener("mousemove",b._activeMenuMouseMoveListener),document.removeEventListener("mousedown",b._activeMenuMouseUpDownListener),document.removeEventListener("mouseup",b._activeMenuMouseUpDownListener),document.removeEventListener("keyup",b._activeMenuKeyDownListener)),b._activeMenu=a,b._activeActivationCallback=d,b._activeMenu&&(document.addEventListener("mousemove",b._activeMenuMouseMoveListener),document.addEventListener("mousedown",b._activeMenuMouseUpDownListener),setTimeout(function(){document.addEventListener("mouseup",b._activeMenuMouseUpDownListener)},250),document.addEventListener("keyup",b._activeMenuKeyDownListener))},b._activeMenuMouseMoveListener=function(a){b._activeMenuMouseLocations||(b._activeMenuMouseLocations=[]),b._activeMenuMouseLocations.push({x:a.pageX,y:a.pageY}),b._activeMenuMouseLocations.length>3&&b._activeMenuMouseLocations.shift()},b._activeMenuMouseUpDownListener=function(){b.setActiveMenu(null)},b._activeMenuKeyDownListener=function(a){27==a.keyCode&&b.setActiveMenu(null)},b.createActionMenu=function(a,b){for(var c=[],d=function(a){for(var b=0;b<c.length;++b)if(c[b].item===a)return c[b].group},e=function(a,b,e){if(a.getItemCount()>0){var f=d(a.getItem(a.getItemCount()-1));f!==e&&a.addItem(new GMenuItem(GMenuItem.Type.Divider))}c.push({item:b,group:e})},f=0;f<a.length;++f){var g=a[f];if(g.isAvailable()){var h=ifLocale.get(g.getCategory()),i=g.getGroup(),j=h?h.split("/"):null,k=i?[""].concat(i.split("/")):null;if(k&&j&&j.length!==k.length-1)throw new Error("Number of categories different thant number of groups.");var l=b;if(j)for(var m=0;m<j.length;++m){var h=j[m],i=k?k[m]:null,n=l.findItem(h);n||(n=new GMenuItem(GMenuItem.Type.Menu),n.setCaption(h),e(l,n,i),l.addItem(n)),l=n.getMenu()}var o=new GMenuItem;o.setAction(g),e(l,o,k?k[k.length-1]:null),l.addItem(o)}}},b.OpenEvent=function(){},GObject.inherit(b.OpenEvent,GEvent),b.OpenEvent.prototype.toString=function(){return"[Object GMenu.OpenEvent]"},b.OPEN_EVENT=new b.OpenEvent,b.CloseEvent=function(){},GObject.inherit(b.CloseEvent,GEvent),b.CloseEvent.prototype.toString=function(){return"[Object GMenu.CloseEvent]"},b.CLOSE_EVENT=new b.CloseEvent,b.ActivateEvent=function(a){this.item=a},GObject.inherit(b.ActivateEvent,GEvent),b.ActivateEvent.item=null,b.ActivateEvent.prototype.toString=function(){return"[Object GMenu.ActivateEvent]"},b.prototype._parent=null,b.prototype._htmlElement=null,b.prototype._items=null,b.prototype._hovered=!1,b.prototype.getParent=function(){return this._parent},b.prototype.isHovered=function(a){if(this._hovered)return!0;if(a){for(var b=0;b<this.getItemCount();++b){var c=this.getItem(b);if(c instanceof GMenuItem&&c.getType()===GMenuItem.Type.Menu&&c.getMenu().isHovered(!0))return!0}return!1}return!1},b.prototype.isRootMenu=function(){return!(this._parent&&this._parent instanceof GMenuItem)},b.prototype.isSubMenu=function(){return this._parent&&this._parent instanceof GMenuItem?!this._parent.isRootItem():!1},b.prototype.createAddDivider=function(){return this.createInsertDivider(this.getItemCount())},b.prototype.createInsertDivider=function(a){var b=new GMenuItem(GMenuItem.Type.Divider);return this.insertItem(a,b),b},b.prototype.createAddItem=function(a,b,c,d){return this.createInsertItem(this.getItemCount(),a,b,c,d)},b.prototype.createInsertItem=function(a,b,c,d,e){var f=new GMenuItem;return f.setCaption(b),c&&f.addEventListener(GMenuItem.ActivateEvent,c),d&&f.addEventListener(GMenuItem.EnterEvent,d),e&&f.addEventListener(GMenuItem.LeaveEvent,e),this.insertItem(a,f),f},b.prototype.addItem=function(a){return this.insertItem(this.getItemCount(),a)},b.prototype.insertItem=function(a,b){null==this._items&&(this._items=[]),a+1<this._items.length?(this._items.splice(a,0,b),this._items[a+1]._htmlElement.before(b._htmlElement)):(this._items.push(b),this._htmlElement.append(b._htmlElement)),b._parent=this},b.prototype.removeItem=function(a){a>=0&&a<this.getItemCount()&&(this._items[a]._parent=null,this._items[a]._htmlElement.detach(),this._items.splice(a,1))},b.prototype.clearItems=function(){if(this._items){for(var a=0;a<this._items.length;++a)this._items[a]._parent=null,this._items[a]._htmlElement.detach();this._items=[]}},b.prototype.getItem=function(a){return a>=0&&a<this.getItemCount()?this._items[a]:null},b.prototype.getItemCount=function(){return this._items?this._items.length:0},b.prototype.indexOf=function(a){return this._items?this._items.indexOf(a):-1},b.prototype.findItem=function(a){for(var b=0;b<this.getItemCount();++b){var c=this.getItem(b);if(a==c.getCaption())return c}return null},b.prototype.update=function(){for(var a=0;a<this.getItemCount();++a){var b=this.getItem(a);b.update()}},b.prototype.isOpen=function(){return!!this._htmlElement.parent().length},b.prototype.open=function(a,c,d,e){if(c="number"==typeof c?c:b.Position.Center,d="number"==typeof d?d:b.Position.Center,this.isOpen()||(this.update(),this._htmlElement.appendTo($("body")),this.isSubMenu()||b.setActiveMenu(this,!1,e),this.trigger(b.OPEN_EVENT)),this._htmlElement.parent().is("body")){var f=this._htmlElement.outerWidth(),g=this._htmlElement.outerHeight(),h=$(window).width(),i=$(window).height(),j={x:0,y:0,width:0,height:0};if("number"==typeof a.x&&"number"==typeof a.y)j.x=a.x,j.y=a.y;else{var k=a.offset();j.x=k.left,j.y=k.top,j.width=a.outerWidth(),j.height=a.outerHeight()}var l=0;switch(c){case b.Position.Left_Top:l=j.x-f,0>l&&(l=j.x+j.width);break;case b.Position.Center:l=j.x;break;case b.Position.Right_Bottom:l=j.x+j.width,l+f>h&&(l=j.x-f)}var m=0;switch(d){case b.Position.Left_Top:m=j.y-g,0>m&&(m=j.y+j.height);break;case b.Position.Center:m=j.y;break;case b.Position.Right_Bottom:m=j.y+j.height,m+g>i&&(m=j.y-g)}switch(0>l&&(l=0),l+f>=h&&(l=h-f),0>m&&(m=0),m+g>=i&&(m=i-g),this._htmlElement.css("left",l),this._htmlElement.css("top",m),c){case b.Position.Left_Top:this._htmlElement.addClass("g-menu-left");break;case b.Position.Right_Bottom:this._htmlElement.addClass("g-menu-right")}switch(d){case b.Position.Left_Top:this._htmlElement.addClass("g-menu-top");break;case b.Position.Right_Bottom:this._htmlElement.addClass("g-menu-bottom")}}},b.prototype.close=function(){this.isOpen()&&this._htmlElement.parent().is("body")&&(this.closeMenus(),this._htmlElement.removeClass("g-menu-left g-menu-right g-menu-top g-menu-bottom"),this._htmlElement.detach(),this===b._activeMenu&&b.setActiveMenu(null,!0),this.trigger(b.CLOSE_EVENT))},b.prototype.closeMenus=function(){for(var a=0;a<this.getItemCount();++a){var b=this.getItem(a);b instanceof GMenuItem&&b.getType()===GMenuItem.Type.Menu&&b.getMenu().close()}},b.prototype._mouseOver=function(){this._hovered=!0},b.prototype._mouseOut=function(){this._hovered=!1,this.isSubMenu()&&setTimeout(function(){this.isHovered(!0)||this.closeMenus()}.bind(this),150)},a.GMenu=b}(this),function(a){function b(a){this._menu=a?a:new GMenu(this),this._menu._parent=this,this._menu._htmlElement.addClass("g-menu-root"),this._htmlElement=$("<nav></nav>").addClass("g-menu-bar").append(this._menu._htmlElement)}b.prototype._menu=null,b.prototype.getMenu=function(){return this._menu},b.prototype.isActive=function(){var a=GMenu.getActiveMenu();return a&&a._parent&&a._parent instanceof GMenuItem?a._parent.getMenuBar()===this:!1},b.prototype.toString=function(){return"[Object GMenuBar]"},a.GMenuBar=b}(this),function(a){function b(a){this._htmlElement=$("<li></li>").addClass("g-menu-item"),this._type=a?a:b.Type.Item,this._type===b.Type.Divider?this._htmlElement.addClass("g-menu-item-divider"):(this._htmlElement.append($("<span></span>").addClass("g-menu-item-icon").css("display","none")).append($("<span></span>").addClass("g-menu-item-caption")).append($("<span></span>").addClass("g-menu-item-shortcut").css("display","none")).append($("<span></span>").addClass("g-menu-item-tail")),this._type===b.Type.Menu&&(this._htmlElement.addClass("g-menu-item-menu"),this.setMenu(new GMenu(this)))),this._htmlElement.on("mouseover",this._mouseOver.bind(this)),this._htmlElement.on("mouseout",this._mouseOut.bind(this)),this._htmlElement.on("mousedown",this._mouseDown.bind(this)),this._htmlElement.on("mouseup",this._mouseUp.bind(this))}GObject.inherit(b,GEventTarget),b.Type={Item:0,Menu:1,Divider:2},b.EnterEvent=function(){},GObject.inherit(b.EnterEvent,GEvent),b.EnterEvent.prototype.toString=function(){return"[Object GMenuItem.EnterEvent]"},b.ENTER_EVENT=new b.EnterEvent,b.LeaveEvent=function(){},GObject.inherit(b.LeaveEvent,GEvent),b.LeaveEvent.prototype.toString=function(){return"[Object GMenuItem.LeaveEvent]"},b.LEAVE_EVENT=new b.LeaveEvent,b.ActivateEvent=function(){},GObject.inherit(b.ActivateEvent,GEvent),b.ActivateEvent.prototype.toString=function(){return"[Object GMenuItem.ActivateEvent]"},b.ACTIVATE_EVENT=new b.ActivateEvent,b.UpdateEvent=function(){},GObject.inherit(b.UpdateEvent,GEvent),b.UpdateEvent.prototype.toString=function(){return"[Object GMenuItem.UpdateEvent]"},b.UPDATE_EVENT=new b.UpdateEvent,b.prototype._parent=null,b.prototype._type=null,b.prototype._menu=null,b.prototype._icon=null,b.prototype._caption=null,b.prototype._shortcutHint=null,b.prototype._action=null,b.prototype._data=null,b.prototype.getParent=function(){return this._parent},b.prototype.getType=function(){return this._type},b.prototype.getIcon=function(){return this._icon},b.prototype.setIcon=function(a){if(a!==this._icon){this._icon=a;var b=this._htmlElement.find(".g-menu-item-icon");b.empty(),this._icon?(b.append("string"==typeof this._icon?$("<i></i>").addClass(a):this._icon),b.css("display","")):b.css("display","none")}},b.prototype.getCaption=function(){return this._caption},b.prototype.setCaption=function(a){if(a!==this._caption){this._caption=a;var b=this._htmlElement.find(".g-menu-item-caption");b.empty(),!this._caption||this._caption instanceof GLocale.Key||"string"==typeof this._caption?b.text(this._caption?ifLocale.get(this._caption):""):b.append(this._caption)}},b.prototype.getShortcutHint=function(){return this._shortcutHint},b.prototype.setShortcutHint=function(a){this._shortcutHint=a;var b=this._htmlElement.find(".g-menu-item-shortcut");this._shortcutHint&&this._shortcutHint.length>0?(b.text(GKey.shortcutToString(a)),b.css("display","")):(b.empty(),b.css("display","none"))},b.prototype.getAction=function(){return this._action},b.prototype.setAction=function(a){if(a!==this._action){if(this._action){var b=a.getShortcut();b&&b===this.getShortcutHint()&&this.setShortcutHint(null)}if(this._action=a,this._action){var b=a.getShortcut();b&&this.setShortcutHint(b),this.setCaption(this._action.getTitle()),this.setEnabled(this._action.isEnabled()===!0)}}},b.prototype.isChecked=function(){return this._htmlElement.hasClass("g-menu-item-checked")},b.prototype.setChecked=function(a){a!=this.isChecked()&&(a?this._htmlElement.addClass("g-menu-item-checked"):this._htmlElement.removeClass("g-menu-item-checked"))},b.prototype.isEnabled=function(){return!this._htmlElement.hasClass("g-disabled")},b.prototype.setEnabled=function(a){a!=this.isEnabled()&&(a?this._htmlElement.removeClass("g-disabled"):this._htmlElement.addClass("g-disabled"))},b.prototype.getData=function(){return this._data},b.prototype.setData=function(a){this._data=a},b.prototype.isRootItem=function(){return this._parent&&this._parent instanceof GMenu&&null!=this._parent._parent&&!(this._parent._parent instanceof b)},b.prototype.isRootMenuBarItem=function(){return this.isRootItem()&&this._parent._parent instanceof GMenuBar},b.prototype.getMenuBar=function(){return this.isRootMenuBarItem()?this._parent._parent:null},b.prototype.getMenu=function(){return this._menu},b.prototype.setMenu=function(a){a&&a!==this._menu&&this._type===b.Type.Menu&&(this._menu=a,this._menu._parent=this,this._menu.addEventListener(GMenu.OPEN_EVENT,this._menuOpen.bind(this)),this._menu.addEventListener(GMenu.CLOSE_EVENT,this._menuClose.bind(this)))},b.prototype.update=function(){this._action&&(this.setCaption(this._action.getTitle()),this.setEnabled(this._action.isEnabled()),this.setChecked(this._action.isChecked())),this.hasEventListeners(b.UpdateEvent)&&this.trigger(b.UPDATE_EVENT)},b.prototype._mouseOver=function(){this._parent&&this._parent instanceof GMenu&&!this.isRootItem()&&this._parent.closeMenus(),this.isEnabled()&&(this._type==b.Type.Menu&&GSystem.hardware===GSystem.Hardware.Desktop&&(!this.isRootItem()||this.isRootMenuBarItem()&&this.getMenuBar().isActive())&&this._openMenu(),this._type!=b.Type.Divider&&(this._htmlElement.addClass("g-hover"),this.hasEventListeners(b.EnterEvent)&&this.trigger(b.ENTER_EVENT)))},b.prototype._mouseOut=function(){this.isEnabled()&&this._type!=b.Type.Divider&&(this._htmlElement.removeClass("g-hover"),this.hasEventListeners(b.LeaveEvent)&&this.trigger(b.LEAVE_EVENT))},b.prototype._mouseDown=function(a){this.isEnabled()&&a.button==GMouseEvent.BUTTON_LEFT&&(a.stopPropagation(),a.preventDefault(),this._type!==b.Type.Menu||!this.isRootItem()&&GSystem.hardware===GSystem.Hardware.Desktop||(this._htmlElement.hasClass("g-active")?this.getMenu().close():this._openMenu()))},b.prototype._mouseUp=function(a){a.stopPropagation(),a.preventDefault(),this.isRootMenuBarItem()||this._mouseOut(a),this._type==b.Type.Item&&(this._action&&this._action.isAvailable()&&this._action.isEnabled()&&this._action.execute(),this.isEnabled()&&(this.hasEventListeners(b.ActivateEvent)&&this.trigger(b.ACTIVATE_EVENT),this._parent&&this._parent.hasEventListeners(GMenu.ActivateEvent)&&this._parent.trigger(new GMenu.ActivateEvent(this)),GMenu.triggerGlobalActivation(this))),this.isRootMenuBarItem()||GMenu.setActiveMenu(null)},b.prototype._openMenu=function(){this.getMenu().open(this._htmlElement,this.isRootItem()?GMenu.Position.Center:GMenu.Position.Right_Bottom,this.isRootItem()?GMenu.Position.Right_Bottom:GMenu.Position.Center)},b.prototype._menuOpen=function(){this._htmlElement.addClass("g-active"),this.isRootItem()&&this._parent._parent._htmlElement.addClass("g-active")},b.prototype._menuClose=function(){this._htmlElement.removeClass("g-active"),this.isRootItem()&&this._parent._parent._htmlElement.removeClass("g-active")},b.prototype.toString=function(){return"[Object GMenuItem]"},a.GMenuItem=b}(this),function(a){var b={margin:"0px 1px",transform:"rotate(-45deg)",position:"absolute",bottom:"3px","font-size":"10px"},c={"margin-left":"3px"},d={init:function(e){return e=a.extend({menu:null,defaultAction:null,arrow:!0},e),this.each(function(){var f=this,g=null,h=a(this).data("gmenubutton",{options:e}).on("mousedown",function(a){a.stopPropagation(),e.defaultAction?g=setTimeout(function(){d.open.call(f),g=null}.bind(this),250):d.open.call(f)}).on("mouseup",function(a){a.stopPropagation(),null!==g&&(clearTimeout(g),g=null),!e.menu.isOpen()&&e.defaultAction&&e.defaultAction()});e.arrow&&h.append(a("<span></span>").addClass("fa fa-caret-down").css(e.defaultAction?b:c))})},open:function(){var b=a(this),c=b.data("gmenubutton").options.menu;c.isOpen()||c.open(b,GMenu.Position.Center,GMenu.Position.Right_Bottom,function(a){b.trigger("menuitemactivate",a)})},close:function(){var a=$this.data("gmenubutton").options.menu;a.isOpen()&&a.close()}};a.fn.gMenuButton=function(b){return d[b]?d[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):d.init.apply(this,arguments)}}(jQuery);